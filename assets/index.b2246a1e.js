var tc=Object.defineProperty,lc=Object.defineProperties;var cc=Object.getOwnPropertyDescriptors;var Rt=Object.getOwnPropertySymbols;var yl=Object.prototype.hasOwnProperty,Gl=Object.prototype.propertyIsEnumerable;var Ot=(t,l,c)=>l in t?tc(t,l,{enumerable:!0,configurable:!0,writable:!0,value:c}):t[l]=c,x=(t,l)=>{for(var c in l||(l={}))yl.call(l,c)&&Ot(t,c,l[c]);if(Rt)for(var c of Rt(l))Gl.call(l,c)&&Ot(t,c,l[c]);return t},F=(t,l)=>lc(t,cc(l));var j=(t,l)=>{var c={};for(var a in t)yl.call(t,a)&&l.indexOf(a)<0&&(c[a]=t[a]);if(t!=null&&Rt)for(var a of Rt(t))l.indexOf(a)<0&&Gl.call(t,a)&&(c[a]=t[a]);return c};var Pe=(t,l,c)=>(Ot(t,typeof l!="symbol"?l+"":l,c),c);import{R as e,N as ac,F as g,I as pe,T as $,L as pl,a as nc,m as et,u as ie,B as I,S as Zl,b as it,M as jt,c as Dt,d as At,e as _t,f as qt,g as $t,C as oc,h as k,i as dc,j as Je,k as fe,V as ee,l as A,n as Tt,o as Mt,p as pt,q as Be,r as ic,s as hl,t as Yt,v as tt,w as ge,x as We,J as el,y as Zt,z as Ze,A as Xl,D as Pt,E as st,G as tl,H as Te,K as ht,P as Kl,O as sc,Q as Ll,U as mc,W as bc,X as re,Y as ll,Z as kt,_ as wt,$ as rc,a0 as uc,a1 as xl,a2 as yc,a3 as Gc,a4 as mt,a5 as gl,a6 as Fe,a7 as Ue,a8 as Oe,a9 as Ne,aa as pc,ab as Zc,ac as Xt,ad as Me,ae as cl,af as hc,ag as Xc,ah as lt,ai as ct,aj as at,ak as je,al as Kc,am as Lc,an as xc,ao as gc,ap as Wc,aq as Vc,ar as Ic,as as ke,at as Sc,au as Cc,av as Wl,aw as Vl,ax as Jt,ay as Hc,az as Il,aA as Kt,aB as ft,aC as zc,aD as vc,aE as Rc,aF as Tc,aG as Mc,aH as Yc,aI as al,aJ as Sl,aK as nl,aL as De,aM as _,aN as ol,aO as Ve,aP as Pc,aQ as kc,aR as wc,aS as Jc,aT as fc,aU as Bc,aV as Nc,aW as Cl,aX as Qc,aY as Ec,aZ as Fc,a_ as Uc,a$ as dl,b0 as Oc,b1 as jc,b2 as Dc,b3 as Ac,b4 as Hl,b5 as _c,b6 as qc,b7 as zl,b8 as $c,b9 as ea,ba as ta,bb as la,bc as ca,bd as aa,be as na,bf as oa,bg as da,bh as ia}from"./vendor.16fccfbd.js";const sa=function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function c(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerpolicy&&(o.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?o.credentials="include":n.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(n){if(n.ep)return;n.ep=!0;const o=c(n);fetch(n.href,o)}};sa();const ma=()=>e.createElement(ac,{to:"/data"}),he=o=>{var i=o,{icon:t,onClick:l,text:c,textGap:a}=i,n=j(i,["icon","onClick","text","textGap"]);const d=m=>{m.preventDefault(),m.button===0&&l&&l(m)},s=m=>{(m.key==="Enter"||m.key===" ")&&l&&l(m)};return e.createElement(g,x({_hover:{textColor:"orange.600"},_focus:{outline:"none",textColor:"orange.600"},alignItems:"center",as:"button",_disabled:{color:"gray.400"},flexWrap:"nowrap",paddingX:5,paddingY:4,textColor:"gray.600",onKeyDown:s,onMouseDown:d},n),e.createElement(pe,{as:t,width:6,height:6}),e.createElement($,{fontWeight:"semibold",marginLeft:a!=null?a:6,whiteSpace:"nowrap"},c))},il=t=>e.createElement(pl,F(x({},t),{as:nc}),t.children),ba=et(g),vl=t=>{var n,o,i;const{isOpen:l,onClose:c,onOpen:a}=ie();return e.createElement(ba,{backgroundColor:"white",onMouseEnter:a,onMouseLeave:c,initial:{x:-20},animate:{x:0},exit:{x:-20}},e.createElement(I,x({"aria-label":"Sidebar actions",boxShadow:"xl",role:"region"},t),e.createElement(Zl,{_focusWithin:{width:(n=t.maxWidth)!=null?n:"15rem"},as:"section",overflowX:"hidden",paddingX:1,paddingY:"1rem",position:"sticky",top:0,transitionProperty:"width",transitionDuration:"0.2s",transitionTimingFunction:"linear forwards",width:l?(o=t.maxWidth)!=null?o:"15rem":(i=t.minWidth)!=null?i:"4.5rem"},t.children)))},Ie=c=>{var a=c,{title:t}=a,l=j(a,["title"]);const n=it({base:"full",md:"md"});return e.createElement(jt,x({scrollBehavior:"inside",size:n},l),e.createElement(Dt,null),e.createElement(At,{margin:n==="full"?0:void 0},e.createElement(_t,null,t),e.createElement(qt,null),e.createElement($t,{pb:0},l.children)))},ra=n=>{var o=n,{name:t,onDelete:l,onSelect:c}=o,a=j(o,["name","onDelete","onSelect"]);const i=()=>{l&&l(t)},d=s=>{c&&c(t,s.target.checked)};return e.createElement(I,x({_focus:{outline:"none",borderColor:"orange.600"},_focusWithin:{borderColor:"orange.600"},_hover:{borderColor:"orange.600"},border:"1px",borderColor:"transparent",as:"section",backgroundColor:"white",boxShadow:"md",maxWidth:"container.md",padding:"1.5rem",role:"group",width:"100%"},a),e.createElement(g,{alignItems:"center",justifyContent:"space-between"},e.createElement($,{fontWeight:"semibold"},t),c&&e.createElement(oc,{"aria-label":`Add ${t} to selection`,colorScheme:"orange",onChange:d})),l&&e.createElement(k,{_groupHover:{diplay:"flex"},"aria-label":`Delete ${t}`,color:"red.600",marginTop:".5rem",onClick:i,rightIcon:e.createElement(dc,null),size:"sm",variant:"ghost"},"Delete"))},ne=h=>{var u=h,{children:t,controlProps:l,groupProps:c,hideLabel:a,initialFocusRef:n,label:o,leftChildren:i,name:d,rightChildren:s,validate:m,tooltip:b}=u,y=j(u,["children","controlProps","groupProps","hideLabel","initialFocusRef","label","leftChildren","name","rightChildren","validate","tooltip"]);const[r,z]=Je({name:d,validate:m});return e.createElement(fe,F(x({},l),{isInvalid:z.error!==void 0&&z.touched!==void 0,isRequired:y.isRequired}),a?e.createElement(ee,null,e.createElement(A,{fontWeight:"semibold"},o)):e.createElement(Tt,{label:b,placement:"auto"},e.createElement(A,{fontWeight:"semibold"},o)),e.createElement(Mt,x({as:"span"},c),i,e.createElement(pt,x({ref:L=>n?n.current=L:L,name:r.name,onBlur:r.onBlur,onChange:r.onChange,multiple:r.multiple,value:r.value},y)),t,s),e.createElement(Be,{as:"span"},z.error))},Ye=d=>{var s=d,{controlProps:t,hideLabel:l,initialFocusRef:c,label:a,name:n,validate:o}=s,i=j(s,["controlProps","hideLabel","initialFocusRef","label","name","validate"]);const[m,b]=Je({name:n,validate:o});return e.createElement(fe,F(x({},t),{isInvalid:b.error!==void 0&&b.touched!==void 0}),e.createElement(g,{alignItems:"flex-end"},e.createElement(ic,x({colorScheme:"orange",ref:y=>c?c.current=y:y,isChecked:m.value,name:m.name,onBlur:m.onBlur,onChange:m.onChange},i)),l?e.createElement(ee,null,e.createElement(A,{htmlFor:i.id},a)):e.createElement(A,{fontWeight:"semibold",htmlFor:i.id,marginBottom:0,marginLeft:"1rem"},a)),e.createElement(Be,{as:"span"},b.error))};function ua(t,l){return t.reduce((a,n,o)=>(a.set(n,l[o]),a),new Map)}function ya(t){return typeof t=="object"&&Object.keys(t).length===0}function Rl(t){return typeof t=="number"&&!isNaN(t)}function Tl(t){const l=["na","NA","N/A","n/a",null,NaN,"NaN","nan","null",""];return Rl(Number(t))||l.includes(t)}function Ga(t){return t.every(l=>Tl(l))}function Ml(t,l){const c=l.shift();return l.length===1?(ya(t)||!t[c]?t[c]=l:t[c]=[...t[c],...l],t):(t[c]||(t[c]={}),t[c]=Ml(t[c],l),t)}function pa(t){const l=Za(t.size),a=Array.from(t.values()).map((o,i)=>[o,l[i]]);return Object.fromEntries(a)}function Za(t){return t===1?[hl(2)[0]]:hl(t,{seed:1})}class Yl{constructor(){Pe(this,"header",[]);Pe(this,"rows",{});Pe(this,"config",{multiHeader:""});Yt(this)}loadFromObject(l,c){Object.assign(this.config,c),this.header=l.header,this.rows=l.rows}get colNames(){return[...this.header]}get groupsAsArray(){return Object.keys(this.headerObject)}get hasData(){return this.colNames.length>0&&this.rowNames.length>0}get headerObject(){return Array.from(this.colNames.map(c=>c.split(this.config.multiHeader))).reduce(Ml,{})}get rowNames(){return Object.keys(this.rows)}get samplesAsArray(){const l=[];return Object.values(this.headerObject).forEach(c=>{l.push(...Object.keys(c))}),[...new Set(l)]}get sampleGroupsAsArray(){const l=[];return Object.entries(this.headerObject).forEach(c=>Object.keys(c[1]).forEach(a=>{l.push(`${c[0]}${this.config.multiHeader}${a}`)})),[...new Set(l)]}getRow(l){return this.rows[l]}getColumnValue(l,c){const a=this.colNames.findIndex(n=>n===c);return this.rows[l][a]}getColumn(l){const c=this.colNames.findIndex(n=>n===l),a={};return this.rowNames.forEach(n=>{a[n]=this.rows[n][c]}),a}sliceColumns(l,c){const a=Object.values(this.rows).slice(l,c);return a[0].map((n,o)=>a.map(i=>i[o]))}getRowAsMap(l){return this.getRow(l)?ua(this.colNames,this.getRow(l)):void 0}getRowAsTree(l){const c=this.rows[l];return this.header.reduce((a,n,o)=>{const i=n.split(this.config.multiHeader),d=i[0],s=i[1];return a[d]?a[d][s]?a[d][s].push(c[o]):a[d][s]=[c[o]]:a[d]={[s]:[c[o]]},a},{})}getRows(l){const c=n=>[n,this.getRow(n)];return Object.fromEntries(l.map(c))}getSubheaderColors(l){const c=this.colNames.map(o=>o.split(this.config.multiHeader).slice(0,l).join(this.config.multiHeader)),a=pa(new Set(c));return c.map(o=>a[o])}toArrayOfRows(l=[]){const c=(s,m)=>l.includes(s)?m:void 0;let a=[];l.length>0&&(a=l.map(c).filter(Rl));const n=(s,m)=>a.includes(m),o=s=>parseFloat(s),i=s=>{const[,m]=s;let b=m;return l&&a.length>0&&(b=m.filter(n)),b.map(o)};return Object.entries(this.rows).map(i)}toArrayOfColumns(l=[]){const c=this.toArrayOfRows(l);return c[0].map((n,o)=>c.map(i=>i[o]))}toBins(l=!1){let c;const a=o=>{const[i,d]=o;return{bin:i,bins:d.map((s,m)=>({bin:this.colNames[m],count:parseFloat(s)}))}},n=(o,i)=>{const d=c.map(({bin:s,bins:m})=>({bin:s,count:m[i].count}));return{bin:o,bins:d}};return c=Object.entries(this.rows).map(a),l&&(c=this.colNames.map(n)),c}toString(l){let c="Gene-ID"+l;return c+=this.header.join(l),c+=`
`,Object.keys(this.rows).forEach(a=>{c+=a+l,c+=this.rows[a].join(l),c+=`
`}),c}addColumn(l,c){this.header.push(l),c.forEach(([a,n])=>{if(!this.rows[a]){console.warn(`${a} is not a known gene accession`);return}this.rows[a].push(n)})}addRow(l,c){this.rows[l]=c}clearData(){this.header=[],this.rows={}}removeColumns(...l){const c=this.colNames.filter(o=>!l.includes(o)),a=new Set(this.colNames.map((o,i)=>l.includes(o)?i:void 0).filter(o=>o!==void 0)),n=Object.fromEntries(Object.entries(this.rows).map(([o,i])=>[o,i.filter((d,s)=>!a.has(s))]));this.header=c,this.rows=n}getGenesForMapManBin(l,c,a,n){const o=this.colNames.findIndex(i=>i===l);return this.rowNames.filter(i=>{const d=this.rows[i][o].split(c),s=n?new RegExp(`^${a}`):new RegExp(`^${a}$`);return d.some(m=>s.test(m))})}getUniqueABColumnValues(l,c,a){const n=this.colNames.findIndex(i=>i===l),o=this.colNames.findIndex(i=>i===c);return Object.values(this.rows).reduce((i,d)=>{const s=d[n],m=d[o],b=s.split(a),y=m.split(a);return b.forEach((h,u)=>{h in i||(i[h]=y[u])}),i},{})}getMapManMeanValues(l,c){const a={};return this.rowNames.forEach(n=>{const o=this.getRowAsTree(n),i=tt(o[l][c].map(d=>parseFloat(d)));a[n]=i}),a}addMercatorHeaderAndPrepareColumns(l,c){this.header.push("MapMan_BINCODE"),l&&this.header.push("MapMan_NAME"),c&&this.header.push("MapMan_DESCRIPTION")}isNumericColumn(l){return Object.values(this.getColumn(l)).slice(0,9).every(a=>Tl(a))}}const S=new Yl,R=new Yl,ha="",Xa="",Ka="",La="",xa="",ga="";class Wa{constructor(l){Pe(this,"_PRELOADED",{data:"",info:"",image:"",settings:"",plots:"",enrichments:""});Pe(this,"_gxpSettings",{unit:"",expression_field_sep:"	",expression_header_sep:"*",info_field_sep:"	",groupOrder:[],sampleOrder:[]});Pe(this,"_isPreloading",!1);Object.assign(this._PRELOADED,l),Yt(this)}get preloaded(){return this._PRELOADED}get isPreloading(){return this.preloaded.data&&!S.hasData}get gxpSettings(){return this._gxpSettings}get groupOrder(){return this._gxpSettings.groupOrder}get sampleOrder(){return this._gxpSettings.sampleOrder}get unit(){return this._gxpSettings.unit}loadgxpSettings(l){Object.assign(this._gxpSettings,l)}setGroupOrder(l){this._gxpSettings.groupOrder=l}setSampleOrder(l){this._gxpSettings.sampleOrder=l}}const K=new Wa({data:ha,info:Ka,image:Xa,settings:La,plots:xa,enrichments:ga});function Va(t){return t.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&")}function Qe(t){return t.replace(/\\t|\\s/,l=>{switch(l){case"\\t":return"	";case"\\s":return"s";default:return l}})}function Ia(t){return t.replace(/\t|\s/,l=>{switch(l){case"	":return"\\t";case" ":return"\\s";default:return l}})}const Sa=t=>{const l=a=>{if(!a)return"A file name is required"},c=a=>{let n;return a?(a.length>1&&a[0]!=="\\"||a.length>2)&&(n="Separators must be one character long (escaped characters are supported)"):n="A separator value is required",n};return e.createElement(ge,{initialValues:{columnSep:Ia(K.gxpSettings.expression_field_sep),fileName:"GXP_Database",exportPlots:!1,exportEnrichments:!1},onSubmit:t.onSubmit,validateOnBlur:!1},a=>e.createElement(I,{as:We,id:"export-gxp-db",sx:{"& p:not(:first-of-type)":{marginTop:"1rem"}}},e.createElement(ne,{initialFocusRef:t.initialFocusRef,name:"columnSep",label:"Column Separator",validate:c,isRequired:!0}),e.createElement(ne,{name:"fileName",label:"File Name",validate:l,isRequired:!0}),e.createElement(Ye,{controlProps:{marginTop:"1rem"},color:"orange.600",id:"export-plots",name:"exportPlots",label:"Export Plots"}),e.createElement(Ye,{controlProps:{marginTop:"1rem"},color:"orange.600",id:"export-enrichments",name:"exportEnrichments",label:"Export Enrichments"}),t.children?typeof t.children=="function"?t.children(a):t.children:e.createElement(g,{as:"p",paddingY:6,justifyContent:"flex-end"},e.createElement(k,{onClick:t.onCancel,variant:"ghost"},"Cancel"),e.createElement(k,{colorScheme:"orange",isLoading:a.isSubmitting,marginLeft:".5rem",type:"submit",variant:"solid"},"Export"))))},Lt=i=>{var d=i,{hideLabel:t,initialFocusRef:l,label:c,name:a,validate:n}=d,o=j(d,["hideLabel","initialFocusRef","label","name","validate"]);var L,E;const[s,m,b]=Je({name:a,validate:n}),y=e.useRef(null),h=V=>{var Y;const X=(Y=V.currentTarget.files)==null?void 0:Y.item(0);X&&b.setValue(X)},u=V=>{V.key===" "&&z()},r=V=>{V.button===0&&z()},z=()=>{var V;(V=y.current)==null||V.click()};return e.createElement(fe,{as:"p",isInvalid:m.error!==void 0&&m.touched!==void 0,isRequired:o.isRequired,isReadOnly:!0},t?e.createElement(ee,null,e.createElement(A,{fontWeight:"semibold"},c)):e.createElement(A,{fontWeight:"semibold"},c),e.createElement(pt,F(x(x({},s),o),{ref:V=>l?l.current=V:V,onMouseDown:r,onKeyDown:u,placeholder:"Select a file to load",onChange:V=>V,value:(E=(L=s.value)==null?void 0:L.name)!=null?E:""})),e.createElement(pt,{ref:V=>y.current=V,hidden:!0,id:`hidden-${s.name}`,name:`hidden-${s.name}`,type:"file",onChange:h}),e.createElement(Be,{as:"span"},m.error))},Ca=t=>{const l=async c=>{if(!c)return"A file input is required";const n=await new el().loadAsync(c);if(n.files["GXP_settings.json"]===void 0)return'The database does not contain the "GXP_settings.json" file.';if(n.files["expression_table.txt"]===void 0)return'The database does not contain the "expression_table.txt" file.'};return e.createElement(ge,{initialValues:{},onSubmit:t.onSubmit,validateOnBlur:!1},c=>e.createElement(I,{as:We,id:"import-gxp-db",sx:{"& p:not(:first-of-type)":{marginTop:"1rem"}}},e.createElement(Lt,{initialFocusRef:t.initialFocusRef,name:"file",label:"GXP Archive",validate:l,isRequired:!0}),t.children?typeof t.children=="function"?t.children(c):t.children:e.createElement(g,{as:"p",paddingY:6,justifyContent:"flex-end"},e.createElement(k,{onClick:t.onCancel,variant:"ghost"},"Cancel"),e.createElement(k,{colorScheme:"orange",isLoading:c.isSubmitting,marginLeft:".5rem",type:"submit",variant:"solid"},"Import"))))},Ha=t=>{const l=a=>{if(!a)return"A file input is required"},c=a=>{let n;return a?(a.length>1&&a[0]!=="\\"||a.length>2)&&(n="Separators must be one character long (escaped characters are supported)"):n="A separator value is required",n};return e.createElement(ge,{initialValues:{columnSep:"\\t"},onSubmit:t.onSubmit,validateOnBlur:!1},a=>e.createElement(I,{as:We,id:"load-gene-info-table",sx:{"& p:not(:first-of-type)":{marginTop:"1rem"}}},e.createElement(ne,{initialFocusRef:t.initialFocusRef,name:"columnSep",label:"Column Separator",validate:c,isRequired:!0}),e.createElement(Lt,{name:"file",label:"Tabular File",validate:l,isRequired:!0}),t.children?typeof t.children=="function"?t.children(a):t.children:e.createElement(g,{as:"p",paddingY:6,justifyContent:"flex-end"},e.createElement(k,{onClick:t.onCancel,variant:"ghost"},"Cancel"),e.createElement(k,{colorScheme:"orange",isLoading:a.isSubmitting,marginLeft:".5rem",type:"submit",variant:"solid"},"Load"))))},za=t=>{const l=a=>{if(!a)return"A file input is required"},c=a=>{let n;return a?(a.length>1&&a[0]!=="\\"||a.length>2)&&(n="Separators must be one character long (escaped characters are supported)"):n="A separator value is required",n};return e.createElement(ge,{initialValues:{countUnit:"Raw",headerSep:"*",columnSep:"\\t"},onSubmit:t.onSubmit,validateOnBlur:!1},a=>e.createElement(I,{as:We,id:"load-xtable",sx:{"& p:not(:first-of-type)":{marginTop:"1rem"}}},e.createElement(ne,{name:"countUnit",label:"Count Unit",initialFocusRef:t.initialFocusRef}),e.createElement(ne,{name:"headerSep",label:"Header Separator",validate:c,isRequired:!0}),e.createElement(ne,{name:"columnSep",label:"Column Separator",validate:c,isRequired:!0}),e.createElement(Lt,{name:"file",label:"Tabular File",validate:l,isRequired:!0}),t.children?typeof t.children=="function"?t.children(a):t.children:e.createElement(g,{as:"p",paddingY:6,justifyContent:"flex-end"},e.createElement(k,{onClick:t.onCancel,variant:"ghost"},"Cancel"),e.createElement(k,{colorScheme:"orange",isLoading:a.isSubmitting,marginLeft:".5rem",type:"submit",variant:"solid"},"Load"))))},Pl="KCgpPT57dmFyIFNuPU9iamVjdC5kZWZpbmVQcm9wZXJ0eTt2YXIgZnQ9T2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9sczt2YXIgRW49T2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eSxNbj1PYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlO3ZhciBjdD0oRCwkLE4pPT4kIGluIEQ/U24oRCwkLHtlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMCx3cml0YWJsZTohMCx2YWx1ZTpOfSk6RFskXT1OLEE9KEQsJCk9Pntmb3IodmFyIE4gaW4gJHx8KCQ9e30pKUVuLmNhbGwoJCxOKSYmY3QoRCxOLCRbTl0pO2lmKGZ0KWZvcih2YXIgTiBvZiBmdCgkKSlNbi5jYWxsKCQsTikmJmN0KEQsTiwkW05dKTtyZXR1cm4gRH07KGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIEQocixvKXtsZXQgbj0wO2ZvcihsZXQgdD0wO3Q8ci5sZW5ndGg7dCsrKW4rPShyW3RdLW9bdF0pKihyW3RdLW9bdF0pO3JldHVybiBufWZ1bmN0aW9uICQocixvKXtyZXR1cm4gTWF0aC5zcXJ0KEQocixvKSl9ZnVuY3Rpb24gTihyLG8pe2Zvcih2YXIgbj0wLHQ9ci5sZW5ndGgsZT0wO248dDtuKyspZSs9KHJbbl0tb1tuXSkqKHJbbl0tb1tuXSkqKHJbbl0rb1tuXSkvKHJbbl0qb1tuXSk7cmV0dXJuIDIqZX1mdW5jdGlvbiB3dChyLG8pe2Zvcih2YXIgbj1yLmxlbmd0aCx0PTAsZT0wLHM9MCxpPTA7aTxuO2krKylzPU1hdGguYWJzKHJbaV0tb1tpXSksZSs9cyx0PHMmJih0PXMpO3JldHVybih0K2UpLzJ9ZnVuY3Rpb24gYXQocixvKXtmb3IodmFyIG49ci5sZW5ndGgsdD0wLGU9MDtlPG47ZSsrKXQrPU1hdGguc3FydChyW2VdKm9bZV0pO3JldHVybi1NYXRoLmxvZyh0KX1mdW5jdGlvbiBndChyLG8pe2Zvcih2YXIgbj1yLmxlbmd0aCx0PTAsZT0wO2U8bjtlKyspdCs9TWF0aC5hYnMocltlXS1vW2VdKS8ocltlXStvW2VdKTtyZXR1cm4gdH1mdW5jdGlvbiBwdChyLG8pe2Zvcih2YXIgbj1yLmxlbmd0aCx0PTAsZT0wLHM9MDtzPG47cysrKWU9TWF0aC5hYnMocltzXS1vW3NdKSx0PGUmJih0PWUpO3JldHVybiB0fWZ1bmN0aW9uIG10KHIsbyl7Zm9yKHZhciBuPTAsdD1yLmxlbmd0aCxlPTA7bjx0O24rKyllKz1NYXRoLnNxcnQoKHJbbl0tb1tuXSkqKHJbbl0tb1tuXSkvKChyW25dK29bbl0pKihyW25dK29bbl0pKSk7cmV0dXJuIDIqZX1mdW5jdGlvbiBkdChyLG8pe2Zvcih2YXIgbj0wLHQ9MCxlPTA7ZTxyLmxlbmd0aDtlKyspbis9TWF0aC5taW4ocltlXSxvW2VdKSx0Kz1yW2VdK29bZV07cmV0dXJuIDIqbi90fWZ1bmN0aW9uIHl0KHIsbyl7cmV0dXJuIDEtZHQocixvKX1mdW5jdGlvbiB2dChyLG8pe2Zvcih2YXIgbj1yLmxlbmd0aCx0PTAsZT0wLHM9MCxpPTA7aTxuO2krKyl0Kz1yW2ldKnJbaV0sZSs9b1tpXSpvW2ldLHMrPShyW2ldLW9baV0pKihyW2ldLW9baV0pO3JldHVybiBzLyh0K2UpfWZ1bmN0aW9uIGp0KHIsbyl7Zm9yKHZhciBuPTAsdD1yLmxlbmd0aCxlPTA7bjx0O24rKyllKz0ocltuXS1vW25dKSoocltuXS1vW25dKS8oKHJbbl0rb1tuXSkqKHJbbl0rb1tuXSkpO3JldHVybiAyKmV9ZnVuY3Rpb24gU3QocixvKXtmb3IodmFyIG49ci5sZW5ndGgsdD0wLGU9MDtlPG47ZSsrKXQrPU1hdGguc3FydChyW2VdKm9bZV0pO3JldHVybiB0fWZ1bmN0aW9uIEV0KHIsbyl7Zm9yKHZhciBuPXIubGVuZ3RoLHQ9MCxlPTA7ZTxuO2UrKyl0Kz1NYXRoLmFicyhyW2VdLW9bZV0pO3JldHVybiB0L259ZnVuY3Rpb24gTXQocixvKXtmb3IodmFyIG49ci5sZW5ndGgsdD0wLGU9MDtlPG47ZSsrKXQrPXJbZV0qb1tlXS8ocltlXStvW2VdKTtyZXR1cm4gMip0fWZ1bmN0aW9uIGt0KHIsbyl7Zm9yKHZhciBuPXIubGVuZ3RoLHQ9MCxlPTA7ZTxuO2UrKyl0Kz1NYXRoLnNxcnQocltlXSpvW2VdKTtyZXR1cm4gMipNYXRoLnNxcnQoMS10KX1mdW5jdGlvbiBSdChyLG8pe2Zvcih2YXIgbj1yLmxlbmd0aCx0PTAsZT0wO2U8bjtlKyspdCs9cltlXSpvW2VdO3JldHVybiB0fWZ1bmN0aW9uIHF0KHIsbyl7Zm9yKHZhciBuPXIubGVuZ3RoLHQ9MCxlPTA7ZTxuO2UrKyl0Kz1NYXRoLm1pbihyW2VdLG9bZV0pO3JldHVybiAxLXR9ZnVuY3Rpb24gVHQocixvKXtmb3IodmFyIG49ci5sZW5ndGgsdD0wLGU9MCxzPTAsaT0wLHU9MDt1PG47dSsrKXQrPXJbdV0qb1t1XSxlKz1yW3VdKnJbdV0scys9b1t1XSpvW3VdLGkrPShyW3VdLW9bdV0pKihyW3VdLW9bdV0pO3JldHVybiBpLyhlK3MtdCl9ZnVuY3Rpb24gSXQocixvKXtmb3IodmFyIG49ci5sZW5ndGgsdD0wLGU9MDtlPG47ZSsrKXQrPShyW2VdLW9bZV0pKk1hdGgubG9nKHJbZV0vb1tlXSk7cmV0dXJuIHR9ZnVuY3Rpb24gJHQocixvKXtmb3IodmFyIG49ci5sZW5ndGgsdD0wLGU9MDtlPG47ZSsrKXQrPShyW2VdKk1hdGgubG9nKHJbZV0pK29bZV0qTWF0aC5sb2cob1tlXSkpLzItKHJbZV0rb1tlXSkvMipNYXRoLmxvZygocltlXStvW2VdKS8yKTtyZXR1cm4gdH1mdW5jdGlvbiB6dChyLG8pe2Zvcih2YXIgbj1yLmxlbmd0aCx0PTAsZT0wLHM9MDtzPG47cysrKXQrPXJbc10qTWF0aC5sb2coMipyW3NdLyhyW3NdK29bc10pKSxlKz1vW3NdKk1hdGgubG9nKDIqb1tzXS8ocltzXStvW3NdKSk7cmV0dXJuKHQrZSkvMn1mdW5jdGlvbiBidChyLG8pe2Zvcih2YXIgbj1yLmxlbmd0aCx0PTAsZT0wO2U8bjtlKyspdCs9cltlXSpNYXRoLmxvZygyKnJbZV0vKHJbZV0rb1tlXSkpO3JldHVybiB0fWZ1bmN0aW9uIE50KHIsbyl7Zm9yKHZhciBuPXIubGVuZ3RoLHQ9MCxlPTAscz0wO3M8bjtzKyspdCs9TWF0aC5hYnMocltzXS1vW3NdKSxlKz1NYXRoLm1pbihyW3NdLG9bc10pO3JldHVybiB0L2V9ZnVuY3Rpb24gRnQocixvKXtmb3IodmFyIG49ci5sZW5ndGgsdD0wLGU9MDtlPG47ZSsrKXQrPXJbZV0qTWF0aC5sb2cocltlXS9vW2VdKTtyZXR1cm4gdH1mdW5jdGlvbiBWdChyLG8pe2Zvcih2YXIgbj1yLmxlbmd0aCx0PTAsZT0wLHM9MCxpPTA7aTxuO2krKyl0Kz1yW2ldKm9baV0sZSs9cltpXSpyW2ldLHMrPW9baV0qb1tpXTtyZXR1cm4gdC8oZStzLXQpfWZ1bmN0aW9uIEN0KHIsbyl7Zm9yKHZhciBuPXIubGVuZ3RoLHQ9MCxlPTA7ZTxuO2UrKyl0Kz1NYXRoLnBvdyhyW2VdKnJbZV0tb1tlXSpvW2VdLDIpLygyKk1hdGgucG93KHJbZV0qb1tlXSwxLjUpKTtyZXR1cm4gdH1mdW5jdGlvbiBEdChyLG8pe2Zvcih2YXIgbj1yLmxlbmd0aCx0PTAsZT0wO2U8bjtlKyspdCs9TWF0aC5sb2coTWF0aC5hYnMocltlXS1vW2VdKSsxKTtyZXR1cm4gdH1mdW5jdGlvbiBQdChyLG8pe2Zvcih2YXIgbj0wLHQ9ci5sZW5ndGgsZT0wO248dDtuKyspZSs9TWF0aC5hYnMocltuXS1vW25dKTtyZXR1cm4gZX1mdW5jdGlvbiBMdChyLG8pe2Zvcih2YXIgbj1yLmxlbmd0aCx0PTAsZT0wO2U8bjtlKyspdCs9TWF0aC5zcXJ0KHJbZV0qb1tlXSk7cmV0dXJuIE1hdGguc3FydCgyLTIqdCl9ZnVuY3Rpb24gQnQocixvLG4pe2Zvcih2YXIgdD0wLGU9ci5sZW5ndGgscz0wO3Q8ZTt0Kyspcys9TWF0aC5wb3coTWF0aC5hYnMoclt0XS1vW3RdKSxuKTtyZXR1cm4gTWF0aC5wb3cocywxL24pfWZ1bmN0aW9uIE90KHIsbyl7Zm9yKHZhciBuPXIubGVuZ3RoLHQ9MCxlPTAscz0wO3M8bjtzKyspdCs9TWF0aC5taW4ocltzXSxvW3NdKSxlKz1yW3NdK29bc107cmV0dXJuIDEtdC9lfWZ1bmN0aW9uIEh0KHIsbyl7Zm9yKHZhciBuPTAsdD1yLmxlbmd0aCxlPTA7bjx0O24rKyllKz0ocltuXS1vW25dKSoocltuXS1vW25dKS9yW25dO3JldHVybiBlfWZ1bmN0aW9uIEp0KHIsbyl7Zm9yKHZhciBuPTAsdD1yLmxlbmd0aCxlPTA7bjx0O24rKyllKz0ocltuXS1vW25dKSoocltuXS1vW25dKS9vW25dO3JldHVybiBlfWZ1bmN0aW9uIEd0KHIsbyl7Zm9yKHZhciBuPTAsdD1yLmxlbmd0aCxlPTA7bjx0O24rKyllKz0ocltuXS1vW25dKSoocltuXS1vW25dKS8ocltuXStvW25dKTtyZXR1cm4gMiplfWZ1bmN0aW9uIFV0KHIsbyl7Zm9yKHZhciBuPXIubGVuZ3RoLHQ9MCxlPTAscz0wO3M8bjtzKyspdCs9TWF0aC5taW4ocltzXSxvW3NdKSxlKz1NYXRoLm1heChyW3NdLG9bc10pO3JldHVybiB0L2V9ZnVuY3Rpb24gV3QocixvKXtmb3IodmFyIG49ci5sZW5ndGgsdD0wLGU9MCxzPTA7czxuO3MrKyl0Kz1NYXRoLmFicyhyW3NdLW9bc10pLGUrPU1hdGgubWF4KHJbc10sb1tzXSk7cmV0dXJuIHQvZX1mdW5jdGlvbiBYdChyLG8pe2Zvcih2YXIgbj1yLmxlbmd0aCx0PTAsZT0wLHM9MDtzPG47cysrKXQrPU1hdGguYWJzKHJbc10tb1tzXSksZSs9cltzXStvW3NdO3JldHVybiB0L2V9ZnVuY3Rpb24gS3QocixvKXtmb3IodmFyIG49MCx0PXIubGVuZ3RoLGU9MDtuPHQ7bisrKWUrPShyW25dLW9bbl0pKihyW25dLW9bbl0pLyhyW25dK29bbl0pO3JldHVybiBlfWZ1bmN0aW9uIF90KHIsbyl7Zm9yKHZhciBuPXIubGVuZ3RoLHQ9MCxlPTA7ZTxuO2UrKyl0Kz0oTWF0aC5zcXJ0KHJbZV0pLU1hdGguc3FydChvW2VdKSkqKE1hdGguc3FydChyW2VdKS1NYXRoLnNxcnQob1tlXSkpO3JldHVybiB0fWZ1bmN0aW9uIFF0KHIsbyl7Zm9yKHZhciBuPXIubGVuZ3RoLHQ9MCxlPTA7ZTxuO2UrKyl0Kz0ocltlXStvW2VdKS8yKk1hdGgubG9nKChyW2VdK29bZV0pLygyKk1hdGguc3FydChyW2VdKm9bZV0pKSk7cmV0dXJuIHR9ZnVuY3Rpb24gWXQocixvLG4pe2lmKG4pe2Zvcih2YXIgdD0wLGU9MCxzPTA7czxyLmxlbmd0aDtzKyspdCs9cltzXSYmb1tzXSxlKz1yW3NdfHxvW3NdO3JldHVybiBlPT09MD8xOnQvZX1lbHNle2Zvcih2YXIgaT1yLmxlbmd0aCx1PTAsZj0wLGE9MCxsPTA7bDxpO2wrKyl1Kz1yW2xdLGYrPW9bbF0sYSs9TWF0aC5taW4ocltsXSxvW2xdKTtyZXR1cm4gMS0odStmLTIqYSkvKHUrZi1hKX19ZnVuY3Rpb24gWnQocixvLG4pe2lmKG4pcmV0dXJuIDEtWXQocixvLG4pO2Zvcih2YXIgdD1yLmxlbmd0aCxlPTAscz0wLGk9MCx1PTA7dTx0O3UrKyllKz1yW3VdLHMrPW9bdV0saSs9TWF0aC5taW4oclt1XSxvW3VdKTtyZXR1cm4oZStzLTIqaSkvKGUrcy1pKX1mdW5jdGlvbiB4dChyLG8pe2Zvcih2YXIgbj1yLmxlbmd0aCx0PTAsZT0wO2U8bjtlKyspdCs9cltlXSpNYXRoLmxvZygyKnJbZV0vKHJbZV0rb1tlXSkpK29bZV0qTWF0aC5sb2coMipvW2VdLyhyW2VdK29bZV0pKTtyZXR1cm4gdH1mdW5jdGlvbiBBdChyLG8pe2Zvcih2YXIgbj1yLmxlbmd0aCx0PTAsZT0wO2U8bjtlKyspdCs9MS1NYXRoLm1pbihyW2VdLG9bZV0pL01hdGgubWF4KHJbZV0sb1tlXSk7cmV0dXJuIHR9dmFyIHRlPU9iamVjdC5mcmVlemUoe19fcHJvdG9fXzpudWxsLGV1Y2xpZGVhbjokLHNxdWFyZWRFdWNsaWRlYW46RCxhZGRpdGl2ZVN5bW1ldHJpYzpOLGF2Zzp3dCxiaGF0dGFjaGFyeXlhOmF0LGNhbmJlcnJhOmd0LGNoZWJ5c2hldjpwdCxjbGFyazptdCxjemVrYW5vd3NraTp5dCxkaWNlOnZ0LGRpdmVyZ2VuY2U6anQsZmlkZWxpdHk6U3QsZ293ZXI6RXQsaGFybW9uaWNNZWFuOk10LGhlbGxpbmdlcjprdCxpbm5lclByb2R1Y3Q6UnQsaW50ZXJzZWN0aW9uOnF0LGphY2NhcmQ6VHQsamVmZnJleXM6SXQsamVuc2VuRGlmZmVyZW5jZTokdCxqZW5zZW5TaGFubm9uOnp0LGtkaXZlcmdlbmNlOmJ0LGt1bGN6eW5za2k6TnQsa3VsbGJhY2tMZWlibGVyOkZ0LGt1bWFySGFzc2Vicm9vazpWdCxrdW1hckpvaG5zb246Q3QsbG9yZW50emlhbjpEdCxtYW5oYXR0YW46UHQsbWF0dXNpdGE6THQsbWlua293c2tpOkJ0LG1vdHlrYTpPdCxuZXltYW46SHQscGVhcnNvbjpKdCxwcm9iYWJpbGlzdGljU3ltbWV0cmljOkd0LHJ1emlja2E6VXQsc29lcmdlbDpXdCxzb3JlbnNlbjpYdCxzcXVhcmVkOkt0LHNxdWFyZWRDaG9yZDpfdCx0YW5lamE6UXQsdGFuaW1vdG86WnQsdG9wc29lOnh0LHdhdmVIZWRnZXM6QXR9KSxlZT10eXBlb2YgZ2xvYmFsVGhpcyE9InVuZGVmaW5lZCI/Z2xvYmFsVGhpczp0eXBlb2Ygd2luZG93IT0idW5kZWZpbmVkIj93aW5kb3c6dHlwZW9mIGdsb2JhbCE9InVuZGVmaW5lZCI/Z2xvYmFsOnR5cGVvZiBzZWxmIT0idW5kZWZpbmVkIj9zZWxmOnt9O2NvbnN0IG5lPU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7ZnVuY3Rpb24gVShyKXtyZXR1cm4gbmUuY2FsbChyKS5lbmRzV2l0aCgiQXJyYXldIil9ZnVuY3Rpb24gdHQocixvKXtjb25zdCBuPW9lKHIubGVuZ3RoKTtmb3IobGV0IHQ9MDt0PHIubGVuZ3RoO3QrKylmb3IobGV0IGU9MDtlPD10O2UrKyluW3RdW2VdPW8oclt0XSxyW2VdKSxuW2VdW3RdPW5bdF1bZV07cmV0dXJuIG59ZnVuY3Rpb24gb2Uocil7Y29uc3Qgbz1bXTtmb3IobGV0IG49MDtuPHI7bisrKXtjb25zdCB0PVtdO28ucHVzaCh0KTtmb3IobGV0IGU9MDtlPHI7ZSsrKXQucHVzaCgwKX1yZXR1cm4gb31mdW5jdGlvbiByZShyKXt2YXIgbz1hcmd1bWVudHMubGVuZ3RoPjEmJmFyZ3VtZW50c1sxXSE9PXZvaWQgMD9hcmd1bWVudHNbMV06e307aWYoIVUocikpdGhyb3cgbmV3IFR5cGVFcnJvcigiaW5wdXQgbXVzdCBiZSBhbiBhcnJheSIpO2lmKHIubGVuZ3RoPT09MCl0aHJvdyBuZXcgVHlwZUVycm9yKCJpbnB1dCBtdXN0IG5vdCBiZSBlbXB0eSIpO3ZhciBuPW8uZnJvbUluZGV4LHQ9bj09PXZvaWQgMD8wOm4sZT1vLnRvSW5kZXgscz1lPT09dm9pZCAwP3IubGVuZ3RoOmU7aWYodDwwfHx0Pj1yLmxlbmd0aHx8IU51bWJlci5pc0ludGVnZXIodCkpdGhyb3cgbmV3IEVycm9yKCJmcm9tSW5kZXggbXVzdCBiZSBhIHBvc2l0aXZlIGludGVnZXIgc21hbGxlciB0aGFuIGxlbmd0aCIpO2lmKHM8PXR8fHM+ci5sZW5ndGh8fCFOdW1iZXIuaXNJbnRlZ2VyKHMpKXRocm93IG5ldyBFcnJvcigidG9JbmRleCBtdXN0IGJlIGFuIGludGVnZXIgZ3JlYXRlciB0aGFuIGZyb21JbmRleCBhbmQgYXQgbW9zdCBlcXVhbCB0byBsZW5ndGgiKTtmb3IodmFyIGk9clt0XSx1PXQrMTt1PHM7dSsrKXJbdV0+aSYmKGk9clt1XSk7cmV0dXJuIGl9ZnVuY3Rpb24gc2Uocil7dmFyIG89YXJndW1lbnRzLmxlbmd0aD4xJiZhcmd1bWVudHNbMV0hPT12b2lkIDA/YXJndW1lbnRzWzFdOnt9O2lmKCFVKHIpKXRocm93IG5ldyBUeXBlRXJyb3IoImlucHV0IG11c3QgYmUgYW4gYXJyYXkiKTtpZihyLmxlbmd0aD09PTApdGhyb3cgbmV3IFR5cGVFcnJvcigiaW5wdXQgbXVzdCBub3QgYmUgZW1wdHkiKTt2YXIgbj1vLmZyb21JbmRleCx0PW49PT12b2lkIDA/MDpuLGU9by50b0luZGV4LHM9ZT09PXZvaWQgMD9yLmxlbmd0aDplO2lmKHQ8MHx8dD49ci5sZW5ndGh8fCFOdW1iZXIuaXNJbnRlZ2VyKHQpKXRocm93IG5ldyBFcnJvcigiZnJvbUluZGV4IG11c3QgYmUgYSBwb3NpdGl2ZSBpbnRlZ2VyIHNtYWxsZXIgdGhhbiBsZW5ndGgiKTtpZihzPD10fHxzPnIubGVuZ3RofHwhTnVtYmVyLmlzSW50ZWdlcihzKSl0aHJvdyBuZXcgRXJyb3IoInRvSW5kZXggbXVzdCBiZSBhbiBpbnRlZ2VyIGdyZWF0ZXIgdGhhbiBmcm9tSW5kZXggYW5kIGF0IG1vc3QgZXF1YWwgdG8gbGVuZ3RoIik7Zm9yKHZhciBpPXJbdF0sdT10KzE7dTxzO3UrKylyW3VdPGkmJihpPXJbdV0pO3JldHVybiBpfWZ1bmN0aW9uIGV0KHIpe3ZhciBvPWFyZ3VtZW50cy5sZW5ndGg+MSYmYXJndW1lbnRzWzFdIT09dm9pZCAwP2FyZ3VtZW50c1sxXTp7fTtpZihVKHIpKXtpZihyLmxlbmd0aD09PTApdGhyb3cgbmV3IFR5cGVFcnJvcigiaW5wdXQgbXVzdCBub3QgYmUgZW1wdHkiKX1lbHNlIHRocm93IG5ldyBUeXBlRXJyb3IoImlucHV0IG11c3QgYmUgYW4gYXJyYXkiKTt2YXIgbjtpZihvLm91dHB1dCE9PXZvaWQgMCl7aWYoIVUoby5vdXRwdXQpKXRocm93IG5ldyBUeXBlRXJyb3IoIm91dHB1dCBvcHRpb24gbXVzdCBiZSBhbiBhcnJheSBpZiBzcGVjaWZpZWQiKTtuPW8ub3V0cHV0fWVsc2Ugbj1uZXcgQXJyYXkoci5sZW5ndGgpO3ZhciB0PXNlKHIpLGU9cmUocik7aWYodD09PWUpdGhyb3cgbmV3IFJhbmdlRXJyb3IoIm1pbmltdW0gYW5kIG1heGltdW0gaW5wdXQgdmFsdWVzIGFyZSBlcXVhbC4gQ2Fubm90IHJlc2NhbGUgYSBjb25zdGFudCBhcnJheSIpO3ZhciBzPW8ubWluLGk9cz09PXZvaWQgMD9vLmF1dG9NaW5NYXg/dDowOnMsdT1vLm1heCxmPXU9PT12b2lkIDA/by5hdXRvTWluTWF4P2U6MTp1O2lmKGk+PWYpdGhyb3cgbmV3IFJhbmdlRXJyb3IoIm1pbiBvcHRpb24gbXVzdCBiZSBzbWFsbGVyIHRoYW4gbWF4IG9wdGlvbiIpO2Zvcih2YXIgYT0oZi1pKS8oZS10KSxsPTA7bDxyLmxlbmd0aDtsKyspbltsXT0ocltsXS10KSphK2k7cmV0dXJuIG59Y29uc3QgVz0iICIucmVwZWF0KDIpLG50PSIgIi5yZXBlYXQoNCk7ZnVuY3Rpb24gaWUoKXtyZXR1cm4gb3QodGhpcyl9ZnVuY3Rpb24gb3QocixvPXt9KXtjb25zdHttYXhSb3dzOm49MTUsbWF4Q29sdW1uczp0PTEwLG1heE51bVNpemU6ZT04fT1vO3JldHVybmAke3IuY29uc3RydWN0b3IubmFtZX0gewoke1d9Wwoke250fSR7dWUocixuLHQsZSl9CiR7V31dCiR7V31yb3dzOiAke3Iucm93c30KJHtXfWNvbHVtbnM6ICR7ci5jb2x1bW5zfQp9YH1mdW5jdGlvbiB1ZShyLG8sbix0KXtjb25zdHtyb3dzOmUsY29sdW1uczpzfT1yLGk9TWF0aC5taW4oZSxvKSx1PU1hdGgubWluKHMsbiksZj1bXTtmb3IobGV0IGE9MDthPGk7YSsrKXtsZXQgbD1bXTtmb3IobGV0IHA9MDtwPHU7cCsrKWwucHVzaChoZShyLmdldChhLHApLHQpKTtmLnB1c2goYCR7bC5qb2luKCIgIil9YCl9cmV0dXJuIHUhPT1zJiYoZltmLmxlbmd0aC0xXSs9YCAuLi4gJHtzLW59IG1vcmUgY29sdW1uc2ApLGkhPT1lJiZmLnB1c2goYC4uLiAke2Utb30gbW9yZSByb3dzYCksZi5qb2luKGAKJHtudH1gKX1mdW5jdGlvbiBoZShyLG8pe2NvbnN0IG49U3RyaW5nKHIpO2lmKG4ubGVuZ3RoPD1vKXJldHVybiBuLnBhZEVuZChvLCIgIik7Y29uc3QgdD1yLnRvUHJlY2lzaW9uKG8tMik7aWYodC5sZW5ndGg8PW8pcmV0dXJuIHQ7Y29uc3QgZT1yLnRvRXhwb25lbnRpYWwoby0yKSxzPWUuaW5kZXhPZigiZSIpLGk9ZS5zbGljZShzKTtyZXR1cm4gZS5zbGljZSgwLG8taS5sZW5ndGgpK2l9ZnVuY3Rpb24gbGUocixvKXtyLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24odCl7cmV0dXJuIHR5cGVvZiB0PT0ibnVtYmVyIj90aGlzLmFkZFModCk6dGhpcy5hZGRNKHQpfSxyLnByb3RvdHlwZS5hZGRTPWZ1bmN0aW9uKHQpe2ZvcihsZXQgZT0wO2U8dGhpcy5yb3dzO2UrKylmb3IobGV0IHM9MDtzPHRoaXMuY29sdW1ucztzKyspdGhpcy5zZXQoZSxzLHRoaXMuZ2V0KGUscykrdCk7cmV0dXJuIHRoaXN9LHIucHJvdG90eXBlLmFkZE09ZnVuY3Rpb24odCl7aWYodD1vLmNoZWNrTWF0cml4KHQpLHRoaXMucm93cyE9PXQucm93c3x8dGhpcy5jb2x1bW5zIT09dC5jb2x1bW5zKXRocm93IG5ldyBSYW5nZUVycm9yKCJNYXRyaWNlcyBkaW1lbnNpb25zIG11c3QgYmUgZXF1YWwiKTtmb3IobGV0IGU9MDtlPHRoaXMucm93cztlKyspZm9yKGxldCBzPTA7czx0aGlzLmNvbHVtbnM7cysrKXRoaXMuc2V0KGUscyx0aGlzLmdldChlLHMpK3QuZ2V0KGUscykpO3JldHVybiB0aGlzfSxyLmFkZD1mdW5jdGlvbih0LGUpe3JldHVybiBuZXcgbyh0KS5hZGQoZSl9LHIucHJvdG90eXBlLnN1Yj1mdW5jdGlvbih0KXtyZXR1cm4gdHlwZW9mIHQ9PSJudW1iZXIiP3RoaXMuc3ViUyh0KTp0aGlzLnN1Yk0odCl9LHIucHJvdG90eXBlLnN1YlM9ZnVuY3Rpb24odCl7Zm9yKGxldCBlPTA7ZTx0aGlzLnJvd3M7ZSsrKWZvcihsZXQgcz0wO3M8dGhpcy5jb2x1bW5zO3MrKyl0aGlzLnNldChlLHMsdGhpcy5nZXQoZSxzKS10KTtyZXR1cm4gdGhpc30sci5wcm90b3R5cGUuc3ViTT1mdW5jdGlvbih0KXtpZih0PW8uY2hlY2tNYXRyaXgodCksdGhpcy5yb3dzIT09dC5yb3dzfHx0aGlzLmNvbHVtbnMhPT10LmNvbHVtbnMpdGhyb3cgbmV3IFJhbmdlRXJyb3IoIk1hdHJpY2VzIGRpbWVuc2lvbnMgbXVzdCBiZSBlcXVhbCIpO2ZvcihsZXQgZT0wO2U8dGhpcy5yb3dzO2UrKylmb3IobGV0IHM9MDtzPHRoaXMuY29sdW1ucztzKyspdGhpcy5zZXQoZSxzLHRoaXMuZ2V0KGUscyktdC5nZXQoZSxzKSk7cmV0dXJuIHRoaXN9LHIuc3ViPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIG5ldyBvKHQpLnN1YihlKX0sci5wcm90b3R5cGUuc3VidHJhY3Q9ci5wcm90b3R5cGUuc3ViLHIucHJvdG90eXBlLnN1YnRyYWN0Uz1yLnByb3RvdHlwZS5zdWJTLHIucHJvdG90eXBlLnN1YnRyYWN0TT1yLnByb3RvdHlwZS5zdWJNLHIuc3VidHJhY3Q9ci5zdWIsci5wcm90b3R5cGUubXVsPWZ1bmN0aW9uKHQpe3JldHVybiB0eXBlb2YgdD09Im51bWJlciI/dGhpcy5tdWxTKHQpOnRoaXMubXVsTSh0KX0sci5wcm90b3R5cGUubXVsUz1mdW5jdGlvbih0KXtmb3IobGV0IGU9MDtlPHRoaXMucm93cztlKyspZm9yKGxldCBzPTA7czx0aGlzLmNvbHVtbnM7cysrKXRoaXMuc2V0KGUscyx0aGlzLmdldChlLHMpKnQpO3JldHVybiB0aGlzfSxyLnByb3RvdHlwZS5tdWxNPWZ1bmN0aW9uKHQpe2lmKHQ9by5jaGVja01hdHJpeCh0KSx0aGlzLnJvd3MhPT10LnJvd3N8fHRoaXMuY29sdW1ucyE9PXQuY29sdW1ucyl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiTWF0cmljZXMgZGltZW5zaW9ucyBtdXN0IGJlIGVxdWFsIik7Zm9yKGxldCBlPTA7ZTx0aGlzLnJvd3M7ZSsrKWZvcihsZXQgcz0wO3M8dGhpcy5jb2x1bW5zO3MrKyl0aGlzLnNldChlLHMsdGhpcy5nZXQoZSxzKSp0LmdldChlLHMpKTtyZXR1cm4gdGhpc30sci5tdWw9ZnVuY3Rpb24odCxlKXtyZXR1cm4gbmV3IG8odCkubXVsKGUpfSxyLnByb3RvdHlwZS5tdWx0aXBseT1yLnByb3RvdHlwZS5tdWwsci5wcm90b3R5cGUubXVsdGlwbHlTPXIucHJvdG90eXBlLm11bFMsci5wcm90b3R5cGUubXVsdGlwbHlNPXIucHJvdG90eXBlLm11bE0sci5tdWx0aXBseT1yLm11bCxyLnByb3RvdHlwZS5kaXY9ZnVuY3Rpb24odCl7cmV0dXJuIHR5cGVvZiB0PT0ibnVtYmVyIj90aGlzLmRpdlModCk6dGhpcy5kaXZNKHQpfSxyLnByb3RvdHlwZS5kaXZTPWZ1bmN0aW9uKHQpe2ZvcihsZXQgZT0wO2U8dGhpcy5yb3dzO2UrKylmb3IobGV0IHM9MDtzPHRoaXMuY29sdW1ucztzKyspdGhpcy5zZXQoZSxzLHRoaXMuZ2V0KGUscykvdCk7cmV0dXJuIHRoaXN9LHIucHJvdG90eXBlLmRpdk09ZnVuY3Rpb24odCl7aWYodD1vLmNoZWNrTWF0cml4KHQpLHRoaXMucm93cyE9PXQucm93c3x8dGhpcy5jb2x1bW5zIT09dC5jb2x1bW5zKXRocm93IG5ldyBSYW5nZUVycm9yKCJNYXRyaWNlcyBkaW1lbnNpb25zIG11c3QgYmUgZXF1YWwiKTtmb3IobGV0IGU9MDtlPHRoaXMucm93cztlKyspZm9yKGxldCBzPTA7czx0aGlzLmNvbHVtbnM7cysrKXRoaXMuc2V0KGUscyx0aGlzLmdldChlLHMpL3QuZ2V0KGUscykpO3JldHVybiB0aGlzfSxyLmRpdj1mdW5jdGlvbih0LGUpe3JldHVybiBuZXcgbyh0KS5kaXYoZSl9LHIucHJvdG90eXBlLmRpdmlkZT1yLnByb3RvdHlwZS5kaXYsci5wcm90b3R5cGUuZGl2aWRlUz1yLnByb3RvdHlwZS5kaXZTLHIucHJvdG90eXBlLmRpdmlkZU09ci5wcm90b3R5cGUuZGl2TSxyLmRpdmlkZT1yLmRpdixyLnByb3RvdHlwZS5tb2Q9ZnVuY3Rpb24odCl7cmV0dXJuIHR5cGVvZiB0PT0ibnVtYmVyIj90aGlzLm1vZFModCk6dGhpcy5tb2RNKHQpfSxyLnByb3RvdHlwZS5tb2RTPWZ1bmN0aW9uKHQpe2ZvcihsZXQgZT0wO2U8dGhpcy5yb3dzO2UrKylmb3IobGV0IHM9MDtzPHRoaXMuY29sdW1ucztzKyspdGhpcy5zZXQoZSxzLHRoaXMuZ2V0KGUscykldCk7cmV0dXJuIHRoaXN9LHIucHJvdG90eXBlLm1vZE09ZnVuY3Rpb24odCl7aWYodD1vLmNoZWNrTWF0cml4KHQpLHRoaXMucm93cyE9PXQucm93c3x8dGhpcy5jb2x1bW5zIT09dC5jb2x1bW5zKXRocm93IG5ldyBSYW5nZUVycm9yKCJNYXRyaWNlcyBkaW1lbnNpb25zIG11c3QgYmUgZXF1YWwiKTtmb3IobGV0IGU9MDtlPHRoaXMucm93cztlKyspZm9yKGxldCBzPTA7czx0aGlzLmNvbHVtbnM7cysrKXRoaXMuc2V0KGUscyx0aGlzLmdldChlLHMpJXQuZ2V0KGUscykpO3JldHVybiB0aGlzfSxyLm1vZD1mdW5jdGlvbih0LGUpe3JldHVybiBuZXcgbyh0KS5tb2QoZSl9LHIucHJvdG90eXBlLm1vZHVsdXM9ci5wcm90b3R5cGUubW9kLHIucHJvdG90eXBlLm1vZHVsdXNTPXIucHJvdG90eXBlLm1vZFMsci5wcm90b3R5cGUubW9kdWx1c009ci5wcm90b3R5cGUubW9kTSxyLm1vZHVsdXM9ci5tb2Qsci5wcm90b3R5cGUuYW5kPWZ1bmN0aW9uKHQpe3JldHVybiB0eXBlb2YgdD09Im51bWJlciI/dGhpcy5hbmRTKHQpOnRoaXMuYW5kTSh0KX0sci5wcm90b3R5cGUuYW5kUz1mdW5jdGlvbih0KXtmb3IobGV0IGU9MDtlPHRoaXMucm93cztlKyspZm9yKGxldCBzPTA7czx0aGlzLmNvbHVtbnM7cysrKXRoaXMuc2V0KGUscyx0aGlzLmdldChlLHMpJnQpO3JldHVybiB0aGlzfSxyLnByb3RvdHlwZS5hbmRNPWZ1bmN0aW9uKHQpe2lmKHQ9by5jaGVja01hdHJpeCh0KSx0aGlzLnJvd3MhPT10LnJvd3N8fHRoaXMuY29sdW1ucyE9PXQuY29sdW1ucyl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiTWF0cmljZXMgZGltZW5zaW9ucyBtdXN0IGJlIGVxdWFsIik7Zm9yKGxldCBlPTA7ZTx0aGlzLnJvd3M7ZSsrKWZvcihsZXQgcz0wO3M8dGhpcy5jb2x1bW5zO3MrKyl0aGlzLnNldChlLHMsdGhpcy5nZXQoZSxzKSZ0LmdldChlLHMpKTtyZXR1cm4gdGhpc30sci5hbmQ9ZnVuY3Rpb24odCxlKXtyZXR1cm4gbmV3IG8odCkuYW5kKGUpfSxyLnByb3RvdHlwZS5vcj1mdW5jdGlvbih0KXtyZXR1cm4gdHlwZW9mIHQ9PSJudW1iZXIiP3RoaXMub3JTKHQpOnRoaXMub3JNKHQpfSxyLnByb3RvdHlwZS5vclM9ZnVuY3Rpb24odCl7Zm9yKGxldCBlPTA7ZTx0aGlzLnJvd3M7ZSsrKWZvcihsZXQgcz0wO3M8dGhpcy5jb2x1bW5zO3MrKyl0aGlzLnNldChlLHMsdGhpcy5nZXQoZSxzKXx0KTtyZXR1cm4gdGhpc30sci5wcm90b3R5cGUub3JNPWZ1bmN0aW9uKHQpe2lmKHQ9by5jaGVja01hdHJpeCh0KSx0aGlzLnJvd3MhPT10LnJvd3N8fHRoaXMuY29sdW1ucyE9PXQuY29sdW1ucyl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiTWF0cmljZXMgZGltZW5zaW9ucyBtdXN0IGJlIGVxdWFsIik7Zm9yKGxldCBlPTA7ZTx0aGlzLnJvd3M7ZSsrKWZvcihsZXQgcz0wO3M8dGhpcy5jb2x1bW5zO3MrKyl0aGlzLnNldChlLHMsdGhpcy5nZXQoZSxzKXx0LmdldChlLHMpKTtyZXR1cm4gdGhpc30sci5vcj1mdW5jdGlvbih0LGUpe3JldHVybiBuZXcgbyh0KS5vcihlKX0sci5wcm90b3R5cGUueG9yPWZ1bmN0aW9uKHQpe3JldHVybiB0eXBlb2YgdD09Im51bWJlciI/dGhpcy54b3JTKHQpOnRoaXMueG9yTSh0KX0sci5wcm90b3R5cGUueG9yUz1mdW5jdGlvbih0KXtmb3IobGV0IGU9MDtlPHRoaXMucm93cztlKyspZm9yKGxldCBzPTA7czx0aGlzLmNvbHVtbnM7cysrKXRoaXMuc2V0KGUscyx0aGlzLmdldChlLHMpXnQpO3JldHVybiB0aGlzfSxyLnByb3RvdHlwZS54b3JNPWZ1bmN0aW9uKHQpe2lmKHQ9by5jaGVja01hdHJpeCh0KSx0aGlzLnJvd3MhPT10LnJvd3N8fHRoaXMuY29sdW1ucyE9PXQuY29sdW1ucyl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiTWF0cmljZXMgZGltZW5zaW9ucyBtdXN0IGJlIGVxdWFsIik7Zm9yKGxldCBlPTA7ZTx0aGlzLnJvd3M7ZSsrKWZvcihsZXQgcz0wO3M8dGhpcy5jb2x1bW5zO3MrKyl0aGlzLnNldChlLHMsdGhpcy5nZXQoZSxzKV50LmdldChlLHMpKTtyZXR1cm4gdGhpc30sci54b3I9ZnVuY3Rpb24odCxlKXtyZXR1cm4gbmV3IG8odCkueG9yKGUpfSxyLnByb3RvdHlwZS5sZWZ0U2hpZnQ9ZnVuY3Rpb24odCl7cmV0dXJuIHR5cGVvZiB0PT0ibnVtYmVyIj90aGlzLmxlZnRTaGlmdFModCk6dGhpcy5sZWZ0U2hpZnRNKHQpfSxyLnByb3RvdHlwZS5sZWZ0U2hpZnRTPWZ1bmN0aW9uKHQpe2ZvcihsZXQgZT0wO2U8dGhpcy5yb3dzO2UrKylmb3IobGV0IHM9MDtzPHRoaXMuY29sdW1ucztzKyspdGhpcy5zZXQoZSxzLHRoaXMuZ2V0KGUscyk8PHQpO3JldHVybiB0aGlzfSxyLnByb3RvdHlwZS5sZWZ0U2hpZnRNPWZ1bmN0aW9uKHQpe2lmKHQ9by5jaGVja01hdHJpeCh0KSx0aGlzLnJvd3MhPT10LnJvd3N8fHRoaXMuY29sdW1ucyE9PXQuY29sdW1ucyl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiTWF0cmljZXMgZGltZW5zaW9ucyBtdXN0IGJlIGVxdWFsIik7Zm9yKGxldCBlPTA7ZTx0aGlzLnJvd3M7ZSsrKWZvcihsZXQgcz0wO3M8dGhpcy5jb2x1bW5zO3MrKyl0aGlzLnNldChlLHMsdGhpcy5nZXQoZSxzKTw8dC5nZXQoZSxzKSk7cmV0dXJuIHRoaXN9LHIubGVmdFNoaWZ0PWZ1bmN0aW9uKHQsZSl7cmV0dXJuIG5ldyBvKHQpLmxlZnRTaGlmdChlKX0sci5wcm90b3R5cGUuc2lnblByb3BhZ2F0aW5nUmlnaHRTaGlmdD1mdW5jdGlvbih0KXtyZXR1cm4gdHlwZW9mIHQ9PSJudW1iZXIiP3RoaXMuc2lnblByb3BhZ2F0aW5nUmlnaHRTaGlmdFModCk6dGhpcy5zaWduUHJvcGFnYXRpbmdSaWdodFNoaWZ0TSh0KX0sci5wcm90b3R5cGUuc2lnblByb3BhZ2F0aW5nUmlnaHRTaGlmdFM9ZnVuY3Rpb24odCl7Zm9yKGxldCBlPTA7ZTx0aGlzLnJvd3M7ZSsrKWZvcihsZXQgcz0wO3M8dGhpcy5jb2x1bW5zO3MrKyl0aGlzLnNldChlLHMsdGhpcy5nZXQoZSxzKT4+dCk7cmV0dXJuIHRoaXN9LHIucHJvdG90eXBlLnNpZ25Qcm9wYWdhdGluZ1JpZ2h0U2hpZnRNPWZ1bmN0aW9uKHQpe2lmKHQ9by5jaGVja01hdHJpeCh0KSx0aGlzLnJvd3MhPT10LnJvd3N8fHRoaXMuY29sdW1ucyE9PXQuY29sdW1ucyl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiTWF0cmljZXMgZGltZW5zaW9ucyBtdXN0IGJlIGVxdWFsIik7Zm9yKGxldCBlPTA7ZTx0aGlzLnJvd3M7ZSsrKWZvcihsZXQgcz0wO3M8dGhpcy5jb2x1bW5zO3MrKyl0aGlzLnNldChlLHMsdGhpcy5nZXQoZSxzKT4+dC5nZXQoZSxzKSk7cmV0dXJuIHRoaXN9LHIuc2lnblByb3BhZ2F0aW5nUmlnaHRTaGlmdD1mdW5jdGlvbih0LGUpe3JldHVybiBuZXcgbyh0KS5zaWduUHJvcGFnYXRpbmdSaWdodFNoaWZ0KGUpfSxyLnByb3RvdHlwZS5yaWdodFNoaWZ0PWZ1bmN0aW9uKHQpe3JldHVybiB0eXBlb2YgdD09Im51bWJlciI/dGhpcy5yaWdodFNoaWZ0Uyh0KTp0aGlzLnJpZ2h0U2hpZnRNKHQpfSxyLnByb3RvdHlwZS5yaWdodFNoaWZ0Uz1mdW5jdGlvbih0KXtmb3IobGV0IGU9MDtlPHRoaXMucm93cztlKyspZm9yKGxldCBzPTA7czx0aGlzLmNvbHVtbnM7cysrKXRoaXMuc2V0KGUscyx0aGlzLmdldChlLHMpPj4+dCk7cmV0dXJuIHRoaXN9LHIucHJvdG90eXBlLnJpZ2h0U2hpZnRNPWZ1bmN0aW9uKHQpe2lmKHQ9by5jaGVja01hdHJpeCh0KSx0aGlzLnJvd3MhPT10LnJvd3N8fHRoaXMuY29sdW1ucyE9PXQuY29sdW1ucyl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiTWF0cmljZXMgZGltZW5zaW9ucyBtdXN0IGJlIGVxdWFsIik7Zm9yKGxldCBlPTA7ZTx0aGlzLnJvd3M7ZSsrKWZvcihsZXQgcz0wO3M8dGhpcy5jb2x1bW5zO3MrKyl0aGlzLnNldChlLHMsdGhpcy5nZXQoZSxzKT4+PnQuZ2V0KGUscykpO3JldHVybiB0aGlzfSxyLnJpZ2h0U2hpZnQ9ZnVuY3Rpb24odCxlKXtyZXR1cm4gbmV3IG8odCkucmlnaHRTaGlmdChlKX0sci5wcm90b3R5cGUuemVyb0ZpbGxSaWdodFNoaWZ0PXIucHJvdG90eXBlLnJpZ2h0U2hpZnQsci5wcm90b3R5cGUuemVyb0ZpbGxSaWdodFNoaWZ0Uz1yLnByb3RvdHlwZS5yaWdodFNoaWZ0UyxyLnByb3RvdHlwZS56ZXJvRmlsbFJpZ2h0U2hpZnRNPXIucHJvdG90eXBlLnJpZ2h0U2hpZnRNLHIuemVyb0ZpbGxSaWdodFNoaWZ0PXIucmlnaHRTaGlmdCxyLnByb3RvdHlwZS5ub3Q9ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCBlPTA7ZTx0aGlzLmNvbHVtbnM7ZSsrKXRoaXMuc2V0KHQsZSx+dGhpcy5nZXQodCxlKSk7cmV0dXJuIHRoaXN9LHIubm90PWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgbyh0KS5ub3QoKX0sci5wcm90b3R5cGUuYWJzPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgZT0wO2U8dGhpcy5jb2x1bW5zO2UrKyl0aGlzLnNldCh0LGUsTWF0aC5hYnModGhpcy5nZXQodCxlKSkpO3JldHVybiB0aGlzfSxyLmFicz1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG8odCkuYWJzKCl9LHIucHJvdG90eXBlLmFjb3M9ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCBlPTA7ZTx0aGlzLmNvbHVtbnM7ZSsrKXRoaXMuc2V0KHQsZSxNYXRoLmFjb3ModGhpcy5nZXQodCxlKSkpO3JldHVybiB0aGlzfSxyLmFjb3M9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBvKHQpLmFjb3MoKX0sci5wcm90b3R5cGUuYWNvc2g9ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCBlPTA7ZTx0aGlzLmNvbHVtbnM7ZSsrKXRoaXMuc2V0KHQsZSxNYXRoLmFjb3NoKHRoaXMuZ2V0KHQsZSkpKTtyZXR1cm4gdGhpc30sci5hY29zaD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG8odCkuYWNvc2goKX0sci5wcm90b3R5cGUuYXNpbj1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IGU9MDtlPHRoaXMuY29sdW1ucztlKyspdGhpcy5zZXQodCxlLE1hdGguYXNpbih0aGlzLmdldCh0LGUpKSk7cmV0dXJuIHRoaXN9LHIuYXNpbj1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG8odCkuYXNpbigpfSxyLnByb3RvdHlwZS5hc2luaD1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IGU9MDtlPHRoaXMuY29sdW1ucztlKyspdGhpcy5zZXQodCxlLE1hdGguYXNpbmgodGhpcy5nZXQodCxlKSkpO3JldHVybiB0aGlzfSxyLmFzaW5oPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgbyh0KS5hc2luaCgpfSxyLnByb3RvdHlwZS5hdGFuPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgZT0wO2U8dGhpcy5jb2x1bW5zO2UrKyl0aGlzLnNldCh0LGUsTWF0aC5hdGFuKHRoaXMuZ2V0KHQsZSkpKTtyZXR1cm4gdGhpc30sci5hdGFuPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgbyh0KS5hdGFuKCl9LHIucHJvdG90eXBlLmF0YW5oPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgZT0wO2U8dGhpcy5jb2x1bW5zO2UrKyl0aGlzLnNldCh0LGUsTWF0aC5hdGFuaCh0aGlzLmdldCh0LGUpKSk7cmV0dXJuIHRoaXN9LHIuYXRhbmg9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBvKHQpLmF0YW5oKCl9LHIucHJvdG90eXBlLmNicnQ9ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCBlPTA7ZTx0aGlzLmNvbHVtbnM7ZSsrKXRoaXMuc2V0KHQsZSxNYXRoLmNicnQodGhpcy5nZXQodCxlKSkpO3JldHVybiB0aGlzfSxyLmNicnQ9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBvKHQpLmNicnQoKX0sci5wcm90b3R5cGUuY2VpbD1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IGU9MDtlPHRoaXMuY29sdW1ucztlKyspdGhpcy5zZXQodCxlLE1hdGguY2VpbCh0aGlzLmdldCh0LGUpKSk7cmV0dXJuIHRoaXN9LHIuY2VpbD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG8odCkuY2VpbCgpfSxyLnByb3RvdHlwZS5jbHozMj1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IGU9MDtlPHRoaXMuY29sdW1ucztlKyspdGhpcy5zZXQodCxlLE1hdGguY2x6MzIodGhpcy5nZXQodCxlKSkpO3JldHVybiB0aGlzfSxyLmNsejMyPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgbyh0KS5jbHozMigpfSxyLnByb3RvdHlwZS5jb3M9ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCBlPTA7ZTx0aGlzLmNvbHVtbnM7ZSsrKXRoaXMuc2V0KHQsZSxNYXRoLmNvcyh0aGlzLmdldCh0LGUpKSk7cmV0dXJuIHRoaXN9LHIuY29zPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgbyh0KS5jb3MoKX0sci5wcm90b3R5cGUuY29zaD1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IGU9MDtlPHRoaXMuY29sdW1ucztlKyspdGhpcy5zZXQodCxlLE1hdGguY29zaCh0aGlzLmdldCh0LGUpKSk7cmV0dXJuIHRoaXN9LHIuY29zaD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG8odCkuY29zaCgpfSxyLnByb3RvdHlwZS5leHA9ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCBlPTA7ZTx0aGlzLmNvbHVtbnM7ZSsrKXRoaXMuc2V0KHQsZSxNYXRoLmV4cCh0aGlzLmdldCh0LGUpKSk7cmV0dXJuIHRoaXN9LHIuZXhwPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgbyh0KS5leHAoKX0sci5wcm90b3R5cGUuZXhwbTE9ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCBlPTA7ZTx0aGlzLmNvbHVtbnM7ZSsrKXRoaXMuc2V0KHQsZSxNYXRoLmV4cG0xKHRoaXMuZ2V0KHQsZSkpKTtyZXR1cm4gdGhpc30sci5leHBtMT1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG8odCkuZXhwbTEoKX0sci5wcm90b3R5cGUuZmxvb3I9ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCBlPTA7ZTx0aGlzLmNvbHVtbnM7ZSsrKXRoaXMuc2V0KHQsZSxNYXRoLmZsb29yKHRoaXMuZ2V0KHQsZSkpKTtyZXR1cm4gdGhpc30sci5mbG9vcj1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG8odCkuZmxvb3IoKX0sci5wcm90b3R5cGUuZnJvdW5kPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgZT0wO2U8dGhpcy5jb2x1bW5zO2UrKyl0aGlzLnNldCh0LGUsTWF0aC5mcm91bmQodGhpcy5nZXQodCxlKSkpO3JldHVybiB0aGlzfSxyLmZyb3VuZD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG8odCkuZnJvdW5kKCl9LHIucHJvdG90eXBlLmxvZz1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IGU9MDtlPHRoaXMuY29sdW1ucztlKyspdGhpcy5zZXQodCxlLE1hdGgubG9nKHRoaXMuZ2V0KHQsZSkpKTtyZXR1cm4gdGhpc30sci5sb2c9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBvKHQpLmxvZygpfSxyLnByb3RvdHlwZS5sb2cxcD1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IGU9MDtlPHRoaXMuY29sdW1ucztlKyspdGhpcy5zZXQodCxlLE1hdGgubG9nMXAodGhpcy5nZXQodCxlKSkpO3JldHVybiB0aGlzfSxyLmxvZzFwPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgbyh0KS5sb2cxcCgpfSxyLnByb3RvdHlwZS5sb2cxMD1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IGU9MDtlPHRoaXMuY29sdW1ucztlKyspdGhpcy5zZXQodCxlLE1hdGgubG9nMTAodGhpcy5nZXQodCxlKSkpO3JldHVybiB0aGlzfSxyLmxvZzEwPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgbyh0KS5sb2cxMCgpfSxyLnByb3RvdHlwZS5sb2cyPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgZT0wO2U8dGhpcy5jb2x1bW5zO2UrKyl0aGlzLnNldCh0LGUsTWF0aC5sb2cyKHRoaXMuZ2V0KHQsZSkpKTtyZXR1cm4gdGhpc30sci5sb2cyPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgbyh0KS5sb2cyKCl9LHIucHJvdG90eXBlLnJvdW5kPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgZT0wO2U8dGhpcy5jb2x1bW5zO2UrKyl0aGlzLnNldCh0LGUsTWF0aC5yb3VuZCh0aGlzLmdldCh0LGUpKSk7cmV0dXJuIHRoaXN9LHIucm91bmQ9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBvKHQpLnJvdW5kKCl9LHIucHJvdG90eXBlLnNpZ249ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCBlPTA7ZTx0aGlzLmNvbHVtbnM7ZSsrKXRoaXMuc2V0KHQsZSxNYXRoLnNpZ24odGhpcy5nZXQodCxlKSkpO3JldHVybiB0aGlzfSxyLnNpZ249ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBvKHQpLnNpZ24oKX0sci5wcm90b3R5cGUuc2luPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgZT0wO2U8dGhpcy5jb2x1bW5zO2UrKyl0aGlzLnNldCh0LGUsTWF0aC5zaW4odGhpcy5nZXQodCxlKSkpO3JldHVybiB0aGlzfSxyLnNpbj1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG8odCkuc2luKCl9LHIucHJvdG90eXBlLnNpbmg9ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCBlPTA7ZTx0aGlzLmNvbHVtbnM7ZSsrKXRoaXMuc2V0KHQsZSxNYXRoLnNpbmgodGhpcy5nZXQodCxlKSkpO3JldHVybiB0aGlzfSxyLnNpbmg9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBvKHQpLnNpbmgoKX0sci5wcm90b3R5cGUuc3FydD1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IGU9MDtlPHRoaXMuY29sdW1ucztlKyspdGhpcy5zZXQodCxlLE1hdGguc3FydCh0aGlzLmdldCh0LGUpKSk7cmV0dXJuIHRoaXN9LHIuc3FydD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG8odCkuc3FydCgpfSxyLnByb3RvdHlwZS50YW49ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCBlPTA7ZTx0aGlzLmNvbHVtbnM7ZSsrKXRoaXMuc2V0KHQsZSxNYXRoLnRhbih0aGlzLmdldCh0LGUpKSk7cmV0dXJuIHRoaXN9LHIudGFuPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgbyh0KS50YW4oKX0sci5wcm90b3R5cGUudGFuaD1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IGU9MDtlPHRoaXMuY29sdW1ucztlKyspdGhpcy5zZXQodCxlLE1hdGgudGFuaCh0aGlzLmdldCh0LGUpKSk7cmV0dXJuIHRoaXN9LHIudGFuaD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG8odCkudGFuaCgpfSxyLnByb3RvdHlwZS50cnVuYz1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IGU9MDtlPHRoaXMuY29sdW1ucztlKyspdGhpcy5zZXQodCxlLE1hdGgudHJ1bmModGhpcy5nZXQodCxlKSkpO3JldHVybiB0aGlzfSxyLnRydW5jPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgbyh0KS50cnVuYygpfSxyLnBvdz1mdW5jdGlvbih0LGUpe3JldHVybiBuZXcgbyh0KS5wb3coZSl9LHIucHJvdG90eXBlLnBvdz1mdW5jdGlvbih0KXtyZXR1cm4gdHlwZW9mIHQ9PSJudW1iZXIiP3RoaXMucG93Uyh0KTp0aGlzLnBvd00odCl9LHIucHJvdG90eXBlLnBvd1M9ZnVuY3Rpb24odCl7Zm9yKGxldCBlPTA7ZTx0aGlzLnJvd3M7ZSsrKWZvcihsZXQgcz0wO3M8dGhpcy5jb2x1bW5zO3MrKyl0aGlzLnNldChlLHMsTWF0aC5wb3codGhpcy5nZXQoZSxzKSx0KSk7cmV0dXJuIHRoaXN9LHIucHJvdG90eXBlLnBvd009ZnVuY3Rpb24odCl7aWYodD1vLmNoZWNrTWF0cml4KHQpLHRoaXMucm93cyE9PXQucm93c3x8dGhpcy5jb2x1bW5zIT09dC5jb2x1bW5zKXRocm93IG5ldyBSYW5nZUVycm9yKCJNYXRyaWNlcyBkaW1lbnNpb25zIG11c3QgYmUgZXF1YWwiKTtmb3IobGV0IGU9MDtlPHRoaXMucm93cztlKyspZm9yKGxldCBzPTA7czx0aGlzLmNvbHVtbnM7cysrKXRoaXMuc2V0KGUscyxNYXRoLnBvdyh0aGlzLmdldChlLHMpLHQuZ2V0KGUscykpKTtyZXR1cm4gdGhpc319ZnVuY3Rpb24gVihyLG8sbil7bGV0IHQ9bj9yLnJvd3M6ci5yb3dzLTE7aWYobzwwfHxvPnQpdGhyb3cgbmV3IFJhbmdlRXJyb3IoIlJvdyBpbmRleCBvdXQgb2YgcmFuZ2UiKX1mdW5jdGlvbiBDKHIsbyxuKXtsZXQgdD1uP3IuY29sdW1uczpyLmNvbHVtbnMtMTtpZihvPDB8fG8+dCl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiQ29sdW1uIGluZGV4IG91dCBvZiByYW5nZSIpfWZ1bmN0aW9uIEIocixvKXtpZihvLnRvMURBcnJheSYmKG89by50bzFEQXJyYXkoKSksby5sZW5ndGghPT1yLmNvbHVtbnMpdGhyb3cgbmV3IFJhbmdlRXJyb3IoInZlY3RvciBzaXplIG11c3QgYmUgdGhlIHNhbWUgYXMgdGhlIG51bWJlciBvZiBjb2x1bW5zIik7cmV0dXJuIG99ZnVuY3Rpb24gTyhyLG8pe2lmKG8udG8xREFycmF5JiYobz1vLnRvMURBcnJheSgpKSxvLmxlbmd0aCE9PXIucm93cyl0aHJvdyBuZXcgUmFuZ2VFcnJvcigidmVjdG9yIHNpemUgbXVzdCBiZSB0aGUgc2FtZSBhcyB0aGUgbnVtYmVyIG9mIHJvd3MiKTtyZXR1cm4gb31mdW5jdGlvbiBmZShyLG8sbil7cmV0dXJue3JvdzpjZShyLG8pLGNvbHVtbjp3ZShyLG4pfX1mdW5jdGlvbiBjZShyLG8pe2lmKHR5cGVvZiBvIT0ib2JqZWN0Iil0aHJvdyBuZXcgVHlwZUVycm9yKCJ1bmV4cGVjdGVkIHR5cGUgZm9yIHJvdyBpbmRpY2VzIik7aWYoby5zb21lKHQ9PnQ8MHx8dD49ci5yb3dzKSl0aHJvdyBuZXcgUmFuZ2VFcnJvcigicm93IGluZGljZXMgYXJlIG91dCBvZiByYW5nZSIpO3JldHVybiBBcnJheS5pc0FycmF5KG8pfHwobz1BcnJheS5mcm9tKG8pKSxvfWZ1bmN0aW9uIHdlKHIsbyl7aWYodHlwZW9mIG8hPSJvYmplY3QiKXRocm93IG5ldyBUeXBlRXJyb3IoInVuZXhwZWN0ZWQgdHlwZSBmb3IgY29sdW1uIGluZGljZXMiKTtpZihvLnNvbWUodD0+dDwwfHx0Pj1yLmNvbHVtbnMpKXRocm93IG5ldyBSYW5nZUVycm9yKCJjb2x1bW4gaW5kaWNlcyBhcmUgb3V0IG9mIHJhbmdlIik7cmV0dXJuIEFycmF5LmlzQXJyYXkobyl8fChvPUFycmF5LmZyb20obykpLG99ZnVuY3Rpb24gcnQocixvLG4sdCxlKXtpZihhcmd1bWVudHMubGVuZ3RoIT09NSl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiZXhwZWN0ZWQgNCBhcmd1bWVudHMiKTtpZihLKCJzdGFydFJvdyIsbyksSygiZW5kUm93IixuKSxLKCJzdGFydENvbHVtbiIsdCksSygiZW5kQ29sdW1uIixlKSxvPm58fHQ+ZXx8bzwwfHxvPj1yLnJvd3N8fG48MHx8bj49ci5yb3dzfHx0PDB8fHQ+PXIuY29sdW1uc3x8ZTwwfHxlPj1yLmNvbHVtbnMpdGhyb3cgbmV3IFJhbmdlRXJyb3IoIlN1Ym1hdHJpeCBpbmRpY2VzIGFyZSBvdXQgb2YgcmFuZ2UiKX1mdW5jdGlvbiBYKHIsbz0wKXtsZXQgbj1bXTtmb3IobGV0IHQ9MDt0PHI7dCsrKW4ucHVzaChvKTtyZXR1cm4gbn1mdW5jdGlvbiBLKHIsbyl7aWYodHlwZW9mIG8hPSJudW1iZXIiKXRocm93IG5ldyBUeXBlRXJyb3IoYCR7cn0gbXVzdCBiZSBhIG51bWJlcmApfWZ1bmN0aW9uIEgocil7aWYoci5pc0VtcHR5KCkpdGhyb3cgbmV3IEVycm9yKCJFbXB0eSBtYXRyaXggaGFzIG5vIGVsZW1lbnRzIHRvIGluZGV4Iil9ZnVuY3Rpb24gYWUocil7bGV0IG89WChyLnJvd3MpO2ZvcihsZXQgbj0wO248ci5yb3dzOysrbilmb3IobGV0IHQ9MDt0PHIuY29sdW1uczsrK3Qpb1tuXSs9ci5nZXQobix0KTtyZXR1cm4gb31mdW5jdGlvbiBnZShyKXtsZXQgbz1YKHIuY29sdW1ucyk7Zm9yKGxldCBuPTA7bjxyLnJvd3M7KytuKWZvcihsZXQgdD0wO3Q8ci5jb2x1bW5zOysrdClvW3RdKz1yLmdldChuLHQpO3JldHVybiBvfWZ1bmN0aW9uIHBlKHIpe2xldCBvPTA7Zm9yKGxldCBuPTA7bjxyLnJvd3M7bisrKWZvcihsZXQgdD0wO3Q8ci5jb2x1bW5zO3QrKylvKz1yLmdldChuLHQpO3JldHVybiBvfWZ1bmN0aW9uIG1lKHIpe2xldCBvPVgoci5yb3dzLDEpO2ZvcihsZXQgbj0wO248ci5yb3dzOysrbilmb3IobGV0IHQ9MDt0PHIuY29sdW1uczsrK3Qpb1tuXSo9ci5nZXQobix0KTtyZXR1cm4gb31mdW5jdGlvbiBkZShyKXtsZXQgbz1YKHIuY29sdW1ucywxKTtmb3IobGV0IG49MDtuPHIucm93czsrK24pZm9yKGxldCB0PTA7dDxyLmNvbHVtbnM7Kyt0KW9bdF0qPXIuZ2V0KG4sdCk7cmV0dXJuIG99ZnVuY3Rpb24geWUocil7bGV0IG89MTtmb3IobGV0IG49MDtuPHIucm93cztuKyspZm9yKGxldCB0PTA7dDxyLmNvbHVtbnM7dCsrKW8qPXIuZ2V0KG4sdCk7cmV0dXJuIG99ZnVuY3Rpb24gdmUocixvLG4pe2NvbnN0IHQ9ci5yb3dzLGU9ci5jb2x1bW5zLHM9W107Zm9yKGxldCBpPTA7aTx0O2krKyl7bGV0IHU9MCxmPTAsYT0wO2ZvcihsZXQgbD0wO2w8ZTtsKyspYT1yLmdldChpLGwpLW5baV0sdSs9YSxmKz1hKmE7bz9zLnB1c2goKGYtdSp1L2UpLyhlLTEpKTpzLnB1c2goKGYtdSp1L2UpL2UpfXJldHVybiBzfWZ1bmN0aW9uIGplKHIsbyxuKXtjb25zdCB0PXIucm93cyxlPXIuY29sdW1ucyxzPVtdO2ZvcihsZXQgaT0wO2k8ZTtpKyspe2xldCB1PTAsZj0wLGE9MDtmb3IobGV0IGw9MDtsPHQ7bCsrKWE9ci5nZXQobCxpKS1uW2ldLHUrPWEsZis9YSphO28/cy5wdXNoKChmLXUqdS90KS8odC0xKSk6cy5wdXNoKChmLXUqdS90KS90KX1yZXR1cm4gc31mdW5jdGlvbiBTZShyLG8sbil7Y29uc3QgdD1yLnJvd3MsZT1yLmNvbHVtbnMscz10KmU7bGV0IGk9MCx1PTAsZj0wO2ZvcihsZXQgYT0wO2E8dDthKyspZm9yKGxldCBsPTA7bDxlO2wrKylmPXIuZ2V0KGEsbCktbixpKz1mLHUrPWYqZjtyZXR1cm4gbz8odS1pKmkvcykvKHMtMSk6KHUtaSppL3MpL3N9ZnVuY3Rpb24gRWUocixvKXtmb3IobGV0IG49MDtuPHIucm93cztuKyspZm9yKGxldCB0PTA7dDxyLmNvbHVtbnM7dCsrKXIuc2V0KG4sdCxyLmdldChuLHQpLW9bbl0pfWZ1bmN0aW9uIE1lKHIsbyl7Zm9yKGxldCBuPTA7bjxyLnJvd3M7bisrKWZvcihsZXQgdD0wO3Q8ci5jb2x1bW5zO3QrKylyLnNldChuLHQsci5nZXQobix0KS1vW3RdKX1mdW5jdGlvbiBrZShyLG8pe2ZvcihsZXQgbj0wO248ci5yb3dzO24rKylmb3IobGV0IHQ9MDt0PHIuY29sdW1uczt0Kyspci5zZXQobix0LHIuZ2V0KG4sdCktbyl9ZnVuY3Rpb24gUmUocil7Y29uc3Qgbz1bXTtmb3IobGV0IG49MDtuPHIucm93cztuKyspe2xldCB0PTA7Zm9yKGxldCBlPTA7ZTxyLmNvbHVtbnM7ZSsrKXQrPU1hdGgucG93KHIuZ2V0KG4sZSksMikvKHIuY29sdW1ucy0xKTtvLnB1c2goTWF0aC5zcXJ0KHQpKX1yZXR1cm4gb31mdW5jdGlvbiBxZShyLG8pe2ZvcihsZXQgbj0wO248ci5yb3dzO24rKylmb3IobGV0IHQ9MDt0PHIuY29sdW1uczt0Kyspci5zZXQobix0LHIuZ2V0KG4sdCkvb1tuXSl9ZnVuY3Rpb24gVGUocil7Y29uc3Qgbz1bXTtmb3IobGV0IG49MDtuPHIuY29sdW1ucztuKyspe2xldCB0PTA7Zm9yKGxldCBlPTA7ZTxyLnJvd3M7ZSsrKXQrPU1hdGgucG93KHIuZ2V0KGUsbiksMikvKHIucm93cy0xKTtvLnB1c2goTWF0aC5zcXJ0KHQpKX1yZXR1cm4gb31mdW5jdGlvbiBJZShyLG8pe2ZvcihsZXQgbj0wO248ci5yb3dzO24rKylmb3IobGV0IHQ9MDt0PHIuY29sdW1uczt0Kyspci5zZXQobix0LHIuZ2V0KG4sdCkvb1t0XSl9ZnVuY3Rpb24gJGUocil7Y29uc3Qgbz1yLnNpemUtMTtsZXQgbj0wO2ZvcihsZXQgdD0wO3Q8ci5jb2x1bW5zO3QrKylmb3IobGV0IGU9MDtlPHIucm93cztlKyspbis9TWF0aC5wb3coci5nZXQoZSx0KSwyKS9vO3JldHVybiBNYXRoLnNxcnQobil9ZnVuY3Rpb24gemUocixvKXtmb3IobGV0IG49MDtuPHIucm93cztuKyspZm9yKGxldCB0PTA7dDxyLmNvbHVtbnM7dCsrKXIuc2V0KG4sdCxyLmdldChuLHQpL28pfWNsYXNzIGp7c3RhdGljIGZyb20xREFycmF5KG8sbix0KXtpZihvKm4hPT10Lmxlbmd0aCl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiZGF0YSBsZW5ndGggZG9lcyBub3QgbWF0Y2ggZ2l2ZW4gZGltZW5zaW9ucyIpO2xldCBzPW5ldyBkKG8sbik7Zm9yKGxldCBpPTA7aTxvO2krKylmb3IobGV0IHU9MDt1PG47dSsrKXMuc2V0KGksdSx0W2kqbit1XSk7cmV0dXJuIHN9c3RhdGljIHJvd1ZlY3RvcihvKXtsZXQgbj1uZXcgZCgxLG8ubGVuZ3RoKTtmb3IobGV0IHQ9MDt0PG8ubGVuZ3RoO3QrKyluLnNldCgwLHQsb1t0XSk7cmV0dXJuIG59c3RhdGljIGNvbHVtblZlY3RvcihvKXtsZXQgbj1uZXcgZChvLmxlbmd0aCwxKTtmb3IobGV0IHQ9MDt0PG8ubGVuZ3RoO3QrKyluLnNldCh0LDAsb1t0XSk7cmV0dXJuIG59c3RhdGljIHplcm9zKG8sbil7cmV0dXJuIG5ldyBkKG8sbil9c3RhdGljIG9uZXMobyxuKXtyZXR1cm4gbmV3IGQobyxuKS5maWxsKDEpfXN0YXRpYyByYW5kKG8sbix0PXt9KXtpZih0eXBlb2YgdCE9Im9iamVjdCIpdGhyb3cgbmV3IFR5cGVFcnJvcigib3B0aW9ucyBtdXN0IGJlIGFuIG9iamVjdCIpO2NvbnN0e3JhbmRvbTplPU1hdGgucmFuZG9tfT10O2xldCBzPW5ldyBkKG8sbik7Zm9yKGxldCBpPTA7aTxvO2krKylmb3IobGV0IHU9MDt1PG47dSsrKXMuc2V0KGksdSxlKCkpO3JldHVybiBzfXN0YXRpYyByYW5kSW50KG8sbix0PXt9KXtpZih0eXBlb2YgdCE9Im9iamVjdCIpdGhyb3cgbmV3IFR5cGVFcnJvcigib3B0aW9ucyBtdXN0IGJlIGFuIG9iamVjdCIpO2NvbnN0e21pbjplPTAsbWF4OnM9MWUzLHJhbmRvbTppPU1hdGgucmFuZG9tfT10O2lmKCFOdW1iZXIuaXNJbnRlZ2VyKGUpKXRocm93IG5ldyBUeXBlRXJyb3IoIm1pbiBtdXN0IGJlIGFuIGludGVnZXIiKTtpZighTnVtYmVyLmlzSW50ZWdlcihzKSl0aHJvdyBuZXcgVHlwZUVycm9yKCJtYXggbXVzdCBiZSBhbiBpbnRlZ2VyIik7aWYoZT49cyl0aHJvdyBuZXcgUmFuZ2VFcnJvcigibWluIG11c3QgYmUgc21hbGxlciB0aGFuIG1heCIpO2xldCB1PXMtZSxmPW5ldyBkKG8sbik7Zm9yKGxldCBhPTA7YTxvO2ErKylmb3IobGV0IGw9MDtsPG47bCsrKXtsZXQgcD1lK01hdGgucm91bmQoaSgpKnUpO2Yuc2V0KGEsbCxwKX1yZXR1cm4gZn1zdGF0aWMgZXllKG8sbix0KXtuPT09dm9pZCAwJiYobj1vKSx0PT09dm9pZCAwJiYodD0xKTtsZXQgZT1NYXRoLm1pbihvLG4pLHM9dGhpcy56ZXJvcyhvLG4pO2ZvcihsZXQgaT0wO2k8ZTtpKyspcy5zZXQoaSxpLHQpO3JldHVybiBzfXN0YXRpYyBkaWFnKG8sbix0KXtsZXQgZT1vLmxlbmd0aDtuPT09dm9pZCAwJiYobj1lKSx0PT09dm9pZCAwJiYodD1uKTtsZXQgcz1NYXRoLm1pbihlLG4sdCksaT10aGlzLnplcm9zKG4sdCk7Zm9yKGxldCB1PTA7dTxzO3UrKylpLnNldCh1LHUsb1t1XSk7cmV0dXJuIGl9c3RhdGljIG1pbihvLG4pe289dGhpcy5jaGVja01hdHJpeChvKSxuPXRoaXMuY2hlY2tNYXRyaXgobik7bGV0IHQ9by5yb3dzLGU9by5jb2x1bW5zLHM9bmV3IGQodCxlKTtmb3IobGV0IGk9MDtpPHQ7aSsrKWZvcihsZXQgdT0wO3U8ZTt1Kyspcy5zZXQoaSx1LE1hdGgubWluKG8uZ2V0KGksdSksbi5nZXQoaSx1KSkpO3JldHVybiBzfXN0YXRpYyBtYXgobyxuKXtvPXRoaXMuY2hlY2tNYXRyaXgobyksbj10aGlzLmNoZWNrTWF0cml4KG4pO2xldCB0PW8ucm93cyxlPW8uY29sdW1ucyxzPW5ldyB0aGlzKHQsZSk7Zm9yKGxldCBpPTA7aTx0O2krKylmb3IobGV0IHU9MDt1PGU7dSsrKXMuc2V0KGksdSxNYXRoLm1heChvLmdldChpLHUpLG4uZ2V0KGksdSkpKTtyZXR1cm4gc31zdGF0aWMgY2hlY2tNYXRyaXgobyl7cmV0dXJuIGouaXNNYXRyaXgobyk/bzpuZXcgZChvKX1zdGF0aWMgaXNNYXRyaXgobyl7cmV0dXJuIG8hPW51bGwmJm8ua2xhc3M9PT0iTWF0cml4In1nZXQgc2l6ZSgpe3JldHVybiB0aGlzLnJvd3MqdGhpcy5jb2x1bW5zfWFwcGx5KG8pe2lmKHR5cGVvZiBvIT0iZnVuY3Rpb24iKXRocm93IG5ldyBUeXBlRXJyb3IoImNhbGxiYWNrIG11c3QgYmUgYSBmdW5jdGlvbiIpO2ZvcihsZXQgbj0wO248dGhpcy5yb3dzO24rKylmb3IobGV0IHQ9MDt0PHRoaXMuY29sdW1uczt0Kyspby5jYWxsKHRoaXMsbix0KTtyZXR1cm4gdGhpc310bzFEQXJyYXkoKXtsZXQgbz1bXTtmb3IobGV0IG49MDtuPHRoaXMucm93cztuKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKW8ucHVzaCh0aGlzLmdldChuLHQpKTtyZXR1cm4gb310bzJEQXJyYXkoKXtsZXQgbz1bXTtmb3IobGV0IG49MDtuPHRoaXMucm93cztuKyspe28ucHVzaChbXSk7Zm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKW9bbl0ucHVzaCh0aGlzLmdldChuLHQpKX1yZXR1cm4gb310b0pTT04oKXtyZXR1cm4gdGhpcy50bzJEQXJyYXkoKX1pc1Jvd1ZlY3Rvcigpe3JldHVybiB0aGlzLnJvd3M9PT0xfWlzQ29sdW1uVmVjdG9yKCl7cmV0dXJuIHRoaXMuY29sdW1ucz09PTF9aXNWZWN0b3IoKXtyZXR1cm4gdGhpcy5yb3dzPT09MXx8dGhpcy5jb2x1bW5zPT09MX1pc1NxdWFyZSgpe3JldHVybiB0aGlzLnJvd3M9PT10aGlzLmNvbHVtbnN9aXNFbXB0eSgpe3JldHVybiB0aGlzLnJvd3M9PT0wfHx0aGlzLmNvbHVtbnM9PT0wfWlzU3ltbWV0cmljKCl7aWYodGhpcy5pc1NxdWFyZSgpKXtmb3IobGV0IG89MDtvPHRoaXMucm93cztvKyspZm9yKGxldCBuPTA7bjw9bztuKyspaWYodGhpcy5nZXQobyxuKSE9PXRoaXMuZ2V0KG4sbykpcmV0dXJuITE7cmV0dXJuITB9cmV0dXJuITF9aXNFY2hlbG9uRm9ybSgpe2xldCBvPTAsbj0wLHQ9LTEsZT0hMCxzPSExO2Zvcig7bzx0aGlzLnJvd3MmJmU7KXtmb3Iobj0wLHM9ITE7bjx0aGlzLmNvbHVtbnMmJnM9PT0hMTspdGhpcy5nZXQobyxuKT09PTA/bisrOnRoaXMuZ2V0KG8sbik9PT0xJiZuPnQ/KHM9ITAsdD1uKTooZT0hMSxzPSEwKTtvKyt9cmV0dXJuIGV9aXNSZWR1Y2VkRWNoZWxvbkZvcm0oKXtsZXQgbz0wLG49MCx0PS0xLGU9ITAscz0hMTtmb3IoO288dGhpcy5yb3dzJiZlOyl7Zm9yKG49MCxzPSExO248dGhpcy5jb2x1bW5zJiZzPT09ITE7KXRoaXMuZ2V0KG8sbik9PT0wP24rKzp0aGlzLmdldChvLG4pPT09MSYmbj50PyhzPSEwLHQ9bik6KGU9ITEscz0hMCk7Zm9yKGxldCBpPW4rMTtpPHRoaXMucm93cztpKyspdGhpcy5nZXQobyxpKSE9PTAmJihlPSExKTtvKyt9cmV0dXJuIGV9ZWNoZWxvbkZvcm0oKXtsZXQgbz10aGlzLmNsb25lKCksbj0wLHQ9MDtmb3IoO248by5yb3dzJiZ0PG8uY29sdW1uczspe2xldCBlPW47Zm9yKGxldCBzPW47czxvLnJvd3M7cysrKW8uZ2V0KHMsdCk+by5nZXQoZSx0KSYmKGU9cyk7aWYoby5nZXQoZSx0KT09PTApdCsrO2Vsc2V7by5zd2FwUm93cyhuLGUpO2xldCBzPW8uZ2V0KG4sdCk7Zm9yKGxldCBpPXQ7aTxvLmNvbHVtbnM7aSsrKW8uc2V0KG4saSxvLmdldChuLGkpL3MpO2ZvcihsZXQgaT1uKzE7aTxvLnJvd3M7aSsrKXtsZXQgdT1vLmdldChpLHQpL28uZ2V0KG4sdCk7by5zZXQoaSx0LDApO2ZvcihsZXQgZj10KzE7ZjxvLmNvbHVtbnM7ZisrKW8uc2V0KGksZixvLmdldChpLGYpLW8uZ2V0KG4sZikqdSl9bisrLHQrK319cmV0dXJuIG99cmVkdWNlZEVjaGVsb25Gb3JtKCl7bGV0IG89dGhpcy5lY2hlbG9uRm9ybSgpLG49by5jb2x1bW5zLHQ9by5yb3dzLGU9dC0xO2Zvcig7ZT49MDspaWYoby5tYXhSb3coZSk9PT0wKWUtLTtlbHNle2xldCBzPTAsaT0hMTtmb3IoO3M8dCYmaT09PSExOylvLmdldChlLHMpPT09MT9pPSEwOnMrKztmb3IobGV0IHU9MDt1PGU7dSsrKXtsZXQgZj1vLmdldCh1LHMpO2ZvcihsZXQgYT1zO2E8bjthKyspe2xldCBsPW8uZ2V0KHUsYSktZipvLmdldChlLGEpO28uc2V0KHUsYSxsKX19ZS0tfXJldHVybiBvfXNldCgpe3Rocm93IG5ldyBFcnJvcigic2V0IG1ldGhvZCBpcyB1bmltcGxlbWVudGVkIil9Z2V0KCl7dGhyb3cgbmV3IEVycm9yKCJnZXQgbWV0aG9kIGlzIHVuaW1wbGVtZW50ZWQiKX1yZXBlYXQobz17fSl7aWYodHlwZW9mIG8hPSJvYmplY3QiKXRocm93IG5ldyBUeXBlRXJyb3IoIm9wdGlvbnMgbXVzdCBiZSBhbiBvYmplY3QiKTtjb25zdHtyb3dzOm49MSxjb2x1bW5zOnQ9MX09bztpZighTnVtYmVyLmlzSW50ZWdlcihuKXx8bjw9MCl0aHJvdyBuZXcgVHlwZUVycm9yKCJyb3dzIG11c3QgYmUgYSBwb3NpdGl2ZSBpbnRlZ2VyIik7aWYoIU51bWJlci5pc0ludGVnZXIodCl8fHQ8PTApdGhyb3cgbmV3IFR5cGVFcnJvcigiY29sdW1ucyBtdXN0IGJlIGEgcG9zaXRpdmUgaW50ZWdlciIpO2xldCBlPW5ldyBkKHRoaXMucm93cypuLHRoaXMuY29sdW1ucyp0KTtmb3IobGV0IHM9MDtzPG47cysrKWZvcihsZXQgaT0wO2k8dDtpKyspZS5zZXRTdWJNYXRyaXgodGhpcyx0aGlzLnJvd3Mqcyx0aGlzLmNvbHVtbnMqaSk7cmV0dXJuIGV9ZmlsbChvKXtmb3IobGV0IG49MDtuPHRoaXMucm93cztuKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKXRoaXMuc2V0KG4sdCxvKTtyZXR1cm4gdGhpc31uZWcoKXtyZXR1cm4gdGhpcy5tdWxTKC0xKX1nZXRSb3cobyl7Vih0aGlzLG8pO2xldCBuPVtdO2ZvcihsZXQgdD0wO3Q8dGhpcy5jb2x1bW5zO3QrKyluLnB1c2godGhpcy5nZXQobyx0KSk7cmV0dXJuIG59Z2V0Um93VmVjdG9yKG8pe3JldHVybiBkLnJvd1ZlY3Rvcih0aGlzLmdldFJvdyhvKSl9c2V0Um93KG8sbil7Vih0aGlzLG8pLG49Qih0aGlzLG4pO2ZvcihsZXQgdD0wO3Q8dGhpcy5jb2x1bW5zO3QrKyl0aGlzLnNldChvLHQsblt0XSk7cmV0dXJuIHRoaXN9c3dhcFJvd3MobyxuKXtWKHRoaXMsbyksVih0aGlzLG4pO2ZvcihsZXQgdD0wO3Q8dGhpcy5jb2x1bW5zO3QrKyl7bGV0IGU9dGhpcy5nZXQobyx0KTt0aGlzLnNldChvLHQsdGhpcy5nZXQobix0KSksdGhpcy5zZXQobix0LGUpfXJldHVybiB0aGlzfWdldENvbHVtbihvKXtDKHRoaXMsbyk7bGV0IG49W107Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKW4ucHVzaCh0aGlzLmdldCh0LG8pKTtyZXR1cm4gbn1nZXRDb2x1bW5WZWN0b3Iobyl7cmV0dXJuIGQuY29sdW1uVmVjdG9yKHRoaXMuZ2V0Q29sdW1uKG8pKX1zZXRDb2x1bW4obyxuKXtDKHRoaXMsbyksbj1PKHRoaXMsbik7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKXRoaXMuc2V0KHQsbyxuW3RdKTtyZXR1cm4gdGhpc31zd2FwQ29sdW1ucyhvLG4pe0ModGhpcyxvKSxDKHRoaXMsbik7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKXtsZXQgZT10aGlzLmdldCh0LG8pO3RoaXMuc2V0KHQsbyx0aGlzLmdldCh0LG4pKSx0aGlzLnNldCh0LG4sZSl9cmV0dXJuIHRoaXN9YWRkUm93VmVjdG9yKG8pe289Qih0aGlzLG8pO2ZvcihsZXQgbj0wO248dGhpcy5yb3dzO24rKylmb3IobGV0IHQ9MDt0PHRoaXMuY29sdW1uczt0KyspdGhpcy5zZXQobix0LHRoaXMuZ2V0KG4sdCkrb1t0XSk7cmV0dXJuIHRoaXN9c3ViUm93VmVjdG9yKG8pe289Qih0aGlzLG8pO2ZvcihsZXQgbj0wO248dGhpcy5yb3dzO24rKylmb3IobGV0IHQ9MDt0PHRoaXMuY29sdW1uczt0KyspdGhpcy5zZXQobix0LHRoaXMuZ2V0KG4sdCktb1t0XSk7cmV0dXJuIHRoaXN9bXVsUm93VmVjdG9yKG8pe289Qih0aGlzLG8pO2ZvcihsZXQgbj0wO248dGhpcy5yb3dzO24rKylmb3IobGV0IHQ9MDt0PHRoaXMuY29sdW1uczt0KyspdGhpcy5zZXQobix0LHRoaXMuZ2V0KG4sdCkqb1t0XSk7cmV0dXJuIHRoaXN9ZGl2Um93VmVjdG9yKG8pe289Qih0aGlzLG8pO2ZvcihsZXQgbj0wO248dGhpcy5yb3dzO24rKylmb3IobGV0IHQ9MDt0PHRoaXMuY29sdW1uczt0KyspdGhpcy5zZXQobix0LHRoaXMuZ2V0KG4sdCkvb1t0XSk7cmV0dXJuIHRoaXN9YWRkQ29sdW1uVmVjdG9yKG8pe289Tyh0aGlzLG8pO2ZvcihsZXQgbj0wO248dGhpcy5yb3dzO24rKylmb3IobGV0IHQ9MDt0PHRoaXMuY29sdW1uczt0KyspdGhpcy5zZXQobix0LHRoaXMuZ2V0KG4sdCkrb1tuXSk7cmV0dXJuIHRoaXN9c3ViQ29sdW1uVmVjdG9yKG8pe289Tyh0aGlzLG8pO2ZvcihsZXQgbj0wO248dGhpcy5yb3dzO24rKylmb3IobGV0IHQ9MDt0PHRoaXMuY29sdW1uczt0KyspdGhpcy5zZXQobix0LHRoaXMuZ2V0KG4sdCktb1tuXSk7cmV0dXJuIHRoaXN9bXVsQ29sdW1uVmVjdG9yKG8pe289Tyh0aGlzLG8pO2ZvcihsZXQgbj0wO248dGhpcy5yb3dzO24rKylmb3IobGV0IHQ9MDt0PHRoaXMuY29sdW1uczt0KyspdGhpcy5zZXQobix0LHRoaXMuZ2V0KG4sdCkqb1tuXSk7cmV0dXJuIHRoaXN9ZGl2Q29sdW1uVmVjdG9yKG8pe289Tyh0aGlzLG8pO2ZvcihsZXQgbj0wO248dGhpcy5yb3dzO24rKylmb3IobGV0IHQ9MDt0PHRoaXMuY29sdW1uczt0KyspdGhpcy5zZXQobix0LHRoaXMuZ2V0KG4sdCkvb1tuXSk7cmV0dXJuIHRoaXN9bXVsUm93KG8sbil7Vih0aGlzLG8pO2ZvcihsZXQgdD0wO3Q8dGhpcy5jb2x1bW5zO3QrKyl0aGlzLnNldChvLHQsdGhpcy5nZXQobyx0KSpuKTtyZXR1cm4gdGhpc31tdWxDb2x1bW4obyxuKXtDKHRoaXMsbyk7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKXRoaXMuc2V0KHQsbyx0aGlzLmdldCh0LG8pKm4pO3JldHVybiB0aGlzfW1heCgpe2lmKHRoaXMuaXNFbXB0eSgpKXJldHVybiBOYU47bGV0IG89dGhpcy5nZXQoMCwwKTtmb3IobGV0IG49MDtuPHRoaXMucm93cztuKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKXRoaXMuZ2V0KG4sdCk+byYmKG89dGhpcy5nZXQobix0KSk7cmV0dXJuIG99bWF4SW5kZXgoKXtIKHRoaXMpO2xldCBvPXRoaXMuZ2V0KDAsMCksbj1bMCwwXTtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCBlPTA7ZTx0aGlzLmNvbHVtbnM7ZSsrKXRoaXMuZ2V0KHQsZSk+byYmKG89dGhpcy5nZXQodCxlKSxuWzBdPXQsblsxXT1lKTtyZXR1cm4gbn1taW4oKXtpZih0aGlzLmlzRW1wdHkoKSlyZXR1cm4gTmFOO2xldCBvPXRoaXMuZ2V0KDAsMCk7Zm9yKGxldCBuPTA7bjx0aGlzLnJvd3M7bisrKWZvcihsZXQgdD0wO3Q8dGhpcy5jb2x1bW5zO3QrKyl0aGlzLmdldChuLHQpPG8mJihvPXRoaXMuZ2V0KG4sdCkpO3JldHVybiBvfW1pbkluZGV4KCl7SCh0aGlzKTtsZXQgbz10aGlzLmdldCgwLDApLG49WzAsMF07Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgZT0wO2U8dGhpcy5jb2x1bW5zO2UrKyl0aGlzLmdldCh0LGUpPG8mJihvPXRoaXMuZ2V0KHQsZSksblswXT10LG5bMV09ZSk7cmV0dXJuIG59bWF4Um93KG8pe2lmKFYodGhpcyxvKSx0aGlzLmlzRW1wdHkoKSlyZXR1cm4gTmFOO2xldCBuPXRoaXMuZ2V0KG8sMCk7Zm9yKGxldCB0PTE7dDx0aGlzLmNvbHVtbnM7dCsrKXRoaXMuZ2V0KG8sdCk+biYmKG49dGhpcy5nZXQobyx0KSk7cmV0dXJuIG59bWF4Um93SW5kZXgobyl7Vih0aGlzLG8pLEgodGhpcyk7bGV0IG49dGhpcy5nZXQobywwKSx0PVtvLDBdO2ZvcihsZXQgZT0xO2U8dGhpcy5jb2x1bW5zO2UrKyl0aGlzLmdldChvLGUpPm4mJihuPXRoaXMuZ2V0KG8sZSksdFsxXT1lKTtyZXR1cm4gdH1taW5Sb3cobyl7aWYoVih0aGlzLG8pLHRoaXMuaXNFbXB0eSgpKXJldHVybiBOYU47bGV0IG49dGhpcy5nZXQobywwKTtmb3IobGV0IHQ9MTt0PHRoaXMuY29sdW1uczt0KyspdGhpcy5nZXQobyx0KTxuJiYobj10aGlzLmdldChvLHQpKTtyZXR1cm4gbn1taW5Sb3dJbmRleChvKXtWKHRoaXMsbyksSCh0aGlzKTtsZXQgbj10aGlzLmdldChvLDApLHQ9W28sMF07Zm9yKGxldCBlPTE7ZTx0aGlzLmNvbHVtbnM7ZSsrKXRoaXMuZ2V0KG8sZSk8biYmKG49dGhpcy5nZXQobyxlKSx0WzFdPWUpO3JldHVybiB0fW1heENvbHVtbihvKXtpZihDKHRoaXMsbyksdGhpcy5pc0VtcHR5KCkpcmV0dXJuIE5hTjtsZXQgbj10aGlzLmdldCgwLG8pO2ZvcihsZXQgdD0xO3Q8dGhpcy5yb3dzO3QrKyl0aGlzLmdldCh0LG8pPm4mJihuPXRoaXMuZ2V0KHQsbykpO3JldHVybiBufW1heENvbHVtbkluZGV4KG8pe0ModGhpcyxvKSxIKHRoaXMpO2xldCBuPXRoaXMuZ2V0KDAsbyksdD1bMCxvXTtmb3IobGV0IGU9MTtlPHRoaXMucm93cztlKyspdGhpcy5nZXQoZSxvKT5uJiYobj10aGlzLmdldChlLG8pLHRbMF09ZSk7cmV0dXJuIHR9bWluQ29sdW1uKG8pe2lmKEModGhpcyxvKSx0aGlzLmlzRW1wdHkoKSlyZXR1cm4gTmFOO2xldCBuPXRoaXMuZ2V0KDAsbyk7Zm9yKGxldCB0PTE7dDx0aGlzLnJvd3M7dCsrKXRoaXMuZ2V0KHQsbyk8biYmKG49dGhpcy5nZXQodCxvKSk7cmV0dXJuIG59bWluQ29sdW1uSW5kZXgobyl7Qyh0aGlzLG8pLEgodGhpcyk7bGV0IG49dGhpcy5nZXQoMCxvKSx0PVswLG9dO2ZvcihsZXQgZT0xO2U8dGhpcy5yb3dzO2UrKyl0aGlzLmdldChlLG8pPG4mJihuPXRoaXMuZ2V0KGUsbyksdFswXT1lKTtyZXR1cm4gdH1kaWFnKCl7bGV0IG89TWF0aC5taW4odGhpcy5yb3dzLHRoaXMuY29sdW1ucyksbj1bXTtmb3IobGV0IHQ9MDt0PG87dCsrKW4ucHVzaCh0aGlzLmdldCh0LHQpKTtyZXR1cm4gbn1ub3JtKG89ImZyb2Jlbml1cyIpe2xldCBuPTA7aWYobz09PSJtYXgiKXJldHVybiB0aGlzLm1heCgpO2lmKG89PT0iZnJvYmVuaXVzIil7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgZT0wO2U8dGhpcy5jb2x1bW5zO2UrKyluPW4rdGhpcy5nZXQodCxlKSp0aGlzLmdldCh0LGUpO3JldHVybiBNYXRoLnNxcnQobil9ZWxzZSB0aHJvdyBuZXcgUmFuZ2VFcnJvcihgdW5rbm93biBub3JtIHR5cGU6ICR7b31gKX1jdW11bGF0aXZlU3VtKCl7bGV0IG89MDtmb3IobGV0IG49MDtuPHRoaXMucm93cztuKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKW8rPXRoaXMuZ2V0KG4sdCksdGhpcy5zZXQobix0LG8pO3JldHVybiB0aGlzfWRvdChvKXtqLmlzTWF0cml4KG8pJiYobz1vLnRvMURBcnJheSgpKTtsZXQgbj10aGlzLnRvMURBcnJheSgpO2lmKG4ubGVuZ3RoIT09by5sZW5ndGgpdGhyb3cgbmV3IFJhbmdlRXJyb3IoInZlY3RvcnMgZG8gbm90IGhhdmUgdGhlIHNhbWUgc2l6ZSIpO2xldCB0PTA7Zm9yKGxldCBlPTA7ZTxuLmxlbmd0aDtlKyspdCs9bltlXSpvW2VdO3JldHVybiB0fW1tdWwobyl7bz1kLmNoZWNrTWF0cml4KG8pO2xldCBuPXRoaXMucm93cyx0PXRoaXMuY29sdW1ucyxlPW8uY29sdW1ucyxzPW5ldyBkKG4sZSksaT1uZXcgRmxvYXQ2NEFycmF5KHQpO2ZvcihsZXQgdT0wO3U8ZTt1Kyspe2ZvcihsZXQgZj0wO2Y8dDtmKyspaVtmXT1vLmdldChmLHUpO2ZvcihsZXQgZj0wO2Y8bjtmKyspe2xldCBhPTA7Zm9yKGxldCBsPTA7bDx0O2wrKylhKz10aGlzLmdldChmLGwpKmlbbF07cy5zZXQoZix1LGEpfX1yZXR1cm4gc31zdHJhc3NlbjJ4MihvKXtvPWQuY2hlY2tNYXRyaXgobyk7bGV0IG49bmV3IGQoMiwyKTtjb25zdCB0PXRoaXMuZ2V0KDAsMCksZT1vLmdldCgwLDApLHM9dGhpcy5nZXQoMCwxKSxpPW8uZ2V0KDAsMSksdT10aGlzLmdldCgxLDApLGY9by5nZXQoMSwwKSxhPXRoaXMuZ2V0KDEsMSksbD1vLmdldCgxLDEpLHA9KHQrYSkqKGUrbCkseT0odSthKSplLFI9dCooaS1sKSxrPWEqKGYtZSksUz0odCtzKSpsLHY9KHUtdCkqKGUraSksaD0ocy1hKSooZitsKSx3PXAray1TK2gsYz1SK1MsZz15K2ssRT1wLXkrUit2O3JldHVybiBuLnNldCgwLDAsdyksbi5zZXQoMCwxLGMpLG4uc2V0KDEsMCxnKSxuLnNldCgxLDEsRSksbn1zdHJhc3NlbjN4MyhvKXtvPWQuY2hlY2tNYXRyaXgobyk7bGV0IG49bmV3IGQoMywzKTtjb25zdCB0PXRoaXMuZ2V0KDAsMCksZT10aGlzLmdldCgwLDEpLHM9dGhpcy5nZXQoMCwyKSxpPXRoaXMuZ2V0KDEsMCksdT10aGlzLmdldCgxLDEpLGY9dGhpcy5nZXQoMSwyKSxhPXRoaXMuZ2V0KDIsMCksbD10aGlzLmdldCgyLDEpLHA9dGhpcy5nZXQoMiwyKSx5PW8uZ2V0KDAsMCksUj1vLmdldCgwLDEpLGs9by5nZXQoMCwyKSxTPW8uZ2V0KDEsMCksdj1vLmdldCgxLDEpLGg9by5nZXQoMSwyKSx3PW8uZ2V0KDIsMCksYz1vLmdldCgyLDEpLGc9by5nZXQoMiwyKSxFPSh0K2Urcy1pLXUtbC1wKSp2LG09KHQtaSkqKC1SK3YpLE09dSooLXkrUitTLXYtaC13K2cpLHE9KC10K2krdSkqKHktUit2KSxJPShpK3UpKigteStSKSxUPXQqeSxGPSgtdCthK2wpKih5LWsraCksUD0oLXQrYSkqKGstaCksRz0oYStsKSooLXkrayksWj0odCtlK3MtdS1mLWEtbCkqaCx4PWwqKC15K2srUy12LWgtdytjKSx6PSgtcytsK3ApKih2K3ctYyksUT0ocy1wKSoodi1jKSxMPXMqdyxKPShsK3ApKigtdytjKSxiPSgtcyt1K2YpKihoK3ctZyksaHQ9KHMtZikqKGgtZyksbHQ9KHUrZikqKC13K2cpLHVuPWUqUyxobj1mKmMsbG49aSprLGZuPWEqUixjbj1wKmcsd249VCtMK3VuLGFuPUUrcStJK1QreitMK0osZ249VCtGK0crWitMK2IrbHQscG49bStNK3ErVCtMK2IraHQsbW49bStxK0krVCtobixkbj1MK2IraHQrbHQrbG4seW49VCtGK1AreCt6K1ErTCx2bj16K1ErTCtKK2ZuLGpuPVQrRitQK0crY247cmV0dXJuIG4uc2V0KDAsMCx3biksbi5zZXQoMCwxLGFuKSxuLnNldCgwLDIsZ24pLG4uc2V0KDEsMCxwbiksbi5zZXQoMSwxLG1uKSxuLnNldCgxLDIsZG4pLG4uc2V0KDIsMCx5biksbi5zZXQoMiwxLHZuKSxuLnNldCgyLDIsam4pLG59bW11bFN0cmFzc2VuKG8pe289ZC5jaGVja01hdHJpeChvKTtsZXQgbj10aGlzLmNsb25lKCksdD1uLnJvd3MsZT1uLmNvbHVtbnMscz1vLnJvd3MsaT1vLmNvbHVtbnM7ZSE9PXMmJmNvbnNvbGUud2FybihgTXVsdGlwbHlpbmcgJHt0fSB4ICR7ZX0gYW5kICR7c30geCAke2l9IG1hdHJpeDogZGltZW5zaW9ucyBkbyBub3QgbWF0Y2guYCk7ZnVuY3Rpb24gdShwLHksUil7bGV0IGs9cC5yb3dzLFM9cC5jb2x1bW5zO2lmKGs9PT15JiZTPT09UilyZXR1cm4gcDt7bGV0IHY9ai56ZXJvcyh5LFIpO3JldHVybiB2PXYuc2V0U3ViTWF0cml4KHAsMCwwKSx2fX1sZXQgZj1NYXRoLm1heCh0LHMpLGE9TWF0aC5tYXgoZSxpKTtuPXUobixmLGEpLG89dShvLGYsYSk7ZnVuY3Rpb24gbChwLHksUixrKXtpZihSPD01MTJ8fGs8PTUxMilyZXR1cm4gcC5tbXVsKHkpO1IlMj09MSYmayUyPT0xPyhwPXUocCxSKzEsaysxKSx5PXUoeSxSKzEsaysxKSk6UiUyPT0xPyhwPXUocCxSKzEsaykseT11KHksUisxLGspKTprJTI9PTEmJihwPXUocCxSLGsrMSkseT11KHksUixrKzEpKTtsZXQgUz1wYXJzZUludChwLnJvd3MvMiwxMCksdj1wYXJzZUludChwLmNvbHVtbnMvMiwxMCksaD1wLnN1Yk1hdHJpeCgwLFMtMSwwLHYtMSksdz15LnN1Yk1hdHJpeCgwLFMtMSwwLHYtMSksYz1wLnN1Yk1hdHJpeCgwLFMtMSx2LHAuY29sdW1ucy0xKSxnPXkuc3ViTWF0cml4KDAsUy0xLHYseS5jb2x1bW5zLTEpLEU9cC5zdWJNYXRyaXgoUyxwLnJvd3MtMSwwLHYtMSksbT15LnN1Yk1hdHJpeChTLHkucm93cy0xLDAsdi0xKSxNPXAuc3ViTWF0cml4KFMscC5yb3dzLTEsdixwLmNvbHVtbnMtMSkscT15LnN1Yk1hdHJpeChTLHkucm93cy0xLHYseS5jb2x1bW5zLTEpLEk9bChqLmFkZChoLE0pLGouYWRkKHcscSksUyx2KSxUPWwoai5hZGQoRSxNKSx3LFMsdiksRj1sKGgsai5zdWIoZyxxKSxTLHYpLFA9bChNLGouc3ViKG0sdyksUyx2KSxHPWwoai5hZGQoaCxjKSxxLFMsdiksWj1sKGouc3ViKEUsaCksai5hZGQodyxnKSxTLHYpLHg9bChqLnN1YihjLE0pLGouYWRkKG0scSksUyx2KSx6PWouYWRkKEksUCk7ei5zdWIoRyksei5hZGQoeCk7bGV0IFE9ai5hZGQoRixHKSxMPWouYWRkKFQsUCksSj1qLnN1YihJLFQpO0ouYWRkKEYpLEouYWRkKFopO2xldCBiPWouemVyb3MoMip6LnJvd3MsMip6LmNvbHVtbnMpO3JldHVybiBiPWIuc2V0U3ViTWF0cml4KHosMCwwKSxiPWIuc2V0U3ViTWF0cml4KFEsei5yb3dzLDApLGI9Yi5zZXRTdWJNYXRyaXgoTCwwLHouY29sdW1ucyksYj1iLnNldFN1Yk1hdHJpeChKLHoucm93cyx6LmNvbHVtbnMpLGIuc3ViTWF0cml4KDAsUi0xLDAsay0xKX1yZXR1cm4gbChuLG8sZixhKX1zY2FsZVJvd3Mobz17fSl7aWYodHlwZW9mIG8hPSJvYmplY3QiKXRocm93IG5ldyBUeXBlRXJyb3IoIm9wdGlvbnMgbXVzdCBiZSBhbiBvYmplY3QiKTtjb25zdHttaW46bj0wLG1heDp0PTF9PW87aWYoIU51bWJlci5pc0Zpbml0ZShuKSl0aHJvdyBuZXcgVHlwZUVycm9yKCJtaW4gbXVzdCBiZSBhIG51bWJlciIpO2lmKCFOdW1iZXIuaXNGaW5pdGUodCkpdGhyb3cgbmV3IFR5cGVFcnJvcigibWF4IG11c3QgYmUgYSBudW1iZXIiKTtpZihuPj10KXRocm93IG5ldyBSYW5nZUVycm9yKCJtaW4gbXVzdCBiZSBzbWFsbGVyIHRoYW4gbWF4Iik7bGV0IGU9bmV3IGQodGhpcy5yb3dzLHRoaXMuY29sdW1ucyk7Zm9yKGxldCBzPTA7czx0aGlzLnJvd3M7cysrKXtjb25zdCBpPXRoaXMuZ2V0Um93KHMpO2kubGVuZ3RoPjAmJmV0KGkse21pbjpuLG1heDp0LG91dHB1dDppfSksZS5zZXRSb3cocyxpKX1yZXR1cm4gZX1zY2FsZUNvbHVtbnMobz17fSl7aWYodHlwZW9mIG8hPSJvYmplY3QiKXRocm93IG5ldyBUeXBlRXJyb3IoIm9wdGlvbnMgbXVzdCBiZSBhbiBvYmplY3QiKTtjb25zdHttaW46bj0wLG1heDp0PTF9PW87aWYoIU51bWJlci5pc0Zpbml0ZShuKSl0aHJvdyBuZXcgVHlwZUVycm9yKCJtaW4gbXVzdCBiZSBhIG51bWJlciIpO2lmKCFOdW1iZXIuaXNGaW5pdGUodCkpdGhyb3cgbmV3IFR5cGVFcnJvcigibWF4IG11c3QgYmUgYSBudW1iZXIiKTtpZihuPj10KXRocm93IG5ldyBSYW5nZUVycm9yKCJtaW4gbXVzdCBiZSBzbWFsbGVyIHRoYW4gbWF4Iik7bGV0IGU9bmV3IGQodGhpcy5yb3dzLHRoaXMuY29sdW1ucyk7Zm9yKGxldCBzPTA7czx0aGlzLmNvbHVtbnM7cysrKXtjb25zdCBpPXRoaXMuZ2V0Q29sdW1uKHMpO2kubGVuZ3RoJiZldChpLHttaW46bixtYXg6dCxvdXRwdXQ6aX0pLGUuc2V0Q29sdW1uKHMsaSl9cmV0dXJuIGV9ZmxpcFJvd3MoKXtjb25zdCBvPU1hdGguY2VpbCh0aGlzLmNvbHVtbnMvMik7Zm9yKGxldCBuPTA7bjx0aGlzLnJvd3M7bisrKWZvcihsZXQgdD0wO3Q8bzt0Kyspe2xldCBlPXRoaXMuZ2V0KG4sdCkscz10aGlzLmdldChuLHRoaXMuY29sdW1ucy0xLXQpO3RoaXMuc2V0KG4sdCxzKSx0aGlzLnNldChuLHRoaXMuY29sdW1ucy0xLXQsZSl9cmV0dXJuIHRoaXN9ZmxpcENvbHVtbnMoKXtjb25zdCBvPU1hdGguY2VpbCh0aGlzLnJvd3MvMik7Zm9yKGxldCBuPTA7bjx0aGlzLmNvbHVtbnM7bisrKWZvcihsZXQgdD0wO3Q8bzt0Kyspe2xldCBlPXRoaXMuZ2V0KHQsbikscz10aGlzLmdldCh0aGlzLnJvd3MtMS10LG4pO3RoaXMuc2V0KHQsbixzKSx0aGlzLnNldCh0aGlzLnJvd3MtMS10LG4sZSl9cmV0dXJuIHRoaXN9a3JvbmVja2VyUHJvZHVjdChvKXtvPWQuY2hlY2tNYXRyaXgobyk7bGV0IG49dGhpcy5yb3dzLHQ9dGhpcy5jb2x1bW5zLGU9by5yb3dzLHM9by5jb2x1bW5zLGk9bmV3IGQobiplLHQqcyk7Zm9yKGxldCB1PTA7dTxuO3UrKylmb3IobGV0IGY9MDtmPHQ7ZisrKWZvcihsZXQgYT0wO2E8ZTthKyspZm9yKGxldCBsPTA7bDxzO2wrKylpLnNldChlKnUrYSxzKmYrbCx0aGlzLmdldCh1LGYpKm8uZ2V0KGEsbCkpO3JldHVybiBpfWtyb25lY2tlclN1bShvKXtpZihvPWQuY2hlY2tNYXRyaXgobyksIXRoaXMuaXNTcXVhcmUoKXx8IW8uaXNTcXVhcmUoKSl0aHJvdyBuZXcgRXJyb3IoIktyb25lY2tlciBTdW0gbmVlZHMgdHdvIFNxdWFyZSBNYXRyaWNlcyIpO2xldCBuPXRoaXMucm93cyx0PW8ucm93cyxlPXRoaXMua3JvbmVja2VyUHJvZHVjdChkLmV5ZSh0LHQpKSxzPWQuZXllKG4sbikua3JvbmVja2VyUHJvZHVjdChvKTtyZXR1cm4gZS5hZGQocyl9dHJhbnNwb3NlKCl7bGV0IG89bmV3IGQodGhpcy5jb2x1bW5zLHRoaXMucm93cyk7Zm9yKGxldCBuPTA7bjx0aGlzLnJvd3M7bisrKWZvcihsZXQgdD0wO3Q8dGhpcy5jb2x1bW5zO3QrKylvLnNldCh0LG4sdGhpcy5nZXQobix0KSk7cmV0dXJuIG99c29ydFJvd3Mobz1zdCl7Zm9yKGxldCBuPTA7bjx0aGlzLnJvd3M7bisrKXRoaXMuc2V0Um93KG4sdGhpcy5nZXRSb3cobikuc29ydChvKSk7cmV0dXJuIHRoaXN9c29ydENvbHVtbnMobz1zdCl7Zm9yKGxldCBuPTA7bjx0aGlzLmNvbHVtbnM7bisrKXRoaXMuc2V0Q29sdW1uKG4sdGhpcy5nZXRDb2x1bW4obikuc29ydChvKSk7cmV0dXJuIHRoaXN9c3ViTWF0cml4KG8sbix0LGUpe3J0KHRoaXMsbyxuLHQsZSk7bGV0IHM9bmV3IGQobi1vKzEsZS10KzEpO2ZvcihsZXQgaT1vO2k8PW47aSsrKWZvcihsZXQgdT10O3U8PWU7dSsrKXMuc2V0KGktbyx1LXQsdGhpcy5nZXQoaSx1KSk7cmV0dXJuIHN9c3ViTWF0cml4Um93KG8sbix0KXtpZihuPT09dm9pZCAwJiYobj0wKSx0PT09dm9pZCAwJiYodD10aGlzLmNvbHVtbnMtMSksbj50fHxuPDB8fG4+PXRoaXMuY29sdW1uc3x8dDwwfHx0Pj10aGlzLmNvbHVtbnMpdGhyb3cgbmV3IFJhbmdlRXJyb3IoIkFyZ3VtZW50IG91dCBvZiByYW5nZSIpO2xldCBlPW5ldyBkKG8ubGVuZ3RoLHQtbisxKTtmb3IobGV0IHM9MDtzPG8ubGVuZ3RoO3MrKylmb3IobGV0IGk9bjtpPD10O2krKyl7aWYob1tzXTwwfHxvW3NdPj10aGlzLnJvd3MpdGhyb3cgbmV3IFJhbmdlRXJyb3IoYFJvdyBpbmRleCBvdXQgb2YgcmFuZ2U6ICR7b1tzXX1gKTtlLnNldChzLGktbix0aGlzLmdldChvW3NdLGkpKX1yZXR1cm4gZX1zdWJNYXRyaXhDb2x1bW4obyxuLHQpe2lmKG49PT12b2lkIDAmJihuPTApLHQ9PT12b2lkIDAmJih0PXRoaXMucm93cy0xKSxuPnR8fG48MHx8bj49dGhpcy5yb3dzfHx0PDB8fHQ+PXRoaXMucm93cyl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiQXJndW1lbnQgb3V0IG9mIHJhbmdlIik7bGV0IGU9bmV3IGQodC1uKzEsby5sZW5ndGgpO2ZvcihsZXQgcz0wO3M8by5sZW5ndGg7cysrKWZvcihsZXQgaT1uO2k8PXQ7aSsrKXtpZihvW3NdPDB8fG9bc10+PXRoaXMuY29sdW1ucyl0aHJvdyBuZXcgUmFuZ2VFcnJvcihgQ29sdW1uIGluZGV4IG91dCBvZiByYW5nZTogJHtvW3NdfWApO2Uuc2V0KGktbixzLHRoaXMuZ2V0KGksb1tzXSkpfXJldHVybiBlfXNldFN1Yk1hdHJpeChvLG4sdCl7aWYobz1kLmNoZWNrTWF0cml4KG8pLG8uaXNFbXB0eSgpKXJldHVybiB0aGlzO2xldCBlPW4rby5yb3dzLTEscz10K28uY29sdW1ucy0xO3J0KHRoaXMsbixlLHQscyk7Zm9yKGxldCBpPTA7aTxvLnJvd3M7aSsrKWZvcihsZXQgdT0wO3U8by5jb2x1bW5zO3UrKyl0aGlzLnNldChuK2ksdCt1LG8uZ2V0KGksdSkpO3JldHVybiB0aGlzfXNlbGVjdGlvbihvLG4pe2xldCB0PWZlKHRoaXMsbyxuKSxlPW5ldyBkKG8ubGVuZ3RoLG4ubGVuZ3RoKTtmb3IobGV0IHM9MDtzPHQucm93Lmxlbmd0aDtzKyspe2xldCBpPXQucm93W3NdO2ZvcihsZXQgdT0wO3U8dC5jb2x1bW4ubGVuZ3RoO3UrKyl7bGV0IGY9dC5jb2x1bW5bdV07ZS5zZXQocyx1LHRoaXMuZ2V0KGksZikpfX1yZXR1cm4gZX10cmFjZSgpe2xldCBvPU1hdGgubWluKHRoaXMucm93cyx0aGlzLmNvbHVtbnMpLG49MDtmb3IobGV0IHQ9MDt0PG87dCsrKW4rPXRoaXMuZ2V0KHQsdCk7cmV0dXJuIG59Y2xvbmUoKXtsZXQgbz1uZXcgZCh0aGlzLnJvd3MsdGhpcy5jb2x1bW5zKTtmb3IobGV0IG49MDtuPHRoaXMucm93cztuKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKW8uc2V0KG4sdCx0aGlzLmdldChuLHQpKTtyZXR1cm4gb31zdW0obyl7c3dpdGNoKG8pe2Nhc2Uicm93IjpyZXR1cm4gYWUodGhpcyk7Y2FzZSJjb2x1bW4iOnJldHVybiBnZSh0aGlzKTtjYXNlIHZvaWQgMDpyZXR1cm4gcGUodGhpcyk7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoYGludmFsaWQgb3B0aW9uOiAke299YCl9fXByb2R1Y3Qobyl7c3dpdGNoKG8pe2Nhc2Uicm93IjpyZXR1cm4gbWUodGhpcyk7Y2FzZSJjb2x1bW4iOnJldHVybiBkZSh0aGlzKTtjYXNlIHZvaWQgMDpyZXR1cm4geWUodGhpcyk7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoYGludmFsaWQgb3B0aW9uOiAke299YCl9fW1lYW4obyl7Y29uc3Qgbj10aGlzLnN1bShvKTtzd2l0Y2gobyl7Y2FzZSJyb3ciOntmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0Kyspblt0XS89dGhpcy5jb2x1bW5zO3JldHVybiBufWNhc2UiY29sdW1uIjp7Zm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKW5bdF0vPXRoaXMucm93cztyZXR1cm4gbn1jYXNlIHZvaWQgMDpyZXR1cm4gbi90aGlzLnNpemU7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoYGludmFsaWQgb3B0aW9uOiAke299YCl9fXZhcmlhbmNlKG8sbj17fSl7aWYodHlwZW9mIG89PSJvYmplY3QiJiYobj1vLG89dm9pZCAwKSx0eXBlb2YgbiE9Im9iamVjdCIpdGhyb3cgbmV3IFR5cGVFcnJvcigib3B0aW9ucyBtdXN0IGJlIGFuIG9iamVjdCIpO2NvbnN0e3VuYmlhc2VkOnQ9ITAsbWVhbjplPXRoaXMubWVhbihvKX09bjtpZih0eXBlb2YgdCE9ImJvb2xlYW4iKXRocm93IG5ldyBUeXBlRXJyb3IoInVuYmlhc2VkIG11c3QgYmUgYSBib29sZWFuIik7c3dpdGNoKG8pe2Nhc2Uicm93Ijp7aWYoIUFycmF5LmlzQXJyYXkoZSkpdGhyb3cgbmV3IFR5cGVFcnJvcigibWVhbiBtdXN0IGJlIGFuIGFycmF5Iik7cmV0dXJuIHZlKHRoaXMsdCxlKX1jYXNlImNvbHVtbiI6e2lmKCFBcnJheS5pc0FycmF5KGUpKXRocm93IG5ldyBUeXBlRXJyb3IoIm1lYW4gbXVzdCBiZSBhbiBhcnJheSIpO3JldHVybiBqZSh0aGlzLHQsZSl9Y2FzZSB2b2lkIDA6e2lmKHR5cGVvZiBlIT0ibnVtYmVyIil0aHJvdyBuZXcgVHlwZUVycm9yKCJtZWFuIG11c3QgYmUgYSBudW1iZXIiKTtyZXR1cm4gU2UodGhpcyx0LGUpfWRlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKGBpbnZhbGlkIG9wdGlvbjogJHtvfWApfX1zdGFuZGFyZERldmlhdGlvbihvLG4pe3R5cGVvZiBvPT0ib2JqZWN0IiYmKG49byxvPXZvaWQgMCk7Y29uc3QgdD10aGlzLnZhcmlhbmNlKG8sbik7aWYobz09PXZvaWQgMClyZXR1cm4gTWF0aC5zcXJ0KHQpO2ZvcihsZXQgZT0wO2U8dC5sZW5ndGg7ZSsrKXRbZV09TWF0aC5zcXJ0KHRbZV0pO3JldHVybiB0fWNlbnRlcihvLG49e30pe2lmKHR5cGVvZiBvPT0ib2JqZWN0IiYmKG49byxvPXZvaWQgMCksdHlwZW9mIG4hPSJvYmplY3QiKXRocm93IG5ldyBUeXBlRXJyb3IoIm9wdGlvbnMgbXVzdCBiZSBhbiBvYmplY3QiKTtjb25zdHtjZW50ZXI6dD10aGlzLm1lYW4obyl9PW47c3dpdGNoKG8pe2Nhc2Uicm93Ijp7aWYoIUFycmF5LmlzQXJyYXkodCkpdGhyb3cgbmV3IFR5cGVFcnJvcigiY2VudGVyIG11c3QgYmUgYW4gYXJyYXkiKTtyZXR1cm4gRWUodGhpcyx0KSx0aGlzfWNhc2UiY29sdW1uIjp7aWYoIUFycmF5LmlzQXJyYXkodCkpdGhyb3cgbmV3IFR5cGVFcnJvcigiY2VudGVyIG11c3QgYmUgYW4gYXJyYXkiKTtyZXR1cm4gTWUodGhpcyx0KSx0aGlzfWNhc2Ugdm9pZCAwOntpZih0eXBlb2YgdCE9Im51bWJlciIpdGhyb3cgbmV3IFR5cGVFcnJvcigiY2VudGVyIG11c3QgYmUgYSBudW1iZXIiKTtyZXR1cm4ga2UodGhpcyx0KSx0aGlzfWRlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKGBpbnZhbGlkIG9wdGlvbjogJHtvfWApfX1zY2FsZShvLG49e30pe2lmKHR5cGVvZiBvPT0ib2JqZWN0IiYmKG49byxvPXZvaWQgMCksdHlwZW9mIG4hPSJvYmplY3QiKXRocm93IG5ldyBUeXBlRXJyb3IoIm9wdGlvbnMgbXVzdCBiZSBhbiBvYmplY3QiKTtsZXQgdD1uLnNjYWxlO3N3aXRjaChvKXtjYXNlInJvdyI6e2lmKHQ9PT12b2lkIDApdD1SZSh0aGlzKTtlbHNlIGlmKCFBcnJheS5pc0FycmF5KHQpKXRocm93IG5ldyBUeXBlRXJyb3IoInNjYWxlIG11c3QgYmUgYW4gYXJyYXkiKTtyZXR1cm4gcWUodGhpcyx0KSx0aGlzfWNhc2UiY29sdW1uIjp7aWYodD09PXZvaWQgMCl0PVRlKHRoaXMpO2Vsc2UgaWYoIUFycmF5LmlzQXJyYXkodCkpdGhyb3cgbmV3IFR5cGVFcnJvcigic2NhbGUgbXVzdCBiZSBhbiBhcnJheSIpO3JldHVybiBJZSh0aGlzLHQpLHRoaXN9Y2FzZSB2b2lkIDA6e2lmKHQ9PT12b2lkIDApdD0kZSh0aGlzKTtlbHNlIGlmKHR5cGVvZiB0IT0ibnVtYmVyIil0aHJvdyBuZXcgVHlwZUVycm9yKCJzY2FsZSBtdXN0IGJlIGEgbnVtYmVyIik7cmV0dXJuIHplKHRoaXMsdCksdGhpc31kZWZhdWx0OnRocm93IG5ldyBFcnJvcihgaW52YWxpZCBvcHRpb246ICR7b31gKX19dG9TdHJpbmcobyl7cmV0dXJuIG90KHRoaXMsbyl9fWoucHJvdG90eXBlLmtsYXNzPSJNYXRyaXgiLHR5cGVvZiBTeW1ib2whPSJ1bmRlZmluZWQiJiYoai5wcm90b3R5cGVbU3ltYm9sLmZvcigibm9kZWpzLnV0aWwuaW5zcGVjdC5jdXN0b20iKV09aWUpO2Z1bmN0aW9uIHN0KHIsbyl7cmV0dXJuIHItb31qLnJhbmRvbT1qLnJhbmQsai5yYW5kb21JbnQ9ai5yYW5kSW50LGouZGlhZ29uYWw9ai5kaWFnLGoucHJvdG90eXBlLmRpYWdvbmFsPWoucHJvdG90eXBlLmRpYWcsai5pZGVudGl0eT1qLmV5ZSxqLnByb3RvdHlwZS5uZWdhdGU9ai5wcm90b3R5cGUubmVnLGoucHJvdG90eXBlLnRlbnNvclByb2R1Y3Q9ai5wcm90b3R5cGUua3JvbmVja2VyUHJvZHVjdDtjbGFzcyBkIGV4dGVuZHMgantjb25zdHJ1Y3RvcihvLG4pe3N1cGVyKCk7aWYoZC5pc01hdHJpeChvKSlyZXR1cm4gby5jbG9uZSgpO2lmKE51bWJlci5pc0ludGVnZXIobykmJm8+PTApaWYodGhpcy5kYXRhPVtdLE51bWJlci5pc0ludGVnZXIobikmJm4+PTApZm9yKGxldCB0PTA7dDxvO3QrKyl0aGlzLmRhdGEucHVzaChuZXcgRmxvYXQ2NEFycmF5KG4pKTtlbHNlIHRocm93IG5ldyBUeXBlRXJyb3IoIm5Db2x1bW5zIG11c3QgYmUgYSBwb3NpdGl2ZSBpbnRlZ2VyIik7ZWxzZSBpZihBcnJheS5pc0FycmF5KG8pKXtjb25zdCB0PW87aWYobz10Lmxlbmd0aCxuPW8/dFswXS5sZW5ndGg6MCx0eXBlb2YgbiE9Im51bWJlciIpdGhyb3cgbmV3IFR5cGVFcnJvcigiRGF0YSBtdXN0IGJlIGEgMkQgYXJyYXkgd2l0aCBhdCBsZWFzdCBvbmUgZWxlbWVudCIpO3RoaXMuZGF0YT1bXTtmb3IobGV0IGU9MDtlPG87ZSsrKXtpZih0W2VdLmxlbmd0aCE9PW4pdGhyb3cgbmV3IFJhbmdlRXJyb3IoIkluY29uc2lzdGVudCBhcnJheSBkaW1lbnNpb25zIik7dGhpcy5kYXRhLnB1c2goRmxvYXQ2NEFycmF5LmZyb20odFtlXSkpfX1lbHNlIHRocm93IG5ldyBUeXBlRXJyb3IoIkZpcnN0IGFyZ3VtZW50IG11c3QgYmUgYSBwb3NpdGl2ZSBudW1iZXIgb3IgYW4gYXJyYXkiKTt0aGlzLnJvd3M9byx0aGlzLmNvbHVtbnM9bn1zZXQobyxuLHQpe3JldHVybiB0aGlzLmRhdGFbb11bbl09dCx0aGlzfWdldChvLG4pe3JldHVybiB0aGlzLmRhdGFbb11bbl19cmVtb3ZlUm93KG8pe3JldHVybiBWKHRoaXMsbyksdGhpcy5kYXRhLnNwbGljZShvLDEpLHRoaXMucm93cy09MSx0aGlzfWFkZFJvdyhvLG4pe3JldHVybiBuPT09dm9pZCAwJiYobj1vLG89dGhpcy5yb3dzKSxWKHRoaXMsbywhMCksbj1GbG9hdDY0QXJyYXkuZnJvbShCKHRoaXMsbikpLHRoaXMuZGF0YS5zcGxpY2UobywwLG4pLHRoaXMucm93cys9MSx0aGlzfXJlbW92ZUNvbHVtbihvKXtDKHRoaXMsbyk7Zm9yKGxldCBuPTA7bjx0aGlzLnJvd3M7bisrKXtjb25zdCB0PW5ldyBGbG9hdDY0QXJyYXkodGhpcy5jb2x1bW5zLTEpO2ZvcihsZXQgZT0wO2U8bztlKyspdFtlXT10aGlzLmRhdGFbbl1bZV07Zm9yKGxldCBlPW8rMTtlPHRoaXMuY29sdW1ucztlKyspdFtlLTFdPXRoaXMuZGF0YVtuXVtlXTt0aGlzLmRhdGFbbl09dH1yZXR1cm4gdGhpcy5jb2x1bW5zLT0xLHRoaXN9YWRkQ29sdW1uKG8sbil7dHlwZW9mIG49PSJ1bmRlZmluZWQiJiYobj1vLG89dGhpcy5jb2x1bW5zKSxDKHRoaXMsbywhMCksbj1PKHRoaXMsbik7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKXtjb25zdCBlPW5ldyBGbG9hdDY0QXJyYXkodGhpcy5jb2x1bW5zKzEpO2xldCBzPTA7Zm9yKDtzPG87cysrKWVbc109dGhpcy5kYXRhW3RdW3NdO2ZvcihlW3MrK109blt0XTtzPHRoaXMuY29sdW1ucysxO3MrKyllW3NdPXRoaXMuZGF0YVt0XVtzLTFdO3RoaXMuZGF0YVt0XT1lfXJldHVybiB0aGlzLmNvbHVtbnMrPTEsdGhpc319bGUoaixkKTtmdW5jdGlvbiBiZShyLG89cixuPXt9KXtyPW5ldyBkKHIpO2xldCB0PSExO2lmKHR5cGVvZiBvPT0ib2JqZWN0IiYmIWQuaXNNYXRyaXgobykmJiFBcnJheS5pc0FycmF5KG8pPyhuPW8sbz1yLHQ9ITApOm89bmV3IGQobyksci5yb3dzIT09by5yb3dzKXRocm93IG5ldyBUeXBlRXJyb3IoIkJvdGggbWF0cmljZXMgbXVzdCBoYXZlIHRoZSBzYW1lIG51bWJlciBvZiByb3dzIik7Y29uc3R7Y2VudGVyOmU9ITAsc2NhbGU6cz0hMH09bjtlJiYoci5jZW50ZXIoImNvbHVtbiIpLHR8fG8uY2VudGVyKCJjb2x1bW4iKSkscyYmKHIuc2NhbGUoImNvbHVtbiIpLHR8fG8uc2NhbGUoImNvbHVtbiIpKTtjb25zdCBpPXIuc3RhbmRhcmREZXZpYXRpb24oImNvbHVtbiIse3VuYmlhc2VkOiEwfSksdT10P2k6by5zdGFuZGFyZERldmlhdGlvbigiY29sdW1uIix7dW5iaWFzZWQ6ITB9KSxmPXIudHJhbnNwb3NlKCkubW11bChvKTtmb3IobGV0IGE9MDthPGYucm93czthKyspZm9yKGxldCBsPTA7bDxmLmNvbHVtbnM7bCsrKWYuc2V0KGEsbCxmLmdldChhLGwpKigxLyhpW2FdKnVbbF0pKSooMS8oci5yb3dzLTEpKSk7cmV0dXJuIGZ9dmFyIGl0PXtleHBvcnRzOnt9fTsoZnVuY3Rpb24ocixvKXsoZnVuY3Rpb24oKXt2YXIgbix0LGUscyxpLHUsZixhLGwscCx5LFIsayxTLHY7ZT1NYXRoLmZsb29yLHA9TWF0aC5taW4sdD1mdW5jdGlvbihoLHcpe3JldHVybiBoPHc/LTE6aD53PzE6MH0sbD1mdW5jdGlvbihoLHcsYyxnLEUpe3ZhciBtO2lmKGM9PW51bGwmJihjPTApLEU9PW51bGwmJihFPXQpLGM8MCl0aHJvdyBuZXcgRXJyb3IoImxvIG11c3QgYmUgbm9uLW5lZ2F0aXZlIik7Zm9yKGc9PW51bGwmJihnPWgubGVuZ3RoKTtjPGc7KW09ZSgoYytnKS8yKSxFKHcsaFttXSk8MD9nPW06Yz1tKzE7cmV0dXJuW10uc3BsaWNlLmFwcGx5KGgsW2MsYy1jXS5jb25jYXQodykpLHd9LHU9ZnVuY3Rpb24oaCx3LGMpe3JldHVybiBjPT1udWxsJiYoYz10KSxoLnB1c2godyksUyhoLDAsaC5sZW5ndGgtMSxjKX0saT1mdW5jdGlvbihoLHcpe3ZhciBjLGc7cmV0dXJuIHc9PW51bGwmJih3PXQpLGM9aC5wb3AoKSxoLmxlbmd0aD8oZz1oWzBdLGhbMF09Yyx2KGgsMCx3KSk6Zz1jLGd9LGE9ZnVuY3Rpb24oaCx3LGMpe3ZhciBnO3JldHVybiBjPT1udWxsJiYoYz10KSxnPWhbMF0saFswXT13LHYoaCwwLGMpLGd9LGY9ZnVuY3Rpb24oaCx3LGMpe3ZhciBnO3JldHVybiBjPT1udWxsJiYoYz10KSxoLmxlbmd0aCYmYyhoWzBdLHcpPDAmJihnPVtoWzBdLHddLHc9Z1swXSxoWzBdPWdbMV0sdihoLDAsYykpLHd9LHM9ZnVuY3Rpb24oaCx3KXt2YXIgYyxnLEUsbSxNLHE7Zm9yKHc9PW51bGwmJih3PXQpLG09ZnVuY3Rpb24oKXtxPVtdO2Zvcih2YXIgST0wLFQ9ZShoLmxlbmd0aC8yKTswPD1UP0k8VDpJPlQ7MDw9VD9JKys6SS0tKXEucHVzaChJKTtyZXR1cm4gcX0uYXBwbHkodGhpcykucmV2ZXJzZSgpLE09W10sZz0wLEU9bS5sZW5ndGg7ZzxFO2crKyljPW1bZ10sTS5wdXNoKHYoaCxjLHcpKTtyZXR1cm4gTX0saz1mdW5jdGlvbihoLHcsYyl7dmFyIGc7aWYoYz09bnVsbCYmKGM9dCksZz1oLmluZGV4T2YodyksZyE9PS0xKXJldHVybiBTKGgsMCxnLGMpLHYoaCxnLGMpfSx5PWZ1bmN0aW9uKGgsdyxjKXt2YXIgZyxFLG0sTSxxO2lmKGM9PW51bGwmJihjPXQpLEU9aC5zbGljZSgwLHcpLCFFLmxlbmd0aClyZXR1cm4gRTtmb3IocyhFLGMpLHE9aC5zbGljZSh3KSxtPTAsTT1xLmxlbmd0aDttPE07bSsrKWc9cVttXSxmKEUsZyxjKTtyZXR1cm4gRS5zb3J0KGMpLnJldmVyc2UoKX0sUj1mdW5jdGlvbihoLHcsYyl7dmFyIGcsRSxtLE0scSxJLFQsRixQO2lmKGM9PW51bGwmJihjPXQpLHcqMTA8PWgubGVuZ3RoKXtpZihtPWguc2xpY2UoMCx3KS5zb3J0KGMpLCFtLmxlbmd0aClyZXR1cm4gbTtmb3IoRT1tW20ubGVuZ3RoLTFdLFQ9aC5zbGljZSh3KSxNPTAsST1ULmxlbmd0aDtNPEk7TSsrKWc9VFtNXSxjKGcsRSk8MCYmKGwobSxnLDAsbnVsbCxjKSxtLnBvcCgpLEU9bVttLmxlbmd0aC0xXSk7cmV0dXJuIG19Zm9yKHMoaCxjKSxQPVtdLHE9MCxGPXAodyxoLmxlbmd0aCk7MDw9Rj9xPEY6cT5GOzA8PUY/KytxOi0tcSlQLnB1c2goaShoLGMpKTtyZXR1cm4gUH0sUz1mdW5jdGlvbihoLHcsYyxnKXt2YXIgRSxtLE07Zm9yKGc9PW51bGwmJihnPXQpLEU9aFtjXTtjPnc7KXtpZihNPWMtMT4+MSxtPWhbTV0sZyhFLG0pPDApe2hbY109bSxjPU07Y29udGludWV9YnJlYWt9cmV0dXJuIGhbY109RX0sdj1mdW5jdGlvbihoLHcsYyl7dmFyIGcsRSxtLE0scTtmb3IoYz09bnVsbCYmKGM9dCksRT1oLmxlbmd0aCxxPXcsbT1oW3ddLGc9Mip3KzE7ZzxFOylNPWcrMSxNPEUmJiEoYyhoW2ddLGhbTV0pPDApJiYoZz1NKSxoW3ddPWhbZ10sdz1nLGc9Mip3KzE7cmV0dXJuIGhbd109bSxTKGgscSx3LGMpfSxuPWZ1bmN0aW9uKCl7aC5wdXNoPXUsaC5wb3A9aSxoLnJlcGxhY2U9YSxoLnB1c2hwb3A9ZixoLmhlYXBpZnk9cyxoLnVwZGF0ZUl0ZW09ayxoLm5sYXJnZXN0PXksaC5uc21hbGxlc3Q9UjtmdW5jdGlvbiBoKHcpe3RoaXMuY21wPXchPW51bGw/dzp0LHRoaXMubm9kZXM9W119cmV0dXJuIGgucHJvdG90eXBlLnB1c2g9ZnVuY3Rpb24odyl7cmV0dXJuIHUodGhpcy5ub2Rlcyx3LHRoaXMuY21wKX0saC5wcm90b3R5cGUucG9wPWZ1bmN0aW9uKCl7cmV0dXJuIGkodGhpcy5ub2Rlcyx0aGlzLmNtcCl9LGgucHJvdG90eXBlLnBlZWs9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ub2Rlc1swXX0saC5wcm90b3R5cGUuY29udGFpbnM9ZnVuY3Rpb24odyl7cmV0dXJuIHRoaXMubm9kZXMuaW5kZXhPZih3KSE9PS0xfSxoLnByb3RvdHlwZS5yZXBsYWNlPWZ1bmN0aW9uKHcpe3JldHVybiBhKHRoaXMubm9kZXMsdyx0aGlzLmNtcCl9LGgucHJvdG90eXBlLnB1c2hwb3A9ZnVuY3Rpb24odyl7cmV0dXJuIGYodGhpcy5ub2Rlcyx3LHRoaXMuY21wKX0saC5wcm90b3R5cGUuaGVhcGlmeT1mdW5jdGlvbigpe3JldHVybiBzKHRoaXMubm9kZXMsdGhpcy5jbXApfSxoLnByb3RvdHlwZS51cGRhdGVJdGVtPWZ1bmN0aW9uKHcpe3JldHVybiBrKHRoaXMubm9kZXMsdyx0aGlzLmNtcCl9LGgucHJvdG90eXBlLmNsZWFyPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubm9kZXM9W119LGgucHJvdG90eXBlLmVtcHR5PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubm9kZXMubGVuZ3RoPT09MH0saC5wcm90b3R5cGUuc2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLm5vZGVzLmxlbmd0aH0saC5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oKXt2YXIgdztyZXR1cm4gdz1uZXcgaCx3Lm5vZGVzPXRoaXMubm9kZXMuc2xpY2UoMCksd30saC5wcm90b3R5cGUudG9BcnJheT1mdW5jdGlvbigpe3JldHVybiB0aGlzLm5vZGVzLnNsaWNlKDApfSxoLnByb3RvdHlwZS5pbnNlcnQ9aC5wcm90b3R5cGUucHVzaCxoLnByb3RvdHlwZS50b3A9aC5wcm90b3R5cGUucGVlayxoLnByb3RvdHlwZS5mcm9udD1oLnByb3RvdHlwZS5wZWVrLGgucHJvdG90eXBlLmhhcz1oLnByb3RvdHlwZS5jb250YWlucyxoLnByb3RvdHlwZS5jb3B5PWgucHJvdG90eXBlLmNsb25lLGh9KCksZnVuY3Rpb24oaCx3KXtyZXR1cm4gci5leHBvcnRzPXcoKX0odGhpcyxmdW5jdGlvbigpe3JldHVybiBufSl9KS5jYWxsKGVlKX0pKGl0KTt2YXIgTmU9aXQuZXhwb3J0cyxGZT1OZTtjbGFzcyBfe2NvbnN0cnVjdG9yKCl7dGhpcy5jaGlsZHJlbj1bXSx0aGlzLmhlaWdodD0wLHRoaXMuc2l6ZT0xLHRoaXMuaW5kZXg9LTEsdGhpcy5pc0xlYWY9ITF9Y3V0KG8pe2lmKHR5cGVvZiBvIT0ibnVtYmVyIil0aHJvdyBuZXcgVHlwZUVycm9yKCJ0aHJlc2hvbGQgbXVzdCBiZSBhIG51bWJlciIpO2lmKG88MCl0aHJvdyBuZXcgUmFuZ2VFcnJvcigidGhyZXNob2xkIG11c3QgYmUgYSBwb3NpdGl2ZSBudW1iZXIiKTtsZXQgbj1bdGhpc107Y29uc3QgdD1bXTtmb3IoO24ubGVuZ3RoPjA7KXtjb25zdCBlPW4uc2hpZnQoKTtvPj1lLmhlaWdodD90LnB1c2goZSk6bj1uLmNvbmNhdChlLmNoaWxkcmVuKX1yZXR1cm4gdH1ncm91cChvKXtpZighTnVtYmVyLmlzSW50ZWdlcihvKXx8bzwxKXRocm93IG5ldyBSYW5nZUVycm9yKCJncm91cHMgbXVzdCBiZSBhIHBvc2l0aXZlIGludGVnZXIiKTtjb25zdCBuPW5ldyBGZSgoZSxzKT0+cy5oZWlnaHQtZS5oZWlnaHQpO2ZvcihuLnB1c2godGhpcyk7bi5zaXplKCk8bzspe2NvbnN0IGU9bi5wb3AoKTtpZihlLmNoaWxkcmVuLmxlbmd0aD09PTApYnJlYWs7ZS5jaGlsZHJlbi5mb3JFYWNoKHM9Pm4ucHVzaChzKSl9Y29uc3QgdD1uZXcgXztyZXR1cm4gdC5jaGlsZHJlbj1uLnRvQXJyYXkoKSx0LmhlaWdodD10aGlzLmhlaWdodCx0fXRyYXZlcnNlKG8pe2Z1bmN0aW9uIG4odCxlKXtpZihlKHQpLHQuY2hpbGRyZW4pZm9yKGNvbnN0IHMgb2YgdC5jaGlsZHJlbiluKHMsZSl9bih0aGlzLG8pfWluZGljZXMoKXtjb25zdCBvPVtdO3JldHVybiB0aGlzLnRyYXZlcnNlKG49PntuLmlzTGVhZiYmby5wdXNoKG4uaW5kZXgpfSksb319ZnVuY3Rpb24gVmUocixvKXtyZXR1cm4gTWF0aC5taW4ocixvKX1mdW5jdGlvbiBDZShyLG8pe3JldHVybiBNYXRoLm1heChyLG8pfWZ1bmN0aW9uIERlKHIsbyxuLHQsZSl7Y29uc3Qgcz10Lyh0K2UpLGk9ZS8odCtlKTtyZXR1cm4gcypyK2kqb31mdW5jdGlvbiBQZShyLG8pe3JldHVybihyK28pLzJ9ZnVuY3Rpb24gTGUocixvLG4sdCxlKXtjb25zdCBzPXQvKHQrZSksaT1lLyh0K2UpLHU9LSh0KmUpLyh0K2UpKioyO3JldHVybiBzKnIraSpvK3Uqbn1mdW5jdGlvbiBCZShyLG8sbil7cmV0dXJuIHIvMitvLzItbi80fWZ1bmN0aW9uIE9lKHIsbyxuLHQsZSxzKXtjb25zdCBpPSh0K3MpLyh0K2UrcyksdT0oZStzKS8odCtlK3MpLGY9LXMvKHQrZStzKTtyZXR1cm4gaSpyK3UqbytmKm59ZnVuY3Rpb24gSGUocixvLG4sdCxlLHMpe2NvbnN0IGk9KHQrcykvKHQrZStzKSx1PShlK3MpLyh0K2UrcyksZj0tcy8odCtlK3MpO3JldHVybiBNYXRoLnNxcnQoaSpyKnIrdSpvKm8rZipuKm4pfWZ1bmN0aW9uIEplKHIsbz17fSl7Y29uc3R7ZGlzdGFuY2VGdW5jdGlvbjpuPSQsbWV0aG9kOnQ9ImNvbXBsZXRlIixpc0Rpc3RhbmNlTWF0cml4OmU9ITF9PW87bGV0IHM7ZXx8KHI9dHQocixuKSk7bGV0IGk9bmV3IGQocik7Y29uc3QgdT1pLnJvd3M7aWYodHlwZW9mIHQ9PSJzdHJpbmciKXN3aXRjaCh0LnRvTG93ZXJDYXNlKCkpe2Nhc2Uic2luZ2xlIjpzPVZlO2JyZWFrO2Nhc2UiY29tcGxldGUiOnM9Q2U7YnJlYWs7Y2FzZSJhdmVyYWdlIjpjYXNlInVwZ21hIjpzPURlO2JyZWFrO2Nhc2Uid3BnbWEiOnM9UGU7YnJlYWs7Y2FzZSJjZW50cm9pZCI6Y2FzZSJ1cGdtYyI6cz1MZTticmVhaztjYXNlIm1lZGlhbiI6Y2FzZSJ3cGdtYyI6cz1CZTticmVhaztjYXNlIndhcmQiOnM9T2U7YnJlYWs7Y2FzZSJ3YXJkMiI6cz1IZTticmVhaztkZWZhdWx0OnRocm93IG5ldyBSYW5nZUVycm9yKGB1bmtub3duIGNsdXN0ZXJpbmcgbWV0aG9kOiAke3R9YCl9ZWxzZSBpZih0eXBlb2YgdCE9ImZ1bmN0aW9uIil0aHJvdyBuZXcgVHlwZUVycm9yKCJtZXRob2QgbXVzdCBiZSBhIHN0cmluZyBvciBmdW5jdGlvbiIpO2xldCBmPVtdO2ZvcihsZXQgYT0wO2E8dTthKyspe2NvbnN0IGw9bmV3IF87bC5pc0xlYWY9ITAsbC5pbmRleD1hLGYucHVzaChsKX1mb3IobGV0IGE9MDthPHUtMTthKyspe2NvbnN0W2wscCx5XT1HZShpKSxSPWZbbF0saz1mW3BdLFM9bmV3IF87Uy5zaXplPVIuc2l6ZStrLnNpemUsUy5jaGlsZHJlbi5wdXNoKFIsayksUy5oZWlnaHQ9eTtjb25zdCB2PVtTXSxoPW5ldyBkKGkucm93cy0xLGkucm93cy0xKSx3PWM9PlVlKGMsTWF0aC5taW4obCxwKSxNYXRoLm1heChsLHApKTtmb3IobGV0IGM9MTtjPGgucm93cztjKyspe2NvbnN0IGc9dyhjKSxFPWZbZ107di5wdXNoKEUpO2ZvcihsZXQgbT0wO208YzttKyspaWYobT09PTApe2NvbnN0IE09aS5nZXQobCxnKSxxPWkuZ2V0KGcscCksST1zKE0scSx5LFIuc2l6ZSxrLnNpemUsRS5zaXplKTtoLnNldChjLG0sSSksaC5zZXQobSxjLEkpfWVsc2V7Y29uc3QgTT1pLmdldChnLHcobSkpO2guc2V0KGMsbSxNKSxoLnNldChtLGMsTSl9fWY9dixpPWh9cmV0dXJuIGZbMF19ZnVuY3Rpb24gR2Uocil7bGV0IG89MS8wLG49MCx0PTA7Zm9yKGxldCBlPTE7ZTxyLnJvd3M7ZSsrKWZvcihsZXQgcz0wO3M8ZTtzKyspci5nZXQoZSxzKTxvJiYobz1yLmdldChlLHMpLG49ZSx0PXMpO3JldHVybltuLHQsb119ZnVuY3Rpb24gVWUocixvLG4pe3JldHVybiByLT0xLHI+PW8mJnIrKyxyPj1uJiZyKysscn1sZXQgV2U9KHI9MjEpPT57bGV0IG89IiIsbj1jcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKG5ldyBVaW50OEFycmF5KHIpKTtmb3IoO3ItLTspe2xldCB0PW5bcl0mNjM7dDwzNj9vKz10LnRvU3RyaW5nKDM2KTp0PDYyP28rPSh0LTI2KS50b1N0cmluZygzNikudG9VcHBlckNhc2UoKTp0PDYzP28rPSJfIjpvKz0iLSJ9cmV0dXJuIG99O2Z1bmN0aW9uIFhlKHIpe3JldHVybiB0eXBlb2Ygcj09Im51bWJlciImJiFpc05hTihyKX1mdW5jdGlvbiBLZShyLG8pe2xldCBuPTAsdCxlPTAscz0wO2lmKG89PT12b2lkIDApZm9yKGxldCBpIG9mIHIpaSE9bnVsbCYmKGk9K2kpPj1pJiYodD1pLWUsZSs9dC8rK24scys9dCooaS1lKSk7ZWxzZXtsZXQgaT0tMTtmb3IobGV0IHUgb2YgcikodT1vKHUsKytpLHIpKSE9bnVsbCYmKHU9K3UpPj11JiYodD11LWUsZSs9dC8rK24scys9dCoodS1lKSl9aWYobj4xKXJldHVybiBzLyhuLTEpfWZ1bmN0aW9uIF9lKHIsbyl7Y29uc3Qgbj1LZShyLG8pO3JldHVybiBuJiZNYXRoLnNxcnQobil9ZnVuY3Rpb24gUWUocixvKXtsZXQgbjtpZihvPT09dm9pZCAwKWZvcihjb25zdCB0IG9mIHIpdCE9bnVsbCYmKG4+dHx8bj09PXZvaWQgMCYmdD49dCkmJihuPXQpO2Vsc2V7bGV0IHQ9LTE7Zm9yKGxldCBlIG9mIHIpKGU9byhlLCsrdCxyKSkhPW51bGwmJihuPmV8fG49PT12b2lkIDAmJmU+PWUpJiYobj1lKX1yZXR1cm4gbn1mdW5jdGlvbiBZZShyLG8pe2xldCBuPTAsdD0wO2lmKG89PT12b2lkIDApZm9yKGxldCBlIG9mIHIpZSE9bnVsbCYmKGU9K2UpPj1lJiYoKytuLHQrPWUpO2Vsc2V7bGV0IGU9LTE7Zm9yKGxldCBzIG9mIHIpKHM9byhzLCsrZSxyKSkhPW51bGwmJihzPStzKT49cyYmKCsrbix0Kz1zKX1pZihuKXJldHVybiB0L259ZnVuY3Rpb24gWmUocil7aWYoIShzPXIubGVuZ3RoKSlyZXR1cm5bXTtmb3IodmFyIG89LTEsbj1RZShyLHhlKSx0PW5ldyBBcnJheShuKTsrK288bjspZm9yKHZhciBlPS0xLHMsaT10W29dPW5ldyBBcnJheShzKTsrK2U8czspaVtlXT1yW2VdW29dO3JldHVybiB0fWZ1bmN0aW9uIHhlKHIpe3JldHVybiByLmxlbmd0aH1mdW5jdGlvbiBBZShyLG89W10sbj1bXSl7Y29uc3QgdD0obCxwKT0+by5pbmNsdWRlcyhsKT9wOnZvaWQgMDtsZXQgZT1bXTtvLmxlbmd0aD4wJiYoZT1vLm1hcCh0KS5maWx0ZXIoWGUpKTtjb25zdCBzPShsLHApPT5lLmluY2x1ZGVzKHApLGk9bD0+cGFyc2VGbG9hdChsKSx1PWw9Pntjb25zdFsscF09bDtsZXQgeT1wO3JldHVybiBvJiZlLmxlbmd0aD4wJiYoeT1wLmZpbHRlcihzKSkseS5tYXAoaSl9O3JldHVybiBuLm1hcChsPT5bbCxyW2xdXSkubWFwKHUpfWZ1bmN0aW9uIHRuKHIpe3JldHVybiByLm1hcChvPT57Y29uc3Qgbj1ZZShvKSx0PV9lKG8pO3JldHVybiB0PT09MD9vOm8ubWFwKHM9PihzLW4pL3QpfSl9ZnVuY3Rpb24gZW4ocixvKXtzd2l0Y2gobyl7Y2FzZSJldWNsaWRlYW4iOnJldHVybiB0dChyLHRlW29dKTtjYXNlImNvcnJlbGF0aW9uIjp7Y29uc3Qgbj1uZXcgZChyKS50cmFuc3Bvc2UoKTtyZXR1cm4gYmUobix7Y2VudGVyOiEwLHNjYWxlOiExfSkudG8yREFycmF5KCl9ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoYHVuc3VwcG9ydGVkIGRpc3RhbmNlIG1ldGhvZCAke299LmApfX1mdW5jdGlvbiBubihyLG8pe3JldHVybiBKZShyLHtpc0Rpc3RhbmNlTWF0cml4OiEwLG1ldGhvZDpvfSl9ZnVuY3Rpb24gb24ocixvKXtyZXR1cm4obix0KT0+e2NvbnN0IGU9clt0XSxzPW4ubWFwKChpLHUpPT4oe2JpbjpvP29bdV06clt1XSxjb3VudDppfSkpO3JldHVybntiaW46ZSxiaW5zOnN9fX1mdW5jdGlvbiB1dChyLG8pe2lmKHIuaXNMZWFmKXJldHVybntuYW1lOm9bci5pbmRleF19O3tjb25zdCBuPVdlKCksdD1yLmNoaWxkcmVuLm1hcChlPT51dChlLG8pKTtyZXR1cm57bmFtZTpuLGNoaWxkcmVuOnR9fX1mdW5jdGlvbiBZKHIsbyl7cmV0dXJuIHIuaXNMZWFmP28/e1tvW3IuaW5kZXhdXTpyLmluZGV4fTpbci5pbmRleF06bz9yLmNoaWxkcmVuLnJlZHVjZSgodCxlKT0+e2NvbnN0IHM9WShlLG8pO3JldHVybiBBKEEoe30sdCkscyl9LHt9KTpyLmNoaWxkcmVuLnJlZHVjZSgodCxlKT0+e2NvbnN0IHM9WShlKTtyZXR1cm4gdC5wdXNoKC4uLnMpLHR9LFtdKX1mdW5jdGlvbiBybihyLG8sbil7cmV0dXJuIG8ubWFwKGU9Pntjb25zdCBzPXJbZV07cmV0dXJuIG4/bi5tYXAodT0+c1t1XSk6by5tYXAodT0+c1t1XSl9KX1mdW5jdGlvbiBzbihyLG8sbix0LGUscz0hMSl7bGV0IGk9QWUocixuLHQpO2UmJihpPXRuKGkpKSxzfHwoaT1aZShpKSk7Y29uc3QgdT1zP3Q6bixmPWVuKGksbyksYT1ubihvPT09ImNvcnJlbGF0aW9uIj9mLm1hcChrPT5rLm1hcChTPT4xLU1hdGguYWJzKFMpKSk6Ziwid2FyZCIpLGw9dXQoYSx1KSxwPVkoYSx1KTtyZXR1cm57YmluczpybihmLE9iamVjdC52YWx1ZXMocCkpLm1hcChvbihPYmplY3Qua2V5cyhwKSkpLHRyZWU6bH19b25tZXNzYWdlPWZ1bmN0aW9uKHIpe2NvbnN0e2RhdGFSb3dzOm8sZGlzdGFuY2VNZXRob2Q6bixzcmNSZXBsaWNhdGVOYW1lczp0LHNyY0FjY2Vzc2lvbklkczplLHpUcmFuc2Zvcm06cyx0cmFuc3Bvc2U6aX09ci5kYXRhLHU9c24obyxuLHQsZSxzLGkpO3Bvc3RNZXNzYWdlKHUsdm9pZCAwKX19KSgpO30pKCk7Cg==",kl=typeof window!="undefined"&&window.Blob&&new Blob([atob(Pl)],{type:"text/javascript;charset=utf-8"});function va(){const t=kl&&(window.URL||window.webkitURL).createObjectURL(kl);try{return t?new Worker(t):new Worker("data:application/javascript;base64,"+Pl,{type:"module"})}finally{t&&(window.URL||window.webkitURL).revokeObjectURL(t)}}const wl="KCgpPT57KGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIEl0KG4sZSl7bGV0IHM9MCx0LHI9MCxvPTA7aWYoZT09PXZvaWQgMClmb3IobGV0IGkgb2YgbilpIT1udWxsJiYoaT0raSk+PWkmJih0PWktcixyKz10LysrcyxvKz10KihpLXIpKTtlbHNle2xldCBpPS0xO2ZvcihsZXQgaCBvZiBuKShoPWUoaCwrK2ksbikpIT1udWxsJiYoaD0raCk+PWgmJih0PWgtcixyKz10LysrcyxvKz10KihoLXIpKX1pZihzPjEpcmV0dXJuIG8vKHMtMSl9ZnVuY3Rpb24gcXQobixlKXtjb25zdCBzPUl0KG4sZSk7cmV0dXJuIHMmJk1hdGguc3FydChzKX1mdW5jdGlvbiBGdChuLGUpe2xldCBzO2lmKGU9PT12b2lkIDApZm9yKGNvbnN0IHQgb2Ygbil0IT1udWxsJiYocz50fHxzPT09dm9pZCAwJiZ0Pj10KSYmKHM9dCk7ZWxzZXtsZXQgdD0tMTtmb3IobGV0IHIgb2Ygbikocj1lKHIsKyt0LG4pKSE9bnVsbCYmKHM+cnx8cz09PXZvaWQgMCYmcj49cikmJihzPXIpfXJldHVybiBzfWZ1bmN0aW9uICR0KG4sZSl7bGV0IHM9MCx0PTA7aWYoZT09PXZvaWQgMClmb3IobGV0IHIgb2YgbilyIT1udWxsJiYocj0rcik+PXImJigrK3MsdCs9cik7ZWxzZXtsZXQgcj0tMTtmb3IobGV0IG8gb2Ygbikobz1lKG8sKytyLG4pKSE9bnVsbCYmKG89K28pPj1vJiYoKytzLHQrPW8pfWlmKHMpcmV0dXJuIHQvc31mdW5jdGlvbiBDdChuKXtpZighKG89bi5sZW5ndGgpKXJldHVybltdO2Zvcih2YXIgZT0tMSxzPUZ0KG4sUHQpLHQ9bmV3IEFycmF5KHMpOysrZTxzOylmb3IodmFyIHI9LTEsbyxpPXRbZV09bmV3IEFycmF5KG8pOysrcjxvOylpW3JdPW5bcl1bZV07cmV0dXJuIHR9ZnVuY3Rpb24gUHQobil7cmV0dXJuIG4ubGVuZ3RofWNvbnN0IHp0PU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7ZnVuY3Rpb24gcnQobil7cmV0dXJuIHp0LmNhbGwobikuZW5kc1dpdGgoIkFycmF5XSIpfWZ1bmN0aW9uIEx0KG4pe3ZhciBlPWFyZ3VtZW50cy5sZW5ndGg+MSYmYXJndW1lbnRzWzFdIT09dm9pZCAwP2FyZ3VtZW50c1sxXTp7fTtpZighcnQobikpdGhyb3cgbmV3IFR5cGVFcnJvcigiaW5wdXQgbXVzdCBiZSBhbiBhcnJheSIpO2lmKG4ubGVuZ3RoPT09MCl0aHJvdyBuZXcgVHlwZUVycm9yKCJpbnB1dCBtdXN0IG5vdCBiZSBlbXB0eSIpO3ZhciBzPWUuZnJvbUluZGV4LHQ9cz09PXZvaWQgMD8wOnMscj1lLnRvSW5kZXgsbz1yPT09dm9pZCAwP24ubGVuZ3RoOnI7aWYodDwwfHx0Pj1uLmxlbmd0aHx8IU51bWJlci5pc0ludGVnZXIodCkpdGhyb3cgbmV3IEVycm9yKCJmcm9tSW5kZXggbXVzdCBiZSBhIHBvc2l0aXZlIGludGVnZXIgc21hbGxlciB0aGFuIGxlbmd0aCIpO2lmKG88PXR8fG8+bi5sZW5ndGh8fCFOdW1iZXIuaXNJbnRlZ2VyKG8pKXRocm93IG5ldyBFcnJvcigidG9JbmRleCBtdXN0IGJlIGFuIGludGVnZXIgZ3JlYXRlciB0aGFuIGZyb21JbmRleCBhbmQgYXQgbW9zdCBlcXVhbCB0byBsZW5ndGgiKTtmb3IodmFyIGk9blt0XSxoPXQrMTtoPG87aCsrKW5baF0+aSYmKGk9bltoXSk7cmV0dXJuIGl9ZnVuY3Rpb24gRHQobil7dmFyIGU9YXJndW1lbnRzLmxlbmd0aD4xJiZhcmd1bWVudHNbMV0hPT12b2lkIDA/YXJndW1lbnRzWzFdOnt9O2lmKCFydChuKSl0aHJvdyBuZXcgVHlwZUVycm9yKCJpbnB1dCBtdXN0IGJlIGFuIGFycmF5Iik7aWYobi5sZW5ndGg9PT0wKXRocm93IG5ldyBUeXBlRXJyb3IoImlucHV0IG11c3Qgbm90IGJlIGVtcHR5Iik7dmFyIHM9ZS5mcm9tSW5kZXgsdD1zPT09dm9pZCAwPzA6cyxyPWUudG9JbmRleCxvPXI9PT12b2lkIDA/bi5sZW5ndGg6cjtpZih0PDB8fHQ+PW4ubGVuZ3RofHwhTnVtYmVyLmlzSW50ZWdlcih0KSl0aHJvdyBuZXcgRXJyb3IoImZyb21JbmRleCBtdXN0IGJlIGEgcG9zaXRpdmUgaW50ZWdlciBzbWFsbGVyIHRoYW4gbGVuZ3RoIik7aWYobzw9dHx8bz5uLmxlbmd0aHx8IU51bWJlci5pc0ludGVnZXIobykpdGhyb3cgbmV3IEVycm9yKCJ0b0luZGV4IG11c3QgYmUgYW4gaW50ZWdlciBncmVhdGVyIHRoYW4gZnJvbUluZGV4IGFuZCBhdCBtb3N0IGVxdWFsIHRvIGxlbmd0aCIpO2Zvcih2YXIgaT1uW3RdLGg9dCsxO2g8bztoKyspbltoXTxpJiYoaT1uW2hdKTtyZXR1cm4gaX1mdW5jdGlvbiBkdChuKXt2YXIgZT1hcmd1bWVudHMubGVuZ3RoPjEmJmFyZ3VtZW50c1sxXSE9PXZvaWQgMD9hcmd1bWVudHNbMV06e307aWYocnQobikpe2lmKG4ubGVuZ3RoPT09MCl0aHJvdyBuZXcgVHlwZUVycm9yKCJpbnB1dCBtdXN0IG5vdCBiZSBlbXB0eSIpfWVsc2UgdGhyb3cgbmV3IFR5cGVFcnJvcigiaW5wdXQgbXVzdCBiZSBhbiBhcnJheSIpO3ZhciBzO2lmKGUub3V0cHV0IT09dm9pZCAwKXtpZighcnQoZS5vdXRwdXQpKXRocm93IG5ldyBUeXBlRXJyb3IoIm91dHB1dCBvcHRpb24gbXVzdCBiZSBhbiBhcnJheSBpZiBzcGVjaWZpZWQiKTtzPWUub3V0cHV0fWVsc2Ugcz1uZXcgQXJyYXkobi5sZW5ndGgpO3ZhciB0PUR0KG4pLHI9THQobik7aWYodD09PXIpdGhyb3cgbmV3IFJhbmdlRXJyb3IoIm1pbmltdW0gYW5kIG1heGltdW0gaW5wdXQgdmFsdWVzIGFyZSBlcXVhbC4gQ2Fubm90IHJlc2NhbGUgYSBjb25zdGFudCBhcnJheSIpO3ZhciBvPWUubWluLGk9bz09PXZvaWQgMD9lLmF1dG9NaW5NYXg/dDowOm8saD1lLm1heCxhPWg9PT12b2lkIDA/ZS5hdXRvTWluTWF4P3I6MTpoO2lmKGk+PWEpdGhyb3cgbmV3IFJhbmdlRXJyb3IoIm1pbiBvcHRpb24gbXVzdCBiZSBzbWFsbGVyIHRoYW4gbWF4IG9wdGlvbiIpO2Zvcih2YXIgbD0oYS1pKS8oci10KSxnPTA7ZzxuLmxlbmd0aDtnKyspc1tnXT0obltnXS10KSpsK2k7cmV0dXJuIHN9Y29uc3Qgb3Q9IiAiLnJlcGVhdCgyKSx5dD0iICIucmVwZWF0KDQpO2Z1bmN0aW9uIFV0KCl7cmV0dXJuIHZ0KHRoaXMpfWZ1bmN0aW9uIHZ0KG4sZT17fSl7Y29uc3R7bWF4Um93czpzPTE1LG1heENvbHVtbnM6dD0xMCxtYXhOdW1TaXplOnI9OH09ZTtyZXR1cm5gJHtuLmNvbnN0cnVjdG9yLm5hbWV9IHsKJHtvdH1bCiR7eXR9JHtPdChuLHMsdCxyKX0KJHtvdH1dCiR7b3R9cm93czogJHtuLnJvd3N9CiR7b3R9Y29sdW1uczogJHtuLmNvbHVtbnN9Cn1gfWZ1bmN0aW9uIE90KG4sZSxzLHQpe2NvbnN0e3Jvd3M6cixjb2x1bW5zOm99PW4saT1NYXRoLm1pbihyLGUpLGg9TWF0aC5taW4obyxzKSxhPVtdO2ZvcihsZXQgbD0wO2w8aTtsKyspe2xldCBnPVtdO2ZvcihsZXQgdT0wO3U8aDt1KyspZy5wdXNoKFZ0KG4uZ2V0KGwsdSksdCkpO2EucHVzaChgJHtnLmpvaW4oIiAiKX1gKX1yZXR1cm4gaCE9PW8mJihhW2EubGVuZ3RoLTFdKz1gIC4uLiAke28tc30gbW9yZSBjb2x1bW5zYCksaSE9PXImJmEucHVzaChgLi4uICR7ci1lfSBtb3JlIHJvd3NgKSxhLmpvaW4oYAoke3l0fWApfWZ1bmN0aW9uIFZ0KG4sZSl7Y29uc3Qgcz1TdHJpbmcobik7aWYocy5sZW5ndGg8PWUpcmV0dXJuIHMucGFkRW5kKGUsIiAiKTtjb25zdCB0PW4udG9QcmVjaXNpb24oZS0yKTtpZih0Lmxlbmd0aDw9ZSlyZXR1cm4gdDtjb25zdCByPW4udG9FeHBvbmVudGlhbChlLTIpLG89ci5pbmRleE9mKCJlIiksaT1yLnNsaWNlKG8pO3JldHVybiByLnNsaWNlKDAsZS1pLmxlbmd0aCkraX1mdW5jdGlvbiBCdChuLGUpe24ucHJvdG90eXBlLmFkZD1mdW5jdGlvbih0KXtyZXR1cm4gdHlwZW9mIHQ9PSJudW1iZXIiP3RoaXMuYWRkUyh0KTp0aGlzLmFkZE0odCl9LG4ucHJvdG90eXBlLmFkZFM9ZnVuY3Rpb24odCl7Zm9yKGxldCByPTA7cjx0aGlzLnJvd3M7cisrKWZvcihsZXQgbz0wO288dGhpcy5jb2x1bW5zO28rKyl0aGlzLnNldChyLG8sdGhpcy5nZXQocixvKSt0KTtyZXR1cm4gdGhpc30sbi5wcm90b3R5cGUuYWRkTT1mdW5jdGlvbih0KXtpZih0PWUuY2hlY2tNYXRyaXgodCksdGhpcy5yb3dzIT09dC5yb3dzfHx0aGlzLmNvbHVtbnMhPT10LmNvbHVtbnMpdGhyb3cgbmV3IFJhbmdlRXJyb3IoIk1hdHJpY2VzIGRpbWVuc2lvbnMgbXVzdCBiZSBlcXVhbCIpO2ZvcihsZXQgcj0wO3I8dGhpcy5yb3dzO3IrKylmb3IobGV0IG89MDtvPHRoaXMuY29sdW1ucztvKyspdGhpcy5zZXQocixvLHRoaXMuZ2V0KHIsbykrdC5nZXQocixvKSk7cmV0dXJuIHRoaXN9LG4uYWRkPWZ1bmN0aW9uKHQscil7cmV0dXJuIG5ldyBlKHQpLmFkZChyKX0sbi5wcm90b3R5cGUuc3ViPWZ1bmN0aW9uKHQpe3JldHVybiB0eXBlb2YgdD09Im51bWJlciI/dGhpcy5zdWJTKHQpOnRoaXMuc3ViTSh0KX0sbi5wcm90b3R5cGUuc3ViUz1mdW5jdGlvbih0KXtmb3IobGV0IHI9MDtyPHRoaXMucm93cztyKyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHIsbyx0aGlzLmdldChyLG8pLXQpO3JldHVybiB0aGlzfSxuLnByb3RvdHlwZS5zdWJNPWZ1bmN0aW9uKHQpe2lmKHQ9ZS5jaGVja01hdHJpeCh0KSx0aGlzLnJvd3MhPT10LnJvd3N8fHRoaXMuY29sdW1ucyE9PXQuY29sdW1ucyl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiTWF0cmljZXMgZGltZW5zaW9ucyBtdXN0IGJlIGVxdWFsIik7Zm9yKGxldCByPTA7cjx0aGlzLnJvd3M7cisrKWZvcihsZXQgbz0wO288dGhpcy5jb2x1bW5zO28rKyl0aGlzLnNldChyLG8sdGhpcy5nZXQocixvKS10LmdldChyLG8pKTtyZXR1cm4gdGhpc30sbi5zdWI9ZnVuY3Rpb24odCxyKXtyZXR1cm4gbmV3IGUodCkuc3ViKHIpfSxuLnByb3RvdHlwZS5zdWJ0cmFjdD1uLnByb3RvdHlwZS5zdWIsbi5wcm90b3R5cGUuc3VidHJhY3RTPW4ucHJvdG90eXBlLnN1YlMsbi5wcm90b3R5cGUuc3VidHJhY3RNPW4ucHJvdG90eXBlLnN1Yk0sbi5zdWJ0cmFjdD1uLnN1YixuLnByb3RvdHlwZS5tdWw9ZnVuY3Rpb24odCl7cmV0dXJuIHR5cGVvZiB0PT0ibnVtYmVyIj90aGlzLm11bFModCk6dGhpcy5tdWxNKHQpfSxuLnByb3RvdHlwZS5tdWxTPWZ1bmN0aW9uKHQpe2ZvcihsZXQgcj0wO3I8dGhpcy5yb3dzO3IrKylmb3IobGV0IG89MDtvPHRoaXMuY29sdW1ucztvKyspdGhpcy5zZXQocixvLHRoaXMuZ2V0KHIsbykqdCk7cmV0dXJuIHRoaXN9LG4ucHJvdG90eXBlLm11bE09ZnVuY3Rpb24odCl7aWYodD1lLmNoZWNrTWF0cml4KHQpLHRoaXMucm93cyE9PXQucm93c3x8dGhpcy5jb2x1bW5zIT09dC5jb2x1bW5zKXRocm93IG5ldyBSYW5nZUVycm9yKCJNYXRyaWNlcyBkaW1lbnNpb25zIG11c3QgYmUgZXF1YWwiKTtmb3IobGV0IHI9MDtyPHRoaXMucm93cztyKyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHIsbyx0aGlzLmdldChyLG8pKnQuZ2V0KHIsbykpO3JldHVybiB0aGlzfSxuLm11bD1mdW5jdGlvbih0LHIpe3JldHVybiBuZXcgZSh0KS5tdWwocil9LG4ucHJvdG90eXBlLm11bHRpcGx5PW4ucHJvdG90eXBlLm11bCxuLnByb3RvdHlwZS5tdWx0aXBseVM9bi5wcm90b3R5cGUubXVsUyxuLnByb3RvdHlwZS5tdWx0aXBseU09bi5wcm90b3R5cGUubXVsTSxuLm11bHRpcGx5PW4ubXVsLG4ucHJvdG90eXBlLmRpdj1mdW5jdGlvbih0KXtyZXR1cm4gdHlwZW9mIHQ9PSJudW1iZXIiP3RoaXMuZGl2Uyh0KTp0aGlzLmRpdk0odCl9LG4ucHJvdG90eXBlLmRpdlM9ZnVuY3Rpb24odCl7Zm9yKGxldCByPTA7cjx0aGlzLnJvd3M7cisrKWZvcihsZXQgbz0wO288dGhpcy5jb2x1bW5zO28rKyl0aGlzLnNldChyLG8sdGhpcy5nZXQocixvKS90KTtyZXR1cm4gdGhpc30sbi5wcm90b3R5cGUuZGl2TT1mdW5jdGlvbih0KXtpZih0PWUuY2hlY2tNYXRyaXgodCksdGhpcy5yb3dzIT09dC5yb3dzfHx0aGlzLmNvbHVtbnMhPT10LmNvbHVtbnMpdGhyb3cgbmV3IFJhbmdlRXJyb3IoIk1hdHJpY2VzIGRpbWVuc2lvbnMgbXVzdCBiZSBlcXVhbCIpO2ZvcihsZXQgcj0wO3I8dGhpcy5yb3dzO3IrKylmb3IobGV0IG89MDtvPHRoaXMuY29sdW1ucztvKyspdGhpcy5zZXQocixvLHRoaXMuZ2V0KHIsbykvdC5nZXQocixvKSk7cmV0dXJuIHRoaXN9LG4uZGl2PWZ1bmN0aW9uKHQscil7cmV0dXJuIG5ldyBlKHQpLmRpdihyKX0sbi5wcm90b3R5cGUuZGl2aWRlPW4ucHJvdG90eXBlLmRpdixuLnByb3RvdHlwZS5kaXZpZGVTPW4ucHJvdG90eXBlLmRpdlMsbi5wcm90b3R5cGUuZGl2aWRlTT1uLnByb3RvdHlwZS5kaXZNLG4uZGl2aWRlPW4uZGl2LG4ucHJvdG90eXBlLm1vZD1mdW5jdGlvbih0KXtyZXR1cm4gdHlwZW9mIHQ9PSJudW1iZXIiP3RoaXMubW9kUyh0KTp0aGlzLm1vZE0odCl9LG4ucHJvdG90eXBlLm1vZFM9ZnVuY3Rpb24odCl7Zm9yKGxldCByPTA7cjx0aGlzLnJvd3M7cisrKWZvcihsZXQgbz0wO288dGhpcy5jb2x1bW5zO28rKyl0aGlzLnNldChyLG8sdGhpcy5nZXQocixvKSV0KTtyZXR1cm4gdGhpc30sbi5wcm90b3R5cGUubW9kTT1mdW5jdGlvbih0KXtpZih0PWUuY2hlY2tNYXRyaXgodCksdGhpcy5yb3dzIT09dC5yb3dzfHx0aGlzLmNvbHVtbnMhPT10LmNvbHVtbnMpdGhyb3cgbmV3IFJhbmdlRXJyb3IoIk1hdHJpY2VzIGRpbWVuc2lvbnMgbXVzdCBiZSBlcXVhbCIpO2ZvcihsZXQgcj0wO3I8dGhpcy5yb3dzO3IrKylmb3IobGV0IG89MDtvPHRoaXMuY29sdW1ucztvKyspdGhpcy5zZXQocixvLHRoaXMuZ2V0KHIsbykldC5nZXQocixvKSk7cmV0dXJuIHRoaXN9LG4ubW9kPWZ1bmN0aW9uKHQscil7cmV0dXJuIG5ldyBlKHQpLm1vZChyKX0sbi5wcm90b3R5cGUubW9kdWx1cz1uLnByb3RvdHlwZS5tb2Qsbi5wcm90b3R5cGUubW9kdWx1c1M9bi5wcm90b3R5cGUubW9kUyxuLnByb3RvdHlwZS5tb2R1bHVzTT1uLnByb3RvdHlwZS5tb2RNLG4ubW9kdWx1cz1uLm1vZCxuLnByb3RvdHlwZS5hbmQ9ZnVuY3Rpb24odCl7cmV0dXJuIHR5cGVvZiB0PT0ibnVtYmVyIj90aGlzLmFuZFModCk6dGhpcy5hbmRNKHQpfSxuLnByb3RvdHlwZS5hbmRTPWZ1bmN0aW9uKHQpe2ZvcihsZXQgcj0wO3I8dGhpcy5yb3dzO3IrKylmb3IobGV0IG89MDtvPHRoaXMuY29sdW1ucztvKyspdGhpcy5zZXQocixvLHRoaXMuZ2V0KHIsbykmdCk7cmV0dXJuIHRoaXN9LG4ucHJvdG90eXBlLmFuZE09ZnVuY3Rpb24odCl7aWYodD1lLmNoZWNrTWF0cml4KHQpLHRoaXMucm93cyE9PXQucm93c3x8dGhpcy5jb2x1bW5zIT09dC5jb2x1bW5zKXRocm93IG5ldyBSYW5nZUVycm9yKCJNYXRyaWNlcyBkaW1lbnNpb25zIG11c3QgYmUgZXF1YWwiKTtmb3IobGV0IHI9MDtyPHRoaXMucm93cztyKyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHIsbyx0aGlzLmdldChyLG8pJnQuZ2V0KHIsbykpO3JldHVybiB0aGlzfSxuLmFuZD1mdW5jdGlvbih0LHIpe3JldHVybiBuZXcgZSh0KS5hbmQocil9LG4ucHJvdG90eXBlLm9yPWZ1bmN0aW9uKHQpe3JldHVybiB0eXBlb2YgdD09Im51bWJlciI/dGhpcy5vclModCk6dGhpcy5vck0odCl9LG4ucHJvdG90eXBlLm9yUz1mdW5jdGlvbih0KXtmb3IobGV0IHI9MDtyPHRoaXMucm93cztyKyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHIsbyx0aGlzLmdldChyLG8pfHQpO3JldHVybiB0aGlzfSxuLnByb3RvdHlwZS5vck09ZnVuY3Rpb24odCl7aWYodD1lLmNoZWNrTWF0cml4KHQpLHRoaXMucm93cyE9PXQucm93c3x8dGhpcy5jb2x1bW5zIT09dC5jb2x1bW5zKXRocm93IG5ldyBSYW5nZUVycm9yKCJNYXRyaWNlcyBkaW1lbnNpb25zIG11c3QgYmUgZXF1YWwiKTtmb3IobGV0IHI9MDtyPHRoaXMucm93cztyKyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHIsbyx0aGlzLmdldChyLG8pfHQuZ2V0KHIsbykpO3JldHVybiB0aGlzfSxuLm9yPWZ1bmN0aW9uKHQscil7cmV0dXJuIG5ldyBlKHQpLm9yKHIpfSxuLnByb3RvdHlwZS54b3I9ZnVuY3Rpb24odCl7cmV0dXJuIHR5cGVvZiB0PT0ibnVtYmVyIj90aGlzLnhvclModCk6dGhpcy54b3JNKHQpfSxuLnByb3RvdHlwZS54b3JTPWZ1bmN0aW9uKHQpe2ZvcihsZXQgcj0wO3I8dGhpcy5yb3dzO3IrKylmb3IobGV0IG89MDtvPHRoaXMuY29sdW1ucztvKyspdGhpcy5zZXQocixvLHRoaXMuZ2V0KHIsbyledCk7cmV0dXJuIHRoaXN9LG4ucHJvdG90eXBlLnhvck09ZnVuY3Rpb24odCl7aWYodD1lLmNoZWNrTWF0cml4KHQpLHRoaXMucm93cyE9PXQucm93c3x8dGhpcy5jb2x1bW5zIT09dC5jb2x1bW5zKXRocm93IG5ldyBSYW5nZUVycm9yKCJNYXRyaWNlcyBkaW1lbnNpb25zIG11c3QgYmUgZXF1YWwiKTtmb3IobGV0IHI9MDtyPHRoaXMucm93cztyKyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHIsbyx0aGlzLmdldChyLG8pXnQuZ2V0KHIsbykpO3JldHVybiB0aGlzfSxuLnhvcj1mdW5jdGlvbih0LHIpe3JldHVybiBuZXcgZSh0KS54b3Iocil9LG4ucHJvdG90eXBlLmxlZnRTaGlmdD1mdW5jdGlvbih0KXtyZXR1cm4gdHlwZW9mIHQ9PSJudW1iZXIiP3RoaXMubGVmdFNoaWZ0Uyh0KTp0aGlzLmxlZnRTaGlmdE0odCl9LG4ucHJvdG90eXBlLmxlZnRTaGlmdFM9ZnVuY3Rpb24odCl7Zm9yKGxldCByPTA7cjx0aGlzLnJvd3M7cisrKWZvcihsZXQgbz0wO288dGhpcy5jb2x1bW5zO28rKyl0aGlzLnNldChyLG8sdGhpcy5nZXQocixvKTw8dCk7cmV0dXJuIHRoaXN9LG4ucHJvdG90eXBlLmxlZnRTaGlmdE09ZnVuY3Rpb24odCl7aWYodD1lLmNoZWNrTWF0cml4KHQpLHRoaXMucm93cyE9PXQucm93c3x8dGhpcy5jb2x1bW5zIT09dC5jb2x1bW5zKXRocm93IG5ldyBSYW5nZUVycm9yKCJNYXRyaWNlcyBkaW1lbnNpb25zIG11c3QgYmUgZXF1YWwiKTtmb3IobGV0IHI9MDtyPHRoaXMucm93cztyKyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHIsbyx0aGlzLmdldChyLG8pPDx0LmdldChyLG8pKTtyZXR1cm4gdGhpc30sbi5sZWZ0U2hpZnQ9ZnVuY3Rpb24odCxyKXtyZXR1cm4gbmV3IGUodCkubGVmdFNoaWZ0KHIpfSxuLnByb3RvdHlwZS5zaWduUHJvcGFnYXRpbmdSaWdodFNoaWZ0PWZ1bmN0aW9uKHQpe3JldHVybiB0eXBlb2YgdD09Im51bWJlciI/dGhpcy5zaWduUHJvcGFnYXRpbmdSaWdodFNoaWZ0Uyh0KTp0aGlzLnNpZ25Qcm9wYWdhdGluZ1JpZ2h0U2hpZnRNKHQpfSxuLnByb3RvdHlwZS5zaWduUHJvcGFnYXRpbmdSaWdodFNoaWZ0Uz1mdW5jdGlvbih0KXtmb3IobGV0IHI9MDtyPHRoaXMucm93cztyKyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHIsbyx0aGlzLmdldChyLG8pPj50KTtyZXR1cm4gdGhpc30sbi5wcm90b3R5cGUuc2lnblByb3BhZ2F0aW5nUmlnaHRTaGlmdE09ZnVuY3Rpb24odCl7aWYodD1lLmNoZWNrTWF0cml4KHQpLHRoaXMucm93cyE9PXQucm93c3x8dGhpcy5jb2x1bW5zIT09dC5jb2x1bW5zKXRocm93IG5ldyBSYW5nZUVycm9yKCJNYXRyaWNlcyBkaW1lbnNpb25zIG11c3QgYmUgZXF1YWwiKTtmb3IobGV0IHI9MDtyPHRoaXMucm93cztyKyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHIsbyx0aGlzLmdldChyLG8pPj50LmdldChyLG8pKTtyZXR1cm4gdGhpc30sbi5zaWduUHJvcGFnYXRpbmdSaWdodFNoaWZ0PWZ1bmN0aW9uKHQscil7cmV0dXJuIG5ldyBlKHQpLnNpZ25Qcm9wYWdhdGluZ1JpZ2h0U2hpZnQocil9LG4ucHJvdG90eXBlLnJpZ2h0U2hpZnQ9ZnVuY3Rpb24odCl7cmV0dXJuIHR5cGVvZiB0PT0ibnVtYmVyIj90aGlzLnJpZ2h0U2hpZnRTKHQpOnRoaXMucmlnaHRTaGlmdE0odCl9LG4ucHJvdG90eXBlLnJpZ2h0U2hpZnRTPWZ1bmN0aW9uKHQpe2ZvcihsZXQgcj0wO3I8dGhpcy5yb3dzO3IrKylmb3IobGV0IG89MDtvPHRoaXMuY29sdW1ucztvKyspdGhpcy5zZXQocixvLHRoaXMuZ2V0KHIsbyk+Pj50KTtyZXR1cm4gdGhpc30sbi5wcm90b3R5cGUucmlnaHRTaGlmdE09ZnVuY3Rpb24odCl7aWYodD1lLmNoZWNrTWF0cml4KHQpLHRoaXMucm93cyE9PXQucm93c3x8dGhpcy5jb2x1bW5zIT09dC5jb2x1bW5zKXRocm93IG5ldyBSYW5nZUVycm9yKCJNYXRyaWNlcyBkaW1lbnNpb25zIG11c3QgYmUgZXF1YWwiKTtmb3IobGV0IHI9MDtyPHRoaXMucm93cztyKyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHIsbyx0aGlzLmdldChyLG8pPj4+dC5nZXQocixvKSk7cmV0dXJuIHRoaXN9LG4ucmlnaHRTaGlmdD1mdW5jdGlvbih0LHIpe3JldHVybiBuZXcgZSh0KS5yaWdodFNoaWZ0KHIpfSxuLnByb3RvdHlwZS56ZXJvRmlsbFJpZ2h0U2hpZnQ9bi5wcm90b3R5cGUucmlnaHRTaGlmdCxuLnByb3RvdHlwZS56ZXJvRmlsbFJpZ2h0U2hpZnRTPW4ucHJvdG90eXBlLnJpZ2h0U2hpZnRTLG4ucHJvdG90eXBlLnplcm9GaWxsUmlnaHRTaGlmdE09bi5wcm90b3R5cGUucmlnaHRTaGlmdE0sbi56ZXJvRmlsbFJpZ2h0U2hpZnQ9bi5yaWdodFNoaWZ0LG4ucHJvdG90eXBlLm5vdD1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5zZXQodCxyLH50aGlzLmdldCh0LHIpKTtyZXR1cm4gdGhpc30sbi5ub3Q9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKHQpLm5vdCgpfSxuLnByb3RvdHlwZS5hYnM9ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCByPTA7cjx0aGlzLmNvbHVtbnM7cisrKXRoaXMuc2V0KHQscixNYXRoLmFicyh0aGlzLmdldCh0LHIpKSk7cmV0dXJuIHRoaXN9LG4uYWJzPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0KS5hYnMoKX0sbi5wcm90b3R5cGUuYWNvcz1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5zZXQodCxyLE1hdGguYWNvcyh0aGlzLmdldCh0LHIpKSk7cmV0dXJuIHRoaXN9LG4uYWNvcz1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUodCkuYWNvcygpfSxuLnByb3RvdHlwZS5hY29zaD1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5zZXQodCxyLE1hdGguYWNvc2godGhpcy5nZXQodCxyKSkpO3JldHVybiB0aGlzfSxuLmFjb3NoPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0KS5hY29zaCgpfSxuLnByb3RvdHlwZS5hc2luPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldCh0LHIsTWF0aC5hc2luKHRoaXMuZ2V0KHQscikpKTtyZXR1cm4gdGhpc30sbi5hc2luPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0KS5hc2luKCl9LG4ucHJvdG90eXBlLmFzaW5oPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldCh0LHIsTWF0aC5hc2luaCh0aGlzLmdldCh0LHIpKSk7cmV0dXJuIHRoaXN9LG4uYXNpbmg9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKHQpLmFzaW5oKCl9LG4ucHJvdG90eXBlLmF0YW49ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCByPTA7cjx0aGlzLmNvbHVtbnM7cisrKXRoaXMuc2V0KHQscixNYXRoLmF0YW4odGhpcy5nZXQodCxyKSkpO3JldHVybiB0aGlzfSxuLmF0YW49ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKHQpLmF0YW4oKX0sbi5wcm90b3R5cGUuYXRhbmg9ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCByPTA7cjx0aGlzLmNvbHVtbnM7cisrKXRoaXMuc2V0KHQscixNYXRoLmF0YW5oKHRoaXMuZ2V0KHQscikpKTtyZXR1cm4gdGhpc30sbi5hdGFuaD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUodCkuYXRhbmgoKX0sbi5wcm90b3R5cGUuY2JydD1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5zZXQodCxyLE1hdGguY2JydCh0aGlzLmdldCh0LHIpKSk7cmV0dXJuIHRoaXN9LG4uY2JydD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUodCkuY2JydCgpfSxuLnByb3RvdHlwZS5jZWlsPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldCh0LHIsTWF0aC5jZWlsKHRoaXMuZ2V0KHQscikpKTtyZXR1cm4gdGhpc30sbi5jZWlsPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0KS5jZWlsKCl9LG4ucHJvdG90eXBlLmNsejMyPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldCh0LHIsTWF0aC5jbHozMih0aGlzLmdldCh0LHIpKSk7cmV0dXJuIHRoaXN9LG4uY2x6MzI9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKHQpLmNsejMyKCl9LG4ucHJvdG90eXBlLmNvcz1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5zZXQodCxyLE1hdGguY29zKHRoaXMuZ2V0KHQscikpKTtyZXR1cm4gdGhpc30sbi5jb3M9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKHQpLmNvcygpfSxuLnByb3RvdHlwZS5jb3NoPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldCh0LHIsTWF0aC5jb3NoKHRoaXMuZ2V0KHQscikpKTtyZXR1cm4gdGhpc30sbi5jb3NoPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0KS5jb3NoKCl9LG4ucHJvdG90eXBlLmV4cD1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5zZXQodCxyLE1hdGguZXhwKHRoaXMuZ2V0KHQscikpKTtyZXR1cm4gdGhpc30sbi5leHA9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKHQpLmV4cCgpfSxuLnByb3RvdHlwZS5leHBtMT1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5zZXQodCxyLE1hdGguZXhwbTEodGhpcy5nZXQodCxyKSkpO3JldHVybiB0aGlzfSxuLmV4cG0xPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0KS5leHBtMSgpfSxuLnByb3RvdHlwZS5mbG9vcj1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5zZXQodCxyLE1hdGguZmxvb3IodGhpcy5nZXQodCxyKSkpO3JldHVybiB0aGlzfSxuLmZsb29yPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0KS5mbG9vcigpfSxuLnByb3RvdHlwZS5mcm91bmQ9ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCByPTA7cjx0aGlzLmNvbHVtbnM7cisrKXRoaXMuc2V0KHQscixNYXRoLmZyb3VuZCh0aGlzLmdldCh0LHIpKSk7cmV0dXJuIHRoaXN9LG4uZnJvdW5kPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0KS5mcm91bmQoKX0sbi5wcm90b3R5cGUubG9nPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldCh0LHIsTWF0aC5sb2codGhpcy5nZXQodCxyKSkpO3JldHVybiB0aGlzfSxuLmxvZz1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUodCkubG9nKCl9LG4ucHJvdG90eXBlLmxvZzFwPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldCh0LHIsTWF0aC5sb2cxcCh0aGlzLmdldCh0LHIpKSk7cmV0dXJuIHRoaXN9LG4ubG9nMXA9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKHQpLmxvZzFwKCl9LG4ucHJvdG90eXBlLmxvZzEwPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldCh0LHIsTWF0aC5sb2cxMCh0aGlzLmdldCh0LHIpKSk7cmV0dXJuIHRoaXN9LG4ubG9nMTA9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKHQpLmxvZzEwKCl9LG4ucHJvdG90eXBlLmxvZzI9ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCByPTA7cjx0aGlzLmNvbHVtbnM7cisrKXRoaXMuc2V0KHQscixNYXRoLmxvZzIodGhpcy5nZXQodCxyKSkpO3JldHVybiB0aGlzfSxuLmxvZzI9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKHQpLmxvZzIoKX0sbi5wcm90b3R5cGUucm91bmQ9ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCByPTA7cjx0aGlzLmNvbHVtbnM7cisrKXRoaXMuc2V0KHQscixNYXRoLnJvdW5kKHRoaXMuZ2V0KHQscikpKTtyZXR1cm4gdGhpc30sbi5yb3VuZD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUodCkucm91bmQoKX0sbi5wcm90b3R5cGUuc2lnbj1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5zZXQodCxyLE1hdGguc2lnbih0aGlzLmdldCh0LHIpKSk7cmV0dXJuIHRoaXN9LG4uc2lnbj1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUodCkuc2lnbigpfSxuLnByb3RvdHlwZS5zaW49ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCByPTA7cjx0aGlzLmNvbHVtbnM7cisrKXRoaXMuc2V0KHQscixNYXRoLnNpbih0aGlzLmdldCh0LHIpKSk7cmV0dXJuIHRoaXN9LG4uc2luPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0KS5zaW4oKX0sbi5wcm90b3R5cGUuc2luaD1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5zZXQodCxyLE1hdGguc2luaCh0aGlzLmdldCh0LHIpKSk7cmV0dXJuIHRoaXN9LG4uc2luaD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUodCkuc2luaCgpfSxuLnByb3RvdHlwZS5zcXJ0PWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldCh0LHIsTWF0aC5zcXJ0KHRoaXMuZ2V0KHQscikpKTtyZXR1cm4gdGhpc30sbi5zcXJ0PWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0KS5zcXJ0KCl9LG4ucHJvdG90eXBlLnRhbj1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5zZXQodCxyLE1hdGgudGFuKHRoaXMuZ2V0KHQscikpKTtyZXR1cm4gdGhpc30sbi50YW49ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKHQpLnRhbigpfSxuLnByb3RvdHlwZS50YW5oPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldCh0LHIsTWF0aC50YW5oKHRoaXMuZ2V0KHQscikpKTtyZXR1cm4gdGhpc30sbi50YW5oPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0KS50YW5oKCl9LG4ucHJvdG90eXBlLnRydW5jPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldCh0LHIsTWF0aC50cnVuYyh0aGlzLmdldCh0LHIpKSk7cmV0dXJuIHRoaXN9LG4udHJ1bmM9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKHQpLnRydW5jKCl9LG4ucG93PWZ1bmN0aW9uKHQscil7cmV0dXJuIG5ldyBlKHQpLnBvdyhyKX0sbi5wcm90b3R5cGUucG93PWZ1bmN0aW9uKHQpe3JldHVybiB0eXBlb2YgdD09Im51bWJlciI/dGhpcy5wb3dTKHQpOnRoaXMucG93TSh0KX0sbi5wcm90b3R5cGUucG93Uz1mdW5jdGlvbih0KXtmb3IobGV0IHI9MDtyPHRoaXMucm93cztyKyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHIsbyxNYXRoLnBvdyh0aGlzLmdldChyLG8pLHQpKTtyZXR1cm4gdGhpc30sbi5wcm90b3R5cGUucG93TT1mdW5jdGlvbih0KXtpZih0PWUuY2hlY2tNYXRyaXgodCksdGhpcy5yb3dzIT09dC5yb3dzfHx0aGlzLmNvbHVtbnMhPT10LmNvbHVtbnMpdGhyb3cgbmV3IFJhbmdlRXJyb3IoIk1hdHJpY2VzIGRpbWVuc2lvbnMgbXVzdCBiZSBlcXVhbCIpO2ZvcihsZXQgcj0wO3I8dGhpcy5yb3dzO3IrKylmb3IobGV0IG89MDtvPHRoaXMuY29sdW1ucztvKyspdGhpcy5zZXQocixvLE1hdGgucG93KHRoaXMuZ2V0KHIsbyksdC5nZXQocixvKSkpO3JldHVybiB0aGlzfX1mdW5jdGlvbiBXKG4sZSxzKXtsZXQgdD1zP24ucm93czpuLnJvd3MtMTtpZihlPDB8fGU+dCl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiUm93IGluZGV4IG91dCBvZiByYW5nZSIpfWZ1bmN0aW9uIEoobixlLHMpe2xldCB0PXM/bi5jb2x1bW5zOm4uY29sdW1ucy0xO2lmKGU8MHx8ZT50KXRocm93IG5ldyBSYW5nZUVycm9yKCJDb2x1bW4gaW5kZXggb3V0IG9mIHJhbmdlIil9ZnVuY3Rpb24gQShuLGUpe2lmKGUudG8xREFycmF5JiYoZT1lLnRvMURBcnJheSgpKSxlLmxlbmd0aCE9PW4uY29sdW1ucyl0aHJvdyBuZXcgUmFuZ2VFcnJvcigidmVjdG9yIHNpemUgbXVzdCBiZSB0aGUgc2FtZSBhcyB0aGUgbnVtYmVyIG9mIGNvbHVtbnMiKTtyZXR1cm4gZX1mdW5jdGlvbiBIKG4sZSl7aWYoZS50bzFEQXJyYXkmJihlPWUudG8xREFycmF5KCkpLGUubGVuZ3RoIT09bi5yb3dzKXRocm93IG5ldyBSYW5nZUVycm9yKCJ2ZWN0b3Igc2l6ZSBtdXN0IGJlIHRoZSBzYW1lIGFzIHRoZSBudW1iZXIgb2Ygcm93cyIpO3JldHVybiBlfWZ1bmN0aW9uIFl0KG4sZSxzKXtyZXR1cm57cm93Ol90KG4sZSksY29sdW1uOlh0KG4scyl9fWZ1bmN0aW9uIF90KG4sZSl7aWYodHlwZW9mIGUhPSJvYmplY3QiKXRocm93IG5ldyBUeXBlRXJyb3IoInVuZXhwZWN0ZWQgdHlwZSBmb3Igcm93IGluZGljZXMiKTtpZihlLnNvbWUodD0+dDwwfHx0Pj1uLnJvd3MpKXRocm93IG5ldyBSYW5nZUVycm9yKCJyb3cgaW5kaWNlcyBhcmUgb3V0IG9mIHJhbmdlIik7cmV0dXJuIEFycmF5LmlzQXJyYXkoZSl8fChlPUFycmF5LmZyb20oZSkpLGV9ZnVuY3Rpb24gWHQobixlKXtpZih0eXBlb2YgZSE9Im9iamVjdCIpdGhyb3cgbmV3IFR5cGVFcnJvcigidW5leHBlY3RlZCB0eXBlIGZvciBjb2x1bW4gaW5kaWNlcyIpO2lmKGUuc29tZSh0PT50PDB8fHQ+PW4uY29sdW1ucykpdGhyb3cgbmV3IFJhbmdlRXJyb3IoImNvbHVtbiBpbmRpY2VzIGFyZSBvdXQgb2YgcmFuZ2UiKTtyZXR1cm4gQXJyYXkuaXNBcnJheShlKXx8KGU9QXJyYXkuZnJvbShlKSksZX1mdW5jdGlvbiBNdChuLGUscyx0LHIpe2lmKGFyZ3VtZW50cy5sZW5ndGghPT01KXRocm93IG5ldyBSYW5nZUVycm9yKCJleHBlY3RlZCA0IGFyZ3VtZW50cyIpO2lmKGl0KCJzdGFydFJvdyIsZSksaXQoImVuZFJvdyIscyksaXQoInN0YXJ0Q29sdW1uIix0KSxpdCgiZW5kQ29sdW1uIixyKSxlPnN8fHQ+cnx8ZTwwfHxlPj1uLnJvd3N8fHM8MHx8cz49bi5yb3dzfHx0PDB8fHQ+PW4uY29sdW1uc3x8cjwwfHxyPj1uLmNvbHVtbnMpdGhyb3cgbmV3IFJhbmdlRXJyb3IoIlN1Ym1hdHJpeCBpbmRpY2VzIGFyZSBvdXQgb2YgcmFuZ2UiKX1mdW5jdGlvbiBudChuLGU9MCl7bGV0IHM9W107Zm9yKGxldCB0PTA7dDxuO3QrKylzLnB1c2goZSk7cmV0dXJuIHN9ZnVuY3Rpb24gaXQobixlKXtpZih0eXBlb2YgZSE9Im51bWJlciIpdGhyb3cgbmV3IFR5cGVFcnJvcihgJHtufSBtdXN0IGJlIGEgbnVtYmVyYCl9ZnVuY3Rpb24gdHQobil7aWYobi5pc0VtcHR5KCkpdGhyb3cgbmV3IEVycm9yKCJFbXB0eSBtYXRyaXggaGFzIG5vIGVsZW1lbnRzIHRvIGluZGV4Iil9ZnVuY3Rpb24gWnQobil7bGV0IGU9bnQobi5yb3dzKTtmb3IobGV0IHM9MDtzPG4ucm93czsrK3MpZm9yKGxldCB0PTA7dDxuLmNvbHVtbnM7Kyt0KWVbc10rPW4uZ2V0KHMsdCk7cmV0dXJuIGV9ZnVuY3Rpb24gR3Qobil7bGV0IGU9bnQobi5jb2x1bW5zKTtmb3IobGV0IHM9MDtzPG4ucm93czsrK3MpZm9yKGxldCB0PTA7dDxuLmNvbHVtbnM7Kyt0KWVbdF0rPW4uZ2V0KHMsdCk7cmV0dXJuIGV9ZnVuY3Rpb24gV3Qobil7bGV0IGU9MDtmb3IobGV0IHM9MDtzPG4ucm93cztzKyspZm9yKGxldCB0PTA7dDxuLmNvbHVtbnM7dCsrKWUrPW4uZ2V0KHMsdCk7cmV0dXJuIGV9ZnVuY3Rpb24gSnQobil7bGV0IGU9bnQobi5yb3dzLDEpO2ZvcihsZXQgcz0wO3M8bi5yb3dzOysrcylmb3IobGV0IHQ9MDt0PG4uY29sdW1uczsrK3QpZVtzXSo9bi5nZXQocyx0KTtyZXR1cm4gZX1mdW5jdGlvbiBRdChuKXtsZXQgZT1udChuLmNvbHVtbnMsMSk7Zm9yKGxldCBzPTA7czxuLnJvd3M7KytzKWZvcihsZXQgdD0wO3Q8bi5jb2x1bW5zOysrdCllW3RdKj1uLmdldChzLHQpO3JldHVybiBlfWZ1bmN0aW9uIEt0KG4pe2xldCBlPTE7Zm9yKGxldCBzPTA7czxuLnJvd3M7cysrKWZvcihsZXQgdD0wO3Q8bi5jb2x1bW5zO3QrKyllKj1uLmdldChzLHQpO3JldHVybiBlfWZ1bmN0aW9uIHh0KG4sZSxzKXtjb25zdCB0PW4ucm93cyxyPW4uY29sdW1ucyxvPVtdO2ZvcihsZXQgaT0wO2k8dDtpKyspe2xldCBoPTAsYT0wLGw9MDtmb3IobGV0IGc9MDtnPHI7ZysrKWw9bi5nZXQoaSxnKS1zW2ldLGgrPWwsYSs9bCpsO2U/by5wdXNoKChhLWgqaC9yKS8oci0xKSk6by5wdXNoKChhLWgqaC9yKS9yKX1yZXR1cm4gb31mdW5jdGlvbiBBdChuLGUscyl7Y29uc3QgdD1uLnJvd3Mscj1uLmNvbHVtbnMsbz1bXTtmb3IobGV0IGk9MDtpPHI7aSsrKXtsZXQgaD0wLGE9MCxsPTA7Zm9yKGxldCBnPTA7Zzx0O2crKylsPW4uZ2V0KGcsaSktc1tpXSxoKz1sLGErPWwqbDtlP28ucHVzaCgoYS1oKmgvdCkvKHQtMSkpOm8ucHVzaCgoYS1oKmgvdCkvdCl9cmV0dXJuIG99ZnVuY3Rpb24gSHQobixlLHMpe2NvbnN0IHQ9bi5yb3dzLHI9bi5jb2x1bW5zLG89dCpyO2xldCBpPTAsaD0wLGE9MDtmb3IobGV0IGw9MDtsPHQ7bCsrKWZvcihsZXQgZz0wO2c8cjtnKyspYT1uLmdldChsLGcpLXMsaSs9YSxoKz1hKmE7cmV0dXJuIGU/KGgtaSppL28pLyhvLTEpOihoLWkqaS9vKS9vfWZ1bmN0aW9uIHRlKG4sZSl7Zm9yKGxldCBzPTA7czxuLnJvd3M7cysrKWZvcihsZXQgdD0wO3Q8bi5jb2x1bW5zO3QrKyluLnNldChzLHQsbi5nZXQocyx0KS1lW3NdKX1mdW5jdGlvbiBlZShuLGUpe2ZvcihsZXQgcz0wO3M8bi5yb3dzO3MrKylmb3IobGV0IHQ9MDt0PG4uY29sdW1uczt0Kyspbi5zZXQocyx0LG4uZ2V0KHMsdCktZVt0XSl9ZnVuY3Rpb24gc2UobixlKXtmb3IobGV0IHM9MDtzPG4ucm93cztzKyspZm9yKGxldCB0PTA7dDxuLmNvbHVtbnM7dCsrKW4uc2V0KHMsdCxuLmdldChzLHQpLWUpfWZ1bmN0aW9uIHJlKG4pe2NvbnN0IGU9W107Zm9yKGxldCBzPTA7czxuLnJvd3M7cysrKXtsZXQgdD0wO2ZvcihsZXQgcj0wO3I8bi5jb2x1bW5zO3IrKyl0Kz1NYXRoLnBvdyhuLmdldChzLHIpLDIpLyhuLmNvbHVtbnMtMSk7ZS5wdXNoKE1hdGguc3FydCh0KSl9cmV0dXJuIGV9ZnVuY3Rpb24gb2UobixlKXtmb3IobGV0IHM9MDtzPG4ucm93cztzKyspZm9yKGxldCB0PTA7dDxuLmNvbHVtbnM7dCsrKW4uc2V0KHMsdCxuLmdldChzLHQpL2Vbc10pfWZ1bmN0aW9uIG5lKG4pe2NvbnN0IGU9W107Zm9yKGxldCBzPTA7czxuLmNvbHVtbnM7cysrKXtsZXQgdD0wO2ZvcihsZXQgcj0wO3I8bi5yb3dzO3IrKyl0Kz1NYXRoLnBvdyhuLmdldChyLHMpLDIpLyhuLnJvd3MtMSk7ZS5wdXNoKE1hdGguc3FydCh0KSl9cmV0dXJuIGV9ZnVuY3Rpb24gaWUobixlKXtmb3IobGV0IHM9MDtzPG4ucm93cztzKyspZm9yKGxldCB0PTA7dDxuLmNvbHVtbnM7dCsrKW4uc2V0KHMsdCxuLmdldChzLHQpL2VbdF0pfWZ1bmN0aW9uIGxlKG4pe2NvbnN0IGU9bi5zaXplLTE7bGV0IHM9MDtmb3IobGV0IHQ9MDt0PG4uY29sdW1uczt0KyspZm9yKGxldCByPTA7cjxuLnJvd3M7cisrKXMrPU1hdGgucG93KG4uZ2V0KHIsdCksMikvZTtyZXR1cm4gTWF0aC5zcXJ0KHMpfWZ1bmN0aW9uIGhlKG4sZSl7Zm9yKGxldCBzPTA7czxuLnJvd3M7cysrKWZvcihsZXQgdD0wO3Q8bi5jb2x1bW5zO3QrKyluLnNldChzLHQsbi5nZXQocyx0KS9lKX1jbGFzcyBxe3N0YXRpYyBmcm9tMURBcnJheShlLHMsdCl7aWYoZSpzIT09dC5sZW5ndGgpdGhyb3cgbmV3IFJhbmdlRXJyb3IoImRhdGEgbGVuZ3RoIGRvZXMgbm90IG1hdGNoIGdpdmVuIGRpbWVuc2lvbnMiKTtsZXQgbz1uZXcgVChlLHMpO2ZvcihsZXQgaT0wO2k8ZTtpKyspZm9yKGxldCBoPTA7aDxzO2grKylvLnNldChpLGgsdFtpKnMraF0pO3JldHVybiBvfXN0YXRpYyByb3dWZWN0b3IoZSl7bGV0IHM9bmV3IFQoMSxlLmxlbmd0aCk7Zm9yKGxldCB0PTA7dDxlLmxlbmd0aDt0Kyspcy5zZXQoMCx0LGVbdF0pO3JldHVybiBzfXN0YXRpYyBjb2x1bW5WZWN0b3IoZSl7bGV0IHM9bmV3IFQoZS5sZW5ndGgsMSk7Zm9yKGxldCB0PTA7dDxlLmxlbmd0aDt0Kyspcy5zZXQodCwwLGVbdF0pO3JldHVybiBzfXN0YXRpYyB6ZXJvcyhlLHMpe3JldHVybiBuZXcgVChlLHMpfXN0YXRpYyBvbmVzKGUscyl7cmV0dXJuIG5ldyBUKGUscykuZmlsbCgxKX1zdGF0aWMgcmFuZChlLHMsdD17fSl7aWYodHlwZW9mIHQhPSJvYmplY3QiKXRocm93IG5ldyBUeXBlRXJyb3IoIm9wdGlvbnMgbXVzdCBiZSBhbiBvYmplY3QiKTtjb25zdHtyYW5kb206cj1NYXRoLnJhbmRvbX09dDtsZXQgbz1uZXcgVChlLHMpO2ZvcihsZXQgaT0wO2k8ZTtpKyspZm9yKGxldCBoPTA7aDxzO2grKylvLnNldChpLGgscigpKTtyZXR1cm4gb31zdGF0aWMgcmFuZEludChlLHMsdD17fSl7aWYodHlwZW9mIHQhPSJvYmplY3QiKXRocm93IG5ldyBUeXBlRXJyb3IoIm9wdGlvbnMgbXVzdCBiZSBhbiBvYmplY3QiKTtjb25zdHttaW46cj0wLG1heDpvPTFlMyxyYW5kb206aT1NYXRoLnJhbmRvbX09dDtpZighTnVtYmVyLmlzSW50ZWdlcihyKSl0aHJvdyBuZXcgVHlwZUVycm9yKCJtaW4gbXVzdCBiZSBhbiBpbnRlZ2VyIik7aWYoIU51bWJlci5pc0ludGVnZXIobykpdGhyb3cgbmV3IFR5cGVFcnJvcigibWF4IG11c3QgYmUgYW4gaW50ZWdlciIpO2lmKHI+PW8pdGhyb3cgbmV3IFJhbmdlRXJyb3IoIm1pbiBtdXN0IGJlIHNtYWxsZXIgdGhhbiBtYXgiKTtsZXQgaD1vLXIsYT1uZXcgVChlLHMpO2ZvcihsZXQgbD0wO2w8ZTtsKyspZm9yKGxldCBnPTA7ZzxzO2crKyl7bGV0IHU9citNYXRoLnJvdW5kKGkoKSpoKTthLnNldChsLGcsdSl9cmV0dXJuIGF9c3RhdGljIGV5ZShlLHMsdCl7cz09PXZvaWQgMCYmKHM9ZSksdD09PXZvaWQgMCYmKHQ9MSk7bGV0IHI9TWF0aC5taW4oZSxzKSxvPXRoaXMuemVyb3MoZSxzKTtmb3IobGV0IGk9MDtpPHI7aSsrKW8uc2V0KGksaSx0KTtyZXR1cm4gb31zdGF0aWMgZGlhZyhlLHMsdCl7bGV0IHI9ZS5sZW5ndGg7cz09PXZvaWQgMCYmKHM9ciksdD09PXZvaWQgMCYmKHQ9cyk7bGV0IG89TWF0aC5taW4ocixzLHQpLGk9dGhpcy56ZXJvcyhzLHQpO2ZvcihsZXQgaD0wO2g8bztoKyspaS5zZXQoaCxoLGVbaF0pO3JldHVybiBpfXN0YXRpYyBtaW4oZSxzKXtlPXRoaXMuY2hlY2tNYXRyaXgoZSkscz10aGlzLmNoZWNrTWF0cml4KHMpO2xldCB0PWUucm93cyxyPWUuY29sdW1ucyxvPW5ldyBUKHQscik7Zm9yKGxldCBpPTA7aTx0O2krKylmb3IobGV0IGg9MDtoPHI7aCsrKW8uc2V0KGksaCxNYXRoLm1pbihlLmdldChpLGgpLHMuZ2V0KGksaCkpKTtyZXR1cm4gb31zdGF0aWMgbWF4KGUscyl7ZT10aGlzLmNoZWNrTWF0cml4KGUpLHM9dGhpcy5jaGVja01hdHJpeChzKTtsZXQgdD1lLnJvd3Mscj1lLmNvbHVtbnMsbz1uZXcgdGhpcyh0LHIpO2ZvcihsZXQgaT0wO2k8dDtpKyspZm9yKGxldCBoPTA7aDxyO2grKylvLnNldChpLGgsTWF0aC5tYXgoZS5nZXQoaSxoKSxzLmdldChpLGgpKSk7cmV0dXJuIG99c3RhdGljIGNoZWNrTWF0cml4KGUpe3JldHVybiBxLmlzTWF0cml4KGUpP2U6bmV3IFQoZSl9c3RhdGljIGlzTWF0cml4KGUpe3JldHVybiBlIT1udWxsJiZlLmtsYXNzPT09Ik1hdHJpeCJ9Z2V0IHNpemUoKXtyZXR1cm4gdGhpcy5yb3dzKnRoaXMuY29sdW1uc31hcHBseShlKXtpZih0eXBlb2YgZSE9ImZ1bmN0aW9uIil0aHJvdyBuZXcgVHlwZUVycm9yKCJjYWxsYmFjayBtdXN0IGJlIGEgZnVuY3Rpb24iKTtmb3IobGV0IHM9MDtzPHRoaXMucm93cztzKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKWUuY2FsbCh0aGlzLHMsdCk7cmV0dXJuIHRoaXN9dG8xREFycmF5KCl7bGV0IGU9W107Zm9yKGxldCBzPTA7czx0aGlzLnJvd3M7cysrKWZvcihsZXQgdD0wO3Q8dGhpcy5jb2x1bW5zO3QrKyllLnB1c2godGhpcy5nZXQocyx0KSk7cmV0dXJuIGV9dG8yREFycmF5KCl7bGV0IGU9W107Zm9yKGxldCBzPTA7czx0aGlzLnJvd3M7cysrKXtlLnB1c2goW10pO2ZvcihsZXQgdD0wO3Q8dGhpcy5jb2x1bW5zO3QrKyllW3NdLnB1c2godGhpcy5nZXQocyx0KSl9cmV0dXJuIGV9dG9KU09OKCl7cmV0dXJuIHRoaXMudG8yREFycmF5KCl9aXNSb3dWZWN0b3IoKXtyZXR1cm4gdGhpcy5yb3dzPT09MX1pc0NvbHVtblZlY3Rvcigpe3JldHVybiB0aGlzLmNvbHVtbnM9PT0xfWlzVmVjdG9yKCl7cmV0dXJuIHRoaXMucm93cz09PTF8fHRoaXMuY29sdW1ucz09PTF9aXNTcXVhcmUoKXtyZXR1cm4gdGhpcy5yb3dzPT09dGhpcy5jb2x1bW5zfWlzRW1wdHkoKXtyZXR1cm4gdGhpcy5yb3dzPT09MHx8dGhpcy5jb2x1bW5zPT09MH1pc1N5bW1ldHJpYygpe2lmKHRoaXMuaXNTcXVhcmUoKSl7Zm9yKGxldCBlPTA7ZTx0aGlzLnJvd3M7ZSsrKWZvcihsZXQgcz0wO3M8PWU7cysrKWlmKHRoaXMuZ2V0KGUscykhPT10aGlzLmdldChzLGUpKXJldHVybiExO3JldHVybiEwfXJldHVybiExfWlzRWNoZWxvbkZvcm0oKXtsZXQgZT0wLHM9MCx0PS0xLHI9ITAsbz0hMTtmb3IoO2U8dGhpcy5yb3dzJiZyOyl7Zm9yKHM9MCxvPSExO3M8dGhpcy5jb2x1bW5zJiZvPT09ITE7KXRoaXMuZ2V0KGUscyk9PT0wP3MrKzp0aGlzLmdldChlLHMpPT09MSYmcz50PyhvPSEwLHQ9cyk6KHI9ITEsbz0hMCk7ZSsrfXJldHVybiByfWlzUmVkdWNlZEVjaGVsb25Gb3JtKCl7bGV0IGU9MCxzPTAsdD0tMSxyPSEwLG89ITE7Zm9yKDtlPHRoaXMucm93cyYmcjspe2ZvcihzPTAsbz0hMTtzPHRoaXMuY29sdW1ucyYmbz09PSExOyl0aGlzLmdldChlLHMpPT09MD9zKys6dGhpcy5nZXQoZSxzKT09PTEmJnM+dD8obz0hMCx0PXMpOihyPSExLG89ITApO2ZvcihsZXQgaT1zKzE7aTx0aGlzLnJvd3M7aSsrKXRoaXMuZ2V0KGUsaSkhPT0wJiYocj0hMSk7ZSsrfXJldHVybiByfWVjaGVsb25Gb3JtKCl7bGV0IGU9dGhpcy5jbG9uZSgpLHM9MCx0PTA7Zm9yKDtzPGUucm93cyYmdDxlLmNvbHVtbnM7KXtsZXQgcj1zO2ZvcihsZXQgbz1zO288ZS5yb3dzO28rKyllLmdldChvLHQpPmUuZ2V0KHIsdCkmJihyPW8pO2lmKGUuZ2V0KHIsdCk9PT0wKXQrKztlbHNle2Uuc3dhcFJvd3MocyxyKTtsZXQgbz1lLmdldChzLHQpO2ZvcihsZXQgaT10O2k8ZS5jb2x1bW5zO2krKyllLnNldChzLGksZS5nZXQocyxpKS9vKTtmb3IobGV0IGk9cysxO2k8ZS5yb3dzO2krKyl7bGV0IGg9ZS5nZXQoaSx0KS9lLmdldChzLHQpO2Uuc2V0KGksdCwwKTtmb3IobGV0IGE9dCsxO2E8ZS5jb2x1bW5zO2ErKyllLnNldChpLGEsZS5nZXQoaSxhKS1lLmdldChzLGEpKmgpfXMrKyx0Kyt9fXJldHVybiBlfXJlZHVjZWRFY2hlbG9uRm9ybSgpe2xldCBlPXRoaXMuZWNoZWxvbkZvcm0oKSxzPWUuY29sdW1ucyx0PWUucm93cyxyPXQtMTtmb3IoO3I+PTA7KWlmKGUubWF4Um93KHIpPT09MClyLS07ZWxzZXtsZXQgbz0wLGk9ITE7Zm9yKDtvPHQmJmk9PT0hMTspZS5nZXQocixvKT09PTE/aT0hMDpvKys7Zm9yKGxldCBoPTA7aDxyO2grKyl7bGV0IGE9ZS5nZXQoaCxvKTtmb3IobGV0IGw9bztsPHM7bCsrKXtsZXQgZz1lLmdldChoLGwpLWEqZS5nZXQocixsKTtlLnNldChoLGwsZyl9fXItLX1yZXR1cm4gZX1zZXQoKXt0aHJvdyBuZXcgRXJyb3IoInNldCBtZXRob2QgaXMgdW5pbXBsZW1lbnRlZCIpfWdldCgpe3Rocm93IG5ldyBFcnJvcigiZ2V0IG1ldGhvZCBpcyB1bmltcGxlbWVudGVkIil9cmVwZWF0KGU9e30pe2lmKHR5cGVvZiBlIT0ib2JqZWN0Iil0aHJvdyBuZXcgVHlwZUVycm9yKCJvcHRpb25zIG11c3QgYmUgYW4gb2JqZWN0Iik7Y29uc3R7cm93czpzPTEsY29sdW1uczp0PTF9PWU7aWYoIU51bWJlci5pc0ludGVnZXIocyl8fHM8PTApdGhyb3cgbmV3IFR5cGVFcnJvcigicm93cyBtdXN0IGJlIGEgcG9zaXRpdmUgaW50ZWdlciIpO2lmKCFOdW1iZXIuaXNJbnRlZ2VyKHQpfHx0PD0wKXRocm93IG5ldyBUeXBlRXJyb3IoImNvbHVtbnMgbXVzdCBiZSBhIHBvc2l0aXZlIGludGVnZXIiKTtsZXQgcj1uZXcgVCh0aGlzLnJvd3Mqcyx0aGlzLmNvbHVtbnMqdCk7Zm9yKGxldCBvPTA7bzxzO28rKylmb3IobGV0IGk9MDtpPHQ7aSsrKXIuc2V0U3ViTWF0cml4KHRoaXMsdGhpcy5yb3dzKm8sdGhpcy5jb2x1bW5zKmkpO3JldHVybiByfWZpbGwoZSl7Zm9yKGxldCBzPTA7czx0aGlzLnJvd3M7cysrKWZvcihsZXQgdD0wO3Q8dGhpcy5jb2x1bW5zO3QrKyl0aGlzLnNldChzLHQsZSk7cmV0dXJuIHRoaXN9bmVnKCl7cmV0dXJuIHRoaXMubXVsUygtMSl9Z2V0Um93KGUpe1codGhpcyxlKTtsZXQgcz1bXTtmb3IobGV0IHQ9MDt0PHRoaXMuY29sdW1uczt0Kyspcy5wdXNoKHRoaXMuZ2V0KGUsdCkpO3JldHVybiBzfWdldFJvd1ZlY3RvcihlKXtyZXR1cm4gVC5yb3dWZWN0b3IodGhpcy5nZXRSb3coZSkpfXNldFJvdyhlLHMpe1codGhpcyxlKSxzPUEodGhpcyxzKTtmb3IobGV0IHQ9MDt0PHRoaXMuY29sdW1uczt0KyspdGhpcy5zZXQoZSx0LHNbdF0pO3JldHVybiB0aGlzfXN3YXBSb3dzKGUscyl7Vyh0aGlzLGUpLFcodGhpcyxzKTtmb3IobGV0IHQ9MDt0PHRoaXMuY29sdW1uczt0Kyspe2xldCByPXRoaXMuZ2V0KGUsdCk7dGhpcy5zZXQoZSx0LHRoaXMuZ2V0KHMsdCkpLHRoaXMuc2V0KHMsdCxyKX1yZXR1cm4gdGhpc31nZXRDb2x1bW4oZSl7Sih0aGlzLGUpO2xldCBzPVtdO2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylzLnB1c2godGhpcy5nZXQodCxlKSk7cmV0dXJuIHN9Z2V0Q29sdW1uVmVjdG9yKGUpe3JldHVybiBULmNvbHVtblZlY3Rvcih0aGlzLmdldENvbHVtbihlKSl9c2V0Q29sdW1uKGUscyl7Sih0aGlzLGUpLHM9SCh0aGlzLHMpO2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKyl0aGlzLnNldCh0LGUsc1t0XSk7cmV0dXJuIHRoaXN9c3dhcENvbHVtbnMoZSxzKXtKKHRoaXMsZSksSih0aGlzLHMpO2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKyl7bGV0IHI9dGhpcy5nZXQodCxlKTt0aGlzLnNldCh0LGUsdGhpcy5nZXQodCxzKSksdGhpcy5zZXQodCxzLHIpfXJldHVybiB0aGlzfWFkZFJvd1ZlY3RvcihlKXtlPUEodGhpcyxlKTtmb3IobGV0IHM9MDtzPHRoaXMucm93cztzKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKXRoaXMuc2V0KHMsdCx0aGlzLmdldChzLHQpK2VbdF0pO3JldHVybiB0aGlzfXN1YlJvd1ZlY3RvcihlKXtlPUEodGhpcyxlKTtmb3IobGV0IHM9MDtzPHRoaXMucm93cztzKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKXRoaXMuc2V0KHMsdCx0aGlzLmdldChzLHQpLWVbdF0pO3JldHVybiB0aGlzfW11bFJvd1ZlY3RvcihlKXtlPUEodGhpcyxlKTtmb3IobGV0IHM9MDtzPHRoaXMucm93cztzKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKXRoaXMuc2V0KHMsdCx0aGlzLmdldChzLHQpKmVbdF0pO3JldHVybiB0aGlzfWRpdlJvd1ZlY3RvcihlKXtlPUEodGhpcyxlKTtmb3IobGV0IHM9MDtzPHRoaXMucm93cztzKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKXRoaXMuc2V0KHMsdCx0aGlzLmdldChzLHQpL2VbdF0pO3JldHVybiB0aGlzfWFkZENvbHVtblZlY3RvcihlKXtlPUgodGhpcyxlKTtmb3IobGV0IHM9MDtzPHRoaXMucm93cztzKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKXRoaXMuc2V0KHMsdCx0aGlzLmdldChzLHQpK2Vbc10pO3JldHVybiB0aGlzfXN1YkNvbHVtblZlY3RvcihlKXtlPUgodGhpcyxlKTtmb3IobGV0IHM9MDtzPHRoaXMucm93cztzKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKXRoaXMuc2V0KHMsdCx0aGlzLmdldChzLHQpLWVbc10pO3JldHVybiB0aGlzfW11bENvbHVtblZlY3RvcihlKXtlPUgodGhpcyxlKTtmb3IobGV0IHM9MDtzPHRoaXMucm93cztzKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKXRoaXMuc2V0KHMsdCx0aGlzLmdldChzLHQpKmVbc10pO3JldHVybiB0aGlzfWRpdkNvbHVtblZlY3RvcihlKXtlPUgodGhpcyxlKTtmb3IobGV0IHM9MDtzPHRoaXMucm93cztzKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKXRoaXMuc2V0KHMsdCx0aGlzLmdldChzLHQpL2Vbc10pO3JldHVybiB0aGlzfW11bFJvdyhlLHMpe1codGhpcyxlKTtmb3IobGV0IHQ9MDt0PHRoaXMuY29sdW1uczt0KyspdGhpcy5zZXQoZSx0LHRoaXMuZ2V0KGUsdCkqcyk7cmV0dXJuIHRoaXN9bXVsQ29sdW1uKGUscyl7Sih0aGlzLGUpO2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKyl0aGlzLnNldCh0LGUsdGhpcy5nZXQodCxlKSpzKTtyZXR1cm4gdGhpc31tYXgoKXtpZih0aGlzLmlzRW1wdHkoKSlyZXR1cm4gTmFOO2xldCBlPXRoaXMuZ2V0KDAsMCk7Zm9yKGxldCBzPTA7czx0aGlzLnJvd3M7cysrKWZvcihsZXQgdD0wO3Q8dGhpcy5jb2x1bW5zO3QrKyl0aGlzLmdldChzLHQpPmUmJihlPXRoaXMuZ2V0KHMsdCkpO3JldHVybiBlfW1heEluZGV4KCl7dHQodGhpcyk7bGV0IGU9dGhpcy5nZXQoMCwwKSxzPVswLDBdO2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5nZXQodCxyKT5lJiYoZT10aGlzLmdldCh0LHIpLHNbMF09dCxzWzFdPXIpO3JldHVybiBzfW1pbigpe2lmKHRoaXMuaXNFbXB0eSgpKXJldHVybiBOYU47bGV0IGU9dGhpcy5nZXQoMCwwKTtmb3IobGV0IHM9MDtzPHRoaXMucm93cztzKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKXRoaXMuZ2V0KHMsdCk8ZSYmKGU9dGhpcy5nZXQocyx0KSk7cmV0dXJuIGV9bWluSW5kZXgoKXt0dCh0aGlzKTtsZXQgZT10aGlzLmdldCgwLDApLHM9WzAsMF07Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLmdldCh0LHIpPGUmJihlPXRoaXMuZ2V0KHQsciksc1swXT10LHNbMV09cik7cmV0dXJuIHN9bWF4Um93KGUpe2lmKFcodGhpcyxlKSx0aGlzLmlzRW1wdHkoKSlyZXR1cm4gTmFOO2xldCBzPXRoaXMuZ2V0KGUsMCk7Zm9yKGxldCB0PTE7dDx0aGlzLmNvbHVtbnM7dCsrKXRoaXMuZ2V0KGUsdCk+cyYmKHM9dGhpcy5nZXQoZSx0KSk7cmV0dXJuIHN9bWF4Um93SW5kZXgoZSl7Vyh0aGlzLGUpLHR0KHRoaXMpO2xldCBzPXRoaXMuZ2V0KGUsMCksdD1bZSwwXTtmb3IobGV0IHI9MTtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5nZXQoZSxyKT5zJiYocz10aGlzLmdldChlLHIpLHRbMV09cik7cmV0dXJuIHR9bWluUm93KGUpe2lmKFcodGhpcyxlKSx0aGlzLmlzRW1wdHkoKSlyZXR1cm4gTmFOO2xldCBzPXRoaXMuZ2V0KGUsMCk7Zm9yKGxldCB0PTE7dDx0aGlzLmNvbHVtbnM7dCsrKXRoaXMuZ2V0KGUsdCk8cyYmKHM9dGhpcy5nZXQoZSx0KSk7cmV0dXJuIHN9bWluUm93SW5kZXgoZSl7Vyh0aGlzLGUpLHR0KHRoaXMpO2xldCBzPXRoaXMuZ2V0KGUsMCksdD1bZSwwXTtmb3IobGV0IHI9MTtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5nZXQoZSxyKTxzJiYocz10aGlzLmdldChlLHIpLHRbMV09cik7cmV0dXJuIHR9bWF4Q29sdW1uKGUpe2lmKEoodGhpcyxlKSx0aGlzLmlzRW1wdHkoKSlyZXR1cm4gTmFOO2xldCBzPXRoaXMuZ2V0KDAsZSk7Zm9yKGxldCB0PTE7dDx0aGlzLnJvd3M7dCsrKXRoaXMuZ2V0KHQsZSk+cyYmKHM9dGhpcy5nZXQodCxlKSk7cmV0dXJuIHN9bWF4Q29sdW1uSW5kZXgoZSl7Sih0aGlzLGUpLHR0KHRoaXMpO2xldCBzPXRoaXMuZ2V0KDAsZSksdD1bMCxlXTtmb3IobGV0IHI9MTtyPHRoaXMucm93cztyKyspdGhpcy5nZXQocixlKT5zJiYocz10aGlzLmdldChyLGUpLHRbMF09cik7cmV0dXJuIHR9bWluQ29sdW1uKGUpe2lmKEoodGhpcyxlKSx0aGlzLmlzRW1wdHkoKSlyZXR1cm4gTmFOO2xldCBzPXRoaXMuZ2V0KDAsZSk7Zm9yKGxldCB0PTE7dDx0aGlzLnJvd3M7dCsrKXRoaXMuZ2V0KHQsZSk8cyYmKHM9dGhpcy5nZXQodCxlKSk7cmV0dXJuIHN9bWluQ29sdW1uSW5kZXgoZSl7Sih0aGlzLGUpLHR0KHRoaXMpO2xldCBzPXRoaXMuZ2V0KDAsZSksdD1bMCxlXTtmb3IobGV0IHI9MTtyPHRoaXMucm93cztyKyspdGhpcy5nZXQocixlKTxzJiYocz10aGlzLmdldChyLGUpLHRbMF09cik7cmV0dXJuIHR9ZGlhZygpe2xldCBlPU1hdGgubWluKHRoaXMucm93cyx0aGlzLmNvbHVtbnMpLHM9W107Zm9yKGxldCB0PTA7dDxlO3QrKylzLnB1c2godGhpcy5nZXQodCx0KSk7cmV0dXJuIHN9bm9ybShlPSJmcm9iZW5pdXMiKXtsZXQgcz0wO2lmKGU9PT0ibWF4IilyZXR1cm4gdGhpcy5tYXgoKTtpZihlPT09ImZyb2Jlbml1cyIpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspcz1zK3RoaXMuZ2V0KHQscikqdGhpcy5nZXQodCxyKTtyZXR1cm4gTWF0aC5zcXJ0KHMpfWVsc2UgdGhyb3cgbmV3IFJhbmdlRXJyb3IoYHVua25vd24gbm9ybSB0eXBlOiAke2V9YCl9Y3VtdWxhdGl2ZVN1bSgpe2xldCBlPTA7Zm9yKGxldCBzPTA7czx0aGlzLnJvd3M7cysrKWZvcihsZXQgdD0wO3Q8dGhpcy5jb2x1bW5zO3QrKyllKz10aGlzLmdldChzLHQpLHRoaXMuc2V0KHMsdCxlKTtyZXR1cm4gdGhpc31kb3QoZSl7cS5pc01hdHJpeChlKSYmKGU9ZS50bzFEQXJyYXkoKSk7bGV0IHM9dGhpcy50bzFEQXJyYXkoKTtpZihzLmxlbmd0aCE9PWUubGVuZ3RoKXRocm93IG5ldyBSYW5nZUVycm9yKCJ2ZWN0b3JzIGRvIG5vdCBoYXZlIHRoZSBzYW1lIHNpemUiKTtsZXQgdD0wO2ZvcihsZXQgcj0wO3I8cy5sZW5ndGg7cisrKXQrPXNbcl0qZVtyXTtyZXR1cm4gdH1tbXVsKGUpe2U9VC5jaGVja01hdHJpeChlKTtsZXQgcz10aGlzLnJvd3MsdD10aGlzLmNvbHVtbnMscj1lLmNvbHVtbnMsbz1uZXcgVChzLHIpLGk9bmV3IEZsb2F0NjRBcnJheSh0KTtmb3IobGV0IGg9MDtoPHI7aCsrKXtmb3IobGV0IGE9MDthPHQ7YSsrKWlbYV09ZS5nZXQoYSxoKTtmb3IobGV0IGE9MDthPHM7YSsrKXtsZXQgbD0wO2ZvcihsZXQgZz0wO2c8dDtnKyspbCs9dGhpcy5nZXQoYSxnKSppW2ddO28uc2V0KGEsaCxsKX19cmV0dXJuIG99c3RyYXNzZW4yeDIoZSl7ZT1ULmNoZWNrTWF0cml4KGUpO2xldCBzPW5ldyBUKDIsMik7Y29uc3QgdD10aGlzLmdldCgwLDApLHI9ZS5nZXQoMCwwKSxvPXRoaXMuZ2V0KDAsMSksaT1lLmdldCgwLDEpLGg9dGhpcy5nZXQoMSwwKSxhPWUuZ2V0KDEsMCksbD10aGlzLmdldCgxLDEpLGc9ZS5nZXQoMSwxKSx1PSh0K2wpKihyK2cpLHA9KGgrbCkqcix5PXQqKGktZyksbT1sKihhLXIpLHc9KHQrbykqZyx2PShoLXQpKihyK2kpLGY9KG8tbCkqKGErZyksTT11K20tdytmLGI9eSt3LGo9cCttLFI9dS1wK3krdjtyZXR1cm4gcy5zZXQoMCwwLE0pLHMuc2V0KDAsMSxiKSxzLnNldCgxLDAsaikscy5zZXQoMSwxLFIpLHN9c3RyYXNzZW4zeDMoZSl7ZT1ULmNoZWNrTWF0cml4KGUpO2xldCBzPW5ldyBUKDMsMyk7Y29uc3QgdD10aGlzLmdldCgwLDApLHI9dGhpcy5nZXQoMCwxKSxvPXRoaXMuZ2V0KDAsMiksaT10aGlzLmdldCgxLDApLGg9dGhpcy5nZXQoMSwxKSxhPXRoaXMuZ2V0KDEsMiksbD10aGlzLmdldCgyLDApLGc9dGhpcy5nZXQoMiwxKSx1PXRoaXMuZ2V0KDIsMikscD1lLmdldCgwLDApLHk9ZS5nZXQoMCwxKSxtPWUuZ2V0KDAsMiksdz1lLmdldCgxLDApLHY9ZS5nZXQoMSwxKSxmPWUuZ2V0KDEsMiksTT1lLmdldCgyLDApLGI9ZS5nZXQoMiwxKSxqPWUuZ2V0KDIsMiksUj0odCtyK28taS1oLWctdSkqdixGPSh0LWkpKigteSt2KSxrPWgqKC1wK3krdy12LWYtTStqKSxOPSgtdCtpK2gpKihwLXkrdiksST0oaStoKSooLXAreSksYz10KnAsZD0oLXQrbCtnKSoocC1tK2YpLEU9KC10K2wpKihtLWYpLFM9KGwrZykqKC1wK20pLFA9KHQrcitvLWgtYS1sLWcpKmYsQz1nKigtcCttK3ctdi1mLU0rYiksej0oLW8rZyt1KSooditNLWIpLEw9KG8tdSkqKHYtYiksVT1vKk0sQj0oZyt1KSooLU0rYiksRD0oLW8raCthKSooZitNLWopLFk9KG8tYSkqKGYtaiksXz0oaCthKSooLU0raiksJD1yKncsTz1hKmIsWD1pKm0sWj1sKnksVj11KmosdHM9YytVKyQsZXM9UitOK0krYyt6K1UrQixzcz1jK2QrUytQK1UrRCtfLHJzPUYraytOK2MrVStEK1ksb3M9RitOK0krYytPLG5zPVUrRCtZK18rWCxpcz1jK2QrRStDK3orTCtVLGxzPXorTCtVK0IrWixocz1jK2QrRStTK1Y7cmV0dXJuIHMuc2V0KDAsMCx0cykscy5zZXQoMCwxLGVzKSxzLnNldCgwLDIsc3MpLHMuc2V0KDEsMCxycykscy5zZXQoMSwxLG9zKSxzLnNldCgxLDIsbnMpLHMuc2V0KDIsMCxpcykscy5zZXQoMiwxLGxzKSxzLnNldCgyLDIsaHMpLHN9bW11bFN0cmFzc2VuKGUpe2U9VC5jaGVja01hdHJpeChlKTtsZXQgcz10aGlzLmNsb25lKCksdD1zLnJvd3Mscj1zLmNvbHVtbnMsbz1lLnJvd3MsaT1lLmNvbHVtbnM7ciE9PW8mJmNvbnNvbGUud2FybihgTXVsdGlwbHlpbmcgJHt0fSB4ICR7cn0gYW5kICR7b30geCAke2l9IG1hdHJpeDogZGltZW5zaW9ucyBkbyBub3QgbWF0Y2guYCk7ZnVuY3Rpb24gaCh1LHAseSl7bGV0IG09dS5yb3dzLHc9dS5jb2x1bW5zO2lmKG09PT1wJiZ3PT09eSlyZXR1cm4gdTt7bGV0IHY9cS56ZXJvcyhwLHkpO3JldHVybiB2PXYuc2V0U3ViTWF0cml4KHUsMCwwKSx2fX1sZXQgYT1NYXRoLm1heCh0LG8pLGw9TWF0aC5tYXgocixpKTtzPWgocyxhLGwpLGU9aChlLGEsbCk7ZnVuY3Rpb24gZyh1LHAseSxtKXtpZih5PD01MTJ8fG08PTUxMilyZXR1cm4gdS5tbXVsKHApO3klMj09MSYmbSUyPT0xPyh1PWgodSx5KzEsbSsxKSxwPWgocCx5KzEsbSsxKSk6eSUyPT0xPyh1PWgodSx5KzEsbSkscD1oKHAseSsxLG0pKTptJTI9PTEmJih1PWgodSx5LG0rMSkscD1oKHAseSxtKzEpKTtsZXQgdz1wYXJzZUludCh1LnJvd3MvMiwxMCksdj1wYXJzZUludCh1LmNvbHVtbnMvMiwxMCksZj11LnN1Yk1hdHJpeCgwLHctMSwwLHYtMSksTT1wLnN1Yk1hdHJpeCgwLHctMSwwLHYtMSksYj11LnN1Yk1hdHJpeCgwLHctMSx2LHUuY29sdW1ucy0xKSxqPXAuc3ViTWF0cml4KDAsdy0xLHYscC5jb2x1bW5zLTEpLFI9dS5zdWJNYXRyaXgodyx1LnJvd3MtMSwwLHYtMSksRj1wLnN1Yk1hdHJpeCh3LHAucm93cy0xLDAsdi0xKSxrPXUuc3ViTWF0cml4KHcsdS5yb3dzLTEsdix1LmNvbHVtbnMtMSksTj1wLnN1Yk1hdHJpeCh3LHAucm93cy0xLHYscC5jb2x1bW5zLTEpLEk9ZyhxLmFkZChmLGspLHEuYWRkKE0sTiksdyx2KSxjPWcocS5hZGQoUixrKSxNLHcsdiksZD1nKGYscS5zdWIoaixOKSx3LHYpLEU9ZyhrLHEuc3ViKEYsTSksdyx2KSxTPWcocS5hZGQoZixiKSxOLHcsdiksUD1nKHEuc3ViKFIsZikscS5hZGQoTSxqKSx3LHYpLEM9ZyhxLnN1YihiLGspLHEuYWRkKEYsTiksdyx2KSx6PXEuYWRkKEksRSk7ei5zdWIoUyksei5hZGQoQyk7bGV0IEw9cS5hZGQoZCxTKSxVPXEuYWRkKGMsRSksQj1xLnN1YihJLGMpO0IuYWRkKGQpLEIuYWRkKFApO2xldCBEPXEuemVyb3MoMip6LnJvd3MsMip6LmNvbHVtbnMpO3JldHVybiBEPUQuc2V0U3ViTWF0cml4KHosMCwwKSxEPUQuc2V0U3ViTWF0cml4KEwsei5yb3dzLDApLEQ9RC5zZXRTdWJNYXRyaXgoVSwwLHouY29sdW1ucyksRD1ELnNldFN1Yk1hdHJpeChCLHoucm93cyx6LmNvbHVtbnMpLEQuc3ViTWF0cml4KDAseS0xLDAsbS0xKX1yZXR1cm4gZyhzLGUsYSxsKX1zY2FsZVJvd3MoZT17fSl7aWYodHlwZW9mIGUhPSJvYmplY3QiKXRocm93IG5ldyBUeXBlRXJyb3IoIm9wdGlvbnMgbXVzdCBiZSBhbiBvYmplY3QiKTtjb25zdHttaW46cz0wLG1heDp0PTF9PWU7aWYoIU51bWJlci5pc0Zpbml0ZShzKSl0aHJvdyBuZXcgVHlwZUVycm9yKCJtaW4gbXVzdCBiZSBhIG51bWJlciIpO2lmKCFOdW1iZXIuaXNGaW5pdGUodCkpdGhyb3cgbmV3IFR5cGVFcnJvcigibWF4IG11c3QgYmUgYSBudW1iZXIiKTtpZihzPj10KXRocm93IG5ldyBSYW5nZUVycm9yKCJtaW4gbXVzdCBiZSBzbWFsbGVyIHRoYW4gbWF4Iik7bGV0IHI9bmV3IFQodGhpcy5yb3dzLHRoaXMuY29sdW1ucyk7Zm9yKGxldCBvPTA7bzx0aGlzLnJvd3M7bysrKXtjb25zdCBpPXRoaXMuZ2V0Um93KG8pO2kubGVuZ3RoPjAmJmR0KGkse21pbjpzLG1heDp0LG91dHB1dDppfSksci5zZXRSb3cobyxpKX1yZXR1cm4gcn1zY2FsZUNvbHVtbnMoZT17fSl7aWYodHlwZW9mIGUhPSJvYmplY3QiKXRocm93IG5ldyBUeXBlRXJyb3IoIm9wdGlvbnMgbXVzdCBiZSBhbiBvYmplY3QiKTtjb25zdHttaW46cz0wLG1heDp0PTF9PWU7aWYoIU51bWJlci5pc0Zpbml0ZShzKSl0aHJvdyBuZXcgVHlwZUVycm9yKCJtaW4gbXVzdCBiZSBhIG51bWJlciIpO2lmKCFOdW1iZXIuaXNGaW5pdGUodCkpdGhyb3cgbmV3IFR5cGVFcnJvcigibWF4IG11c3QgYmUgYSBudW1iZXIiKTtpZihzPj10KXRocm93IG5ldyBSYW5nZUVycm9yKCJtaW4gbXVzdCBiZSBzbWFsbGVyIHRoYW4gbWF4Iik7bGV0IHI9bmV3IFQodGhpcy5yb3dzLHRoaXMuY29sdW1ucyk7Zm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXtjb25zdCBpPXRoaXMuZ2V0Q29sdW1uKG8pO2kubGVuZ3RoJiZkdChpLHttaW46cyxtYXg6dCxvdXRwdXQ6aX0pLHIuc2V0Q29sdW1uKG8saSl9cmV0dXJuIHJ9ZmxpcFJvd3MoKXtjb25zdCBlPU1hdGguY2VpbCh0aGlzLmNvbHVtbnMvMik7Zm9yKGxldCBzPTA7czx0aGlzLnJvd3M7cysrKWZvcihsZXQgdD0wO3Q8ZTt0Kyspe2xldCByPXRoaXMuZ2V0KHMsdCksbz10aGlzLmdldChzLHRoaXMuY29sdW1ucy0xLXQpO3RoaXMuc2V0KHMsdCxvKSx0aGlzLnNldChzLHRoaXMuY29sdW1ucy0xLXQscil9cmV0dXJuIHRoaXN9ZmxpcENvbHVtbnMoKXtjb25zdCBlPU1hdGguY2VpbCh0aGlzLnJvd3MvMik7Zm9yKGxldCBzPTA7czx0aGlzLmNvbHVtbnM7cysrKWZvcihsZXQgdD0wO3Q8ZTt0Kyspe2xldCByPXRoaXMuZ2V0KHQscyksbz10aGlzLmdldCh0aGlzLnJvd3MtMS10LHMpO3RoaXMuc2V0KHQscyxvKSx0aGlzLnNldCh0aGlzLnJvd3MtMS10LHMscil9cmV0dXJuIHRoaXN9a3JvbmVja2VyUHJvZHVjdChlKXtlPVQuY2hlY2tNYXRyaXgoZSk7bGV0IHM9dGhpcy5yb3dzLHQ9dGhpcy5jb2x1bW5zLHI9ZS5yb3dzLG89ZS5jb2x1bW5zLGk9bmV3IFQocypyLHQqbyk7Zm9yKGxldCBoPTA7aDxzO2grKylmb3IobGV0IGE9MDthPHQ7YSsrKWZvcihsZXQgbD0wO2w8cjtsKyspZm9yKGxldCBnPTA7ZzxvO2crKylpLnNldChyKmgrbCxvKmErZyx0aGlzLmdldChoLGEpKmUuZ2V0KGwsZykpO3JldHVybiBpfWtyb25lY2tlclN1bShlKXtpZihlPVQuY2hlY2tNYXRyaXgoZSksIXRoaXMuaXNTcXVhcmUoKXx8IWUuaXNTcXVhcmUoKSl0aHJvdyBuZXcgRXJyb3IoIktyb25lY2tlciBTdW0gbmVlZHMgdHdvIFNxdWFyZSBNYXRyaWNlcyIpO2xldCBzPXRoaXMucm93cyx0PWUucm93cyxyPXRoaXMua3JvbmVja2VyUHJvZHVjdChULmV5ZSh0LHQpKSxvPVQuZXllKHMscykua3JvbmVja2VyUHJvZHVjdChlKTtyZXR1cm4gci5hZGQobyl9dHJhbnNwb3NlKCl7bGV0IGU9bmV3IFQodGhpcy5jb2x1bW5zLHRoaXMucm93cyk7Zm9yKGxldCBzPTA7czx0aGlzLnJvd3M7cysrKWZvcihsZXQgdD0wO3Q8dGhpcy5jb2x1bW5zO3QrKyllLnNldCh0LHMsdGhpcy5nZXQocyx0KSk7cmV0dXJuIGV9c29ydFJvd3MoZT1TdCl7Zm9yKGxldCBzPTA7czx0aGlzLnJvd3M7cysrKXRoaXMuc2V0Um93KHMsdGhpcy5nZXRSb3cocykuc29ydChlKSk7cmV0dXJuIHRoaXN9c29ydENvbHVtbnMoZT1TdCl7Zm9yKGxldCBzPTA7czx0aGlzLmNvbHVtbnM7cysrKXRoaXMuc2V0Q29sdW1uKHMsdGhpcy5nZXRDb2x1bW4ocykuc29ydChlKSk7cmV0dXJuIHRoaXN9c3ViTWF0cml4KGUscyx0LHIpe010KHRoaXMsZSxzLHQscik7bGV0IG89bmV3IFQocy1lKzEsci10KzEpO2ZvcihsZXQgaT1lO2k8PXM7aSsrKWZvcihsZXQgaD10O2g8PXI7aCsrKW8uc2V0KGktZSxoLXQsdGhpcy5nZXQoaSxoKSk7cmV0dXJuIG99c3ViTWF0cml4Um93KGUscyx0KXtpZihzPT09dm9pZCAwJiYocz0wKSx0PT09dm9pZCAwJiYodD10aGlzLmNvbHVtbnMtMSkscz50fHxzPDB8fHM+PXRoaXMuY29sdW1uc3x8dDwwfHx0Pj10aGlzLmNvbHVtbnMpdGhyb3cgbmV3IFJhbmdlRXJyb3IoIkFyZ3VtZW50IG91dCBvZiByYW5nZSIpO2xldCByPW5ldyBUKGUubGVuZ3RoLHQtcysxKTtmb3IobGV0IG89MDtvPGUubGVuZ3RoO28rKylmb3IobGV0IGk9cztpPD10O2krKyl7aWYoZVtvXTwwfHxlW29dPj10aGlzLnJvd3MpdGhyb3cgbmV3IFJhbmdlRXJyb3IoYFJvdyBpbmRleCBvdXQgb2YgcmFuZ2U6ICR7ZVtvXX1gKTtyLnNldChvLGktcyx0aGlzLmdldChlW29dLGkpKX1yZXR1cm4gcn1zdWJNYXRyaXhDb2x1bW4oZSxzLHQpe2lmKHM9PT12b2lkIDAmJihzPTApLHQ9PT12b2lkIDAmJih0PXRoaXMucm93cy0xKSxzPnR8fHM8MHx8cz49dGhpcy5yb3dzfHx0PDB8fHQ+PXRoaXMucm93cyl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiQXJndW1lbnQgb3V0IG9mIHJhbmdlIik7bGV0IHI9bmV3IFQodC1zKzEsZS5sZW5ndGgpO2ZvcihsZXQgbz0wO288ZS5sZW5ndGg7bysrKWZvcihsZXQgaT1zO2k8PXQ7aSsrKXtpZihlW29dPDB8fGVbb10+PXRoaXMuY29sdW1ucyl0aHJvdyBuZXcgUmFuZ2VFcnJvcihgQ29sdW1uIGluZGV4IG91dCBvZiByYW5nZTogJHtlW29dfWApO3Iuc2V0KGktcyxvLHRoaXMuZ2V0KGksZVtvXSkpfXJldHVybiByfXNldFN1Yk1hdHJpeChlLHMsdCl7aWYoZT1ULmNoZWNrTWF0cml4KGUpLGUuaXNFbXB0eSgpKXJldHVybiB0aGlzO2xldCByPXMrZS5yb3dzLTEsbz10K2UuY29sdW1ucy0xO010KHRoaXMscyxyLHQsbyk7Zm9yKGxldCBpPTA7aTxlLnJvd3M7aSsrKWZvcihsZXQgaD0wO2g8ZS5jb2x1bW5zO2grKyl0aGlzLnNldChzK2ksdCtoLGUuZ2V0KGksaCkpO3JldHVybiB0aGlzfXNlbGVjdGlvbihlLHMpe2xldCB0PVl0KHRoaXMsZSxzKSxyPW5ldyBUKGUubGVuZ3RoLHMubGVuZ3RoKTtmb3IobGV0IG89MDtvPHQucm93Lmxlbmd0aDtvKyspe2xldCBpPXQucm93W29dO2ZvcihsZXQgaD0wO2g8dC5jb2x1bW4ubGVuZ3RoO2grKyl7bGV0IGE9dC5jb2x1bW5baF07ci5zZXQobyxoLHRoaXMuZ2V0KGksYSkpfX1yZXR1cm4gcn10cmFjZSgpe2xldCBlPU1hdGgubWluKHRoaXMucm93cyx0aGlzLmNvbHVtbnMpLHM9MDtmb3IobGV0IHQ9MDt0PGU7dCsrKXMrPXRoaXMuZ2V0KHQsdCk7cmV0dXJuIHN9Y2xvbmUoKXtsZXQgZT1uZXcgVCh0aGlzLnJvd3MsdGhpcy5jb2x1bW5zKTtmb3IobGV0IHM9MDtzPHRoaXMucm93cztzKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKWUuc2V0KHMsdCx0aGlzLmdldChzLHQpKTtyZXR1cm4gZX1zdW0oZSl7c3dpdGNoKGUpe2Nhc2Uicm93IjpyZXR1cm4gWnQodGhpcyk7Y2FzZSJjb2x1bW4iOnJldHVybiBHdCh0aGlzKTtjYXNlIHZvaWQgMDpyZXR1cm4gV3QodGhpcyk7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoYGludmFsaWQgb3B0aW9uOiAke2V9YCl9fXByb2R1Y3QoZSl7c3dpdGNoKGUpe2Nhc2Uicm93IjpyZXR1cm4gSnQodGhpcyk7Y2FzZSJjb2x1bW4iOnJldHVybiBRdCh0aGlzKTtjYXNlIHZvaWQgMDpyZXR1cm4gS3QodGhpcyk7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoYGludmFsaWQgb3B0aW9uOiAke2V9YCl9fW1lYW4oZSl7Y29uc3Qgcz10aGlzLnN1bShlKTtzd2l0Y2goZSl7Y2FzZSJyb3ciOntmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0Kyspc1t0XS89dGhpcy5jb2x1bW5zO3JldHVybiBzfWNhc2UiY29sdW1uIjp7Zm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKXNbdF0vPXRoaXMucm93cztyZXR1cm4gc31jYXNlIHZvaWQgMDpyZXR1cm4gcy90aGlzLnNpemU7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoYGludmFsaWQgb3B0aW9uOiAke2V9YCl9fXZhcmlhbmNlKGUscz17fSl7aWYodHlwZW9mIGU9PSJvYmplY3QiJiYocz1lLGU9dm9pZCAwKSx0eXBlb2YgcyE9Im9iamVjdCIpdGhyb3cgbmV3IFR5cGVFcnJvcigib3B0aW9ucyBtdXN0IGJlIGFuIG9iamVjdCIpO2NvbnN0e3VuYmlhc2VkOnQ9ITAsbWVhbjpyPXRoaXMubWVhbihlKX09cztpZih0eXBlb2YgdCE9ImJvb2xlYW4iKXRocm93IG5ldyBUeXBlRXJyb3IoInVuYmlhc2VkIG11c3QgYmUgYSBib29sZWFuIik7c3dpdGNoKGUpe2Nhc2Uicm93Ijp7aWYoIUFycmF5LmlzQXJyYXkocikpdGhyb3cgbmV3IFR5cGVFcnJvcigibWVhbiBtdXN0IGJlIGFuIGFycmF5Iik7cmV0dXJuIHh0KHRoaXMsdCxyKX1jYXNlImNvbHVtbiI6e2lmKCFBcnJheS5pc0FycmF5KHIpKXRocm93IG5ldyBUeXBlRXJyb3IoIm1lYW4gbXVzdCBiZSBhbiBhcnJheSIpO3JldHVybiBBdCh0aGlzLHQscil9Y2FzZSB2b2lkIDA6e2lmKHR5cGVvZiByIT0ibnVtYmVyIil0aHJvdyBuZXcgVHlwZUVycm9yKCJtZWFuIG11c3QgYmUgYSBudW1iZXIiKTtyZXR1cm4gSHQodGhpcyx0LHIpfWRlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKGBpbnZhbGlkIG9wdGlvbjogJHtlfWApfX1zdGFuZGFyZERldmlhdGlvbihlLHMpe3R5cGVvZiBlPT0ib2JqZWN0IiYmKHM9ZSxlPXZvaWQgMCk7Y29uc3QgdD10aGlzLnZhcmlhbmNlKGUscyk7aWYoZT09PXZvaWQgMClyZXR1cm4gTWF0aC5zcXJ0KHQpO2ZvcihsZXQgcj0wO3I8dC5sZW5ndGg7cisrKXRbcl09TWF0aC5zcXJ0KHRbcl0pO3JldHVybiB0fWNlbnRlcihlLHM9e30pe2lmKHR5cGVvZiBlPT0ib2JqZWN0IiYmKHM9ZSxlPXZvaWQgMCksdHlwZW9mIHMhPSJvYmplY3QiKXRocm93IG5ldyBUeXBlRXJyb3IoIm9wdGlvbnMgbXVzdCBiZSBhbiBvYmplY3QiKTtjb25zdHtjZW50ZXI6dD10aGlzLm1lYW4oZSl9PXM7c3dpdGNoKGUpe2Nhc2Uicm93Ijp7aWYoIUFycmF5LmlzQXJyYXkodCkpdGhyb3cgbmV3IFR5cGVFcnJvcigiY2VudGVyIG11c3QgYmUgYW4gYXJyYXkiKTtyZXR1cm4gdGUodGhpcyx0KSx0aGlzfWNhc2UiY29sdW1uIjp7aWYoIUFycmF5LmlzQXJyYXkodCkpdGhyb3cgbmV3IFR5cGVFcnJvcigiY2VudGVyIG11c3QgYmUgYW4gYXJyYXkiKTtyZXR1cm4gZWUodGhpcyx0KSx0aGlzfWNhc2Ugdm9pZCAwOntpZih0eXBlb2YgdCE9Im51bWJlciIpdGhyb3cgbmV3IFR5cGVFcnJvcigiY2VudGVyIG11c3QgYmUgYSBudW1iZXIiKTtyZXR1cm4gc2UodGhpcyx0KSx0aGlzfWRlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKGBpbnZhbGlkIG9wdGlvbjogJHtlfWApfX1zY2FsZShlLHM9e30pe2lmKHR5cGVvZiBlPT0ib2JqZWN0IiYmKHM9ZSxlPXZvaWQgMCksdHlwZW9mIHMhPSJvYmplY3QiKXRocm93IG5ldyBUeXBlRXJyb3IoIm9wdGlvbnMgbXVzdCBiZSBhbiBvYmplY3QiKTtsZXQgdD1zLnNjYWxlO3N3aXRjaChlKXtjYXNlInJvdyI6e2lmKHQ9PT12b2lkIDApdD1yZSh0aGlzKTtlbHNlIGlmKCFBcnJheS5pc0FycmF5KHQpKXRocm93IG5ldyBUeXBlRXJyb3IoInNjYWxlIG11c3QgYmUgYW4gYXJyYXkiKTtyZXR1cm4gb2UodGhpcyx0KSx0aGlzfWNhc2UiY29sdW1uIjp7aWYodD09PXZvaWQgMCl0PW5lKHRoaXMpO2Vsc2UgaWYoIUFycmF5LmlzQXJyYXkodCkpdGhyb3cgbmV3IFR5cGVFcnJvcigic2NhbGUgbXVzdCBiZSBhbiBhcnJheSIpO3JldHVybiBpZSh0aGlzLHQpLHRoaXN9Y2FzZSB2b2lkIDA6e2lmKHQ9PT12b2lkIDApdD1sZSh0aGlzKTtlbHNlIGlmKHR5cGVvZiB0IT0ibnVtYmVyIil0aHJvdyBuZXcgVHlwZUVycm9yKCJzY2FsZSBtdXN0IGJlIGEgbnVtYmVyIik7cmV0dXJuIGhlKHRoaXMsdCksdGhpc31kZWZhdWx0OnRocm93IG5ldyBFcnJvcihgaW52YWxpZCBvcHRpb246ICR7ZX1gKX19dG9TdHJpbmcoZSl7cmV0dXJuIHZ0KHRoaXMsZSl9fXEucHJvdG90eXBlLmtsYXNzPSJNYXRyaXgiLHR5cGVvZiBTeW1ib2whPSJ1bmRlZmluZWQiJiYocS5wcm90b3R5cGVbU3ltYm9sLmZvcigibm9kZWpzLnV0aWwuaW5zcGVjdC5jdXN0b20iKV09VXQpO2Z1bmN0aW9uIFN0KG4sZSl7cmV0dXJuIG4tZX1xLnJhbmRvbT1xLnJhbmQscS5yYW5kb21JbnQ9cS5yYW5kSW50LHEuZGlhZ29uYWw9cS5kaWFnLHEucHJvdG90eXBlLmRpYWdvbmFsPXEucHJvdG90eXBlLmRpYWcscS5pZGVudGl0eT1xLmV5ZSxxLnByb3RvdHlwZS5uZWdhdGU9cS5wcm90b3R5cGUubmVnLHEucHJvdG90eXBlLnRlbnNvclByb2R1Y3Q9cS5wcm90b3R5cGUua3JvbmVja2VyUHJvZHVjdDtjbGFzcyBUIGV4dGVuZHMgcXtjb25zdHJ1Y3RvcihlLHMpe3N1cGVyKCk7aWYoVC5pc01hdHJpeChlKSlyZXR1cm4gZS5jbG9uZSgpO2lmKE51bWJlci5pc0ludGVnZXIoZSkmJmU+PTApaWYodGhpcy5kYXRhPVtdLE51bWJlci5pc0ludGVnZXIocykmJnM+PTApZm9yKGxldCB0PTA7dDxlO3QrKyl0aGlzLmRhdGEucHVzaChuZXcgRmxvYXQ2NEFycmF5KHMpKTtlbHNlIHRocm93IG5ldyBUeXBlRXJyb3IoIm5Db2x1bW5zIG11c3QgYmUgYSBwb3NpdGl2ZSBpbnRlZ2VyIik7ZWxzZSBpZihBcnJheS5pc0FycmF5KGUpKXtjb25zdCB0PWU7aWYoZT10Lmxlbmd0aCxzPWU/dFswXS5sZW5ndGg6MCx0eXBlb2YgcyE9Im51bWJlciIpdGhyb3cgbmV3IFR5cGVFcnJvcigiRGF0YSBtdXN0IGJlIGEgMkQgYXJyYXkgd2l0aCBhdCBsZWFzdCBvbmUgZWxlbWVudCIpO3RoaXMuZGF0YT1bXTtmb3IobGV0IHI9MDtyPGU7cisrKXtpZih0W3JdLmxlbmd0aCE9PXMpdGhyb3cgbmV3IFJhbmdlRXJyb3IoIkluY29uc2lzdGVudCBhcnJheSBkaW1lbnNpb25zIik7dGhpcy5kYXRhLnB1c2goRmxvYXQ2NEFycmF5LmZyb20odFtyXSkpfX1lbHNlIHRocm93IG5ldyBUeXBlRXJyb3IoIkZpcnN0IGFyZ3VtZW50IG11c3QgYmUgYSBwb3NpdGl2ZSBudW1iZXIgb3IgYW4gYXJyYXkiKTt0aGlzLnJvd3M9ZSx0aGlzLmNvbHVtbnM9c31zZXQoZSxzLHQpe3JldHVybiB0aGlzLmRhdGFbZV1bc109dCx0aGlzfWdldChlLHMpe3JldHVybiB0aGlzLmRhdGFbZV1bc119cmVtb3ZlUm93KGUpe3JldHVybiBXKHRoaXMsZSksdGhpcy5kYXRhLnNwbGljZShlLDEpLHRoaXMucm93cy09MSx0aGlzfWFkZFJvdyhlLHMpe3JldHVybiBzPT09dm9pZCAwJiYocz1lLGU9dGhpcy5yb3dzKSxXKHRoaXMsZSwhMCkscz1GbG9hdDY0QXJyYXkuZnJvbShBKHRoaXMscykpLHRoaXMuZGF0YS5zcGxpY2UoZSwwLHMpLHRoaXMucm93cys9MSx0aGlzfXJlbW92ZUNvbHVtbihlKXtKKHRoaXMsZSk7Zm9yKGxldCBzPTA7czx0aGlzLnJvd3M7cysrKXtjb25zdCB0PW5ldyBGbG9hdDY0QXJyYXkodGhpcy5jb2x1bW5zLTEpO2ZvcihsZXQgcj0wO3I8ZTtyKyspdFtyXT10aGlzLmRhdGFbc11bcl07Zm9yKGxldCByPWUrMTtyPHRoaXMuY29sdW1ucztyKyspdFtyLTFdPXRoaXMuZGF0YVtzXVtyXTt0aGlzLmRhdGFbc109dH1yZXR1cm4gdGhpcy5jb2x1bW5zLT0xLHRoaXN9YWRkQ29sdW1uKGUscyl7dHlwZW9mIHM9PSJ1bmRlZmluZWQiJiYocz1lLGU9dGhpcy5jb2x1bW5zKSxKKHRoaXMsZSwhMCkscz1IKHRoaXMscyk7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKXtjb25zdCByPW5ldyBGbG9hdDY0QXJyYXkodGhpcy5jb2x1bW5zKzEpO2xldCBvPTA7Zm9yKDtvPGU7bysrKXJbb109dGhpcy5kYXRhW3RdW29dO2ZvcihyW28rK109c1t0XTtvPHRoaXMuY29sdW1ucysxO28rKylyW29dPXRoaXMuZGF0YVt0XVtvLTFdO3RoaXMuZGF0YVt0XT1yfXJldHVybiB0aGlzLmNvbHVtbnMrPTEsdGhpc319QnQocSxUKTtjbGFzcyB1ZSBleHRlbmRzIHF7Y29uc3RydWN0b3IoZSxzLHQpe3N1cGVyKCk7dGhpcy5tYXRyaXg9ZSx0aGlzLnJvd3M9cyx0aGlzLmNvbHVtbnM9dH19Y2xhc3MgZmUgZXh0ZW5kcyB1ZXtjb25zdHJ1Y3RvcihlKXtzdXBlcihlLGUuY29sdW1ucyxlLnJvd3MpfXNldChlLHMsdCl7cmV0dXJuIHRoaXMubWF0cml4LnNldChzLGUsdCksdGhpc31nZXQoZSxzKXtyZXR1cm4gdGhpcy5tYXRyaXguZ2V0KHMsZSl9fWNsYXNzIGx0IGV4dGVuZHMgcXtjb25zdHJ1Y3RvcihlKXtzdXBlcigpO3RoaXMuZGF0YT1lLHRoaXMucm93cz1lLmxlbmd0aCx0aGlzLmNvbHVtbnM9ZVswXS5sZW5ndGh9c2V0KGUscyx0KXtyZXR1cm4gdGhpcy5kYXRhW2VdW3NdPXQsdGhpc31nZXQoZSxzKXtyZXR1cm4gdGhpcy5kYXRhW2VdW3NdfX1mdW5jdGlvbiBLKG4sZSl7bGV0IHM9MDtyZXR1cm4gTWF0aC5hYnMobik+TWF0aC5hYnMoZSk/KHM9ZS9uLE1hdGguYWJzKG4pKk1hdGguc3FydCgxK3MqcykpOmUhPT0wPyhzPW4vZSxNYXRoLmFicyhlKSpNYXRoLnNxcnQoMStzKnMpKTowfWNsYXNzIGFle2NvbnN0cnVjdG9yKGUscz17fSl7aWYoZT1sdC5jaGVja01hdHJpeChlKSxlLmlzRW1wdHkoKSl0aHJvdyBuZXcgRXJyb3IoIk1hdHJpeCBtdXN0IGJlIG5vbi1lbXB0eSIpO2xldCB0PWUucm93cyxyPWUuY29sdW1ucztjb25zdHtjb21wdXRlTGVmdFNpbmd1bGFyVmVjdG9yczpvPSEwLGNvbXB1dGVSaWdodFNpbmd1bGFyVmVjdG9yczppPSEwLGF1dG9UcmFuc3Bvc2U6aD0hMX09cztsZXQgYT1Cb29sZWFuKG8pLGw9Qm9vbGVhbihpKSxnPSExLHU7aWYodDxyKWlmKCFoKXU9ZS5jbG9uZSgpLGNvbnNvbGUud2FybigiQ29tcHV0aW5nIFNWRCBvbiBhIG1hdHJpeCB3aXRoIG1vcmUgY29sdW1ucyB0aGFuIHJvd3MuIENvbnNpZGVyIGVuYWJsaW5nIGF1dG9UcmFuc3Bvc2UiKTtlbHNle3U9ZS50cmFuc3Bvc2UoKSx0PXUucm93cyxyPXUuY29sdW1ucyxnPSEwO2xldCBjPWE7YT1sLGw9Y31lbHNlIHU9ZS5jbG9uZSgpO2xldCBwPU1hdGgubWluKHQscikseT1NYXRoLm1pbih0KzEsciksbT1uZXcgRmxvYXQ2NEFycmF5KHkpLHc9bmV3IFQodCxwKSx2PW5ldyBUKHIsciksZj1uZXcgRmxvYXQ2NEFycmF5KHIpLE09bmV3IEZsb2F0NjRBcnJheSh0KSxiPW5ldyBGbG9hdDY0QXJyYXkoeSk7Zm9yKGxldCBjPTA7Yzx5O2MrKyliW2NdPWM7bGV0IGo9TWF0aC5taW4odC0xLHIpLFI9TWF0aC5tYXgoMCxNYXRoLm1pbihyLTIsdCkpLEY9TWF0aC5tYXgoaixSKTtmb3IobGV0IGM9MDtjPEY7YysrKXtpZihjPGope21bY109MDtmb3IobGV0IGQ9YztkPHQ7ZCsrKW1bY109SyhtW2NdLHUuZ2V0KGQsYykpO2lmKG1bY10hPT0wKXt1LmdldChjLGMpPDAmJihtW2NdPS1tW2NdKTtmb3IobGV0IGQ9YztkPHQ7ZCsrKXUuc2V0KGQsYyx1LmdldChkLGMpL21bY10pO3Uuc2V0KGMsYyx1LmdldChjLGMpKzEpfW1bY109LW1bY119Zm9yKGxldCBkPWMrMTtkPHI7ZCsrKXtpZihjPGomJm1bY10hPT0wKXtsZXQgRT0wO2ZvcihsZXQgUz1jO1M8dDtTKyspRSs9dS5nZXQoUyxjKSp1LmdldChTLGQpO0U9LUUvdS5nZXQoYyxjKTtmb3IobGV0IFM9YztTPHQ7UysrKXUuc2V0KFMsZCx1LmdldChTLGQpK0UqdS5nZXQoUyxjKSl9ZltkXT11LmdldChjLGQpfWlmKGEmJmM8ailmb3IobGV0IGQ9YztkPHQ7ZCsrKXcuc2V0KGQsYyx1LmdldChkLGMpKTtpZihjPFIpe2ZbY109MDtmb3IobGV0IGQ9YysxO2Q8cjtkKyspZltjXT1LKGZbY10sZltkXSk7aWYoZltjXSE9PTApe2ZbYysxXTwwJiYoZltjXT0wLWZbY10pO2ZvcihsZXQgZD1jKzE7ZDxyO2QrKylmW2RdLz1mW2NdO2ZbYysxXSs9MX1pZihmW2NdPS1mW2NdLGMrMTx0JiZmW2NdIT09MCl7Zm9yKGxldCBkPWMrMTtkPHQ7ZCsrKU1bZF09MDtmb3IobGV0IGQ9YysxO2Q8dDtkKyspZm9yKGxldCBFPWMrMTtFPHI7RSsrKU1bZF0rPWZbRV0qdS5nZXQoZCxFKTtmb3IobGV0IGQ9YysxO2Q8cjtkKyspe2xldCBFPS1mW2RdL2ZbYysxXTtmb3IobGV0IFM9YysxO1M8dDtTKyspdS5zZXQoUyxkLHUuZ2V0KFMsZCkrRSpNW1NdKX19aWYobClmb3IobGV0IGQ9YysxO2Q8cjtkKyspdi5zZXQoZCxjLGZbZF0pfX1sZXQgaz1NYXRoLm1pbihyLHQrMSk7aWYoajxyJiYobVtqXT11LmdldChqLGopKSx0PGsmJihtW2stMV09MCksUisxPGsmJihmW1JdPXUuZ2V0KFIsay0xKSksZltrLTFdPTAsYSl7Zm9yKGxldCBjPWo7YzxwO2MrKyl7Zm9yKGxldCBkPTA7ZDx0O2QrKyl3LnNldChkLGMsMCk7dy5zZXQoYyxjLDEpfWZvcihsZXQgYz1qLTE7Yz49MDtjLS0paWYobVtjXSE9PTApe2ZvcihsZXQgZD1jKzE7ZDxwO2QrKyl7bGV0IEU9MDtmb3IobGV0IFM9YztTPHQ7UysrKUUrPXcuZ2V0KFMsYykqdy5nZXQoUyxkKTtFPS1FL3cuZ2V0KGMsYyk7Zm9yKGxldCBTPWM7Uzx0O1MrKyl3LnNldChTLGQsdy5nZXQoUyxkKStFKncuZ2V0KFMsYykpfWZvcihsZXQgZD1jO2Q8dDtkKyspdy5zZXQoZCxjLC13LmdldChkLGMpKTt3LnNldChjLGMsMSt3LmdldChjLGMpKTtmb3IobGV0IGQ9MDtkPGMtMTtkKyspdy5zZXQoZCxjLDApfWVsc2V7Zm9yKGxldCBkPTA7ZDx0O2QrKyl3LnNldChkLGMsMCk7dy5zZXQoYyxjLDEpfX1pZihsKWZvcihsZXQgYz1yLTE7Yz49MDtjLS0pe2lmKGM8UiYmZltjXSE9PTApZm9yKGxldCBkPWMrMTtkPHI7ZCsrKXtsZXQgRT0wO2ZvcihsZXQgUz1jKzE7UzxyO1MrKylFKz12LmdldChTLGMpKnYuZ2V0KFMsZCk7RT0tRS92LmdldChjKzEsYyk7Zm9yKGxldCBTPWMrMTtTPHI7UysrKXYuc2V0KFMsZCx2LmdldChTLGQpK0Uqdi5nZXQoUyxjKSl9Zm9yKGxldCBkPTA7ZDxyO2QrKyl2LnNldChkLGMsMCk7di5zZXQoYyxjLDEpfWxldCBOPWstMSxJPU51bWJlci5FUFNJTE9OO2Zvcig7az4wOyl7bGV0IGMsZDtmb3IoYz1rLTI7Yz49LTEmJmMhPT0tMTtjLS0pe2NvbnN0IEU9TnVtYmVyLk1JTl9WQUxVRStJKk1hdGguYWJzKG1bY10rTWF0aC5hYnMobVtjKzFdKSk7aWYoTWF0aC5hYnMoZltjXSk8PUV8fE51bWJlci5pc05hTihmW2NdKSl7ZltjXT0wO2JyZWFrfX1pZihjPT09ay0yKWQ9NDtlbHNle2xldCBFO2ZvcihFPWstMTtFPj1jJiZFIT09YztFLS0pe2xldCBTPShFIT09az9NYXRoLmFicyhmW0VdKTowKSsoRSE9PWMrMT9NYXRoLmFicyhmW0UtMV0pOjApO2lmKE1hdGguYWJzKG1bRV0pPD1JKlMpe21bRV09MDticmVha319RT09PWM/ZD0zOkU9PT1rLTE/ZD0xOihkPTIsYz1FKX1zd2l0Y2goYysrLGQpe2Nhc2UgMTp7bGV0IEU9ZltrLTJdO2Zbay0yXT0wO2ZvcihsZXQgUz1rLTI7Uz49YztTLS0pe2xldCBQPUsobVtTXSxFKSxDPW1bU10vUCx6PUUvUDtpZihtW1NdPVAsUyE9PWMmJihFPS16KmZbUy0xXSxmW1MtMV09QypmW1MtMV0pLGwpZm9yKGxldCBMPTA7TDxyO0wrKylQPUMqdi5nZXQoTCxTKSt6KnYuZ2V0KEwsay0xKSx2LnNldChMLGstMSwteip2LmdldChMLFMpK0Mqdi5nZXQoTCxrLTEpKSx2LnNldChMLFMsUCl9YnJlYWt9Y2FzZSAyOntsZXQgRT1mW2MtMV07ZltjLTFdPTA7Zm9yKGxldCBTPWM7UzxrO1MrKyl7bGV0IFA9SyhtW1NdLEUpLEM9bVtTXS9QLHo9RS9QO2lmKG1bU109UCxFPS16KmZbU10sZltTXT1DKmZbU10sYSlmb3IobGV0IEw9MDtMPHQ7TCsrKVA9Qyp3LmdldChMLFMpK3oqdy5nZXQoTCxjLTEpLHcuc2V0KEwsYy0xLC16KncuZ2V0KEwsUykrQyp3LmdldChMLGMtMSkpLHcuc2V0KEwsUyxQKX1icmVha31jYXNlIDM6e2NvbnN0IEU9TWF0aC5tYXgoTWF0aC5hYnMobVtrLTFdKSxNYXRoLmFicyhtW2stMl0pLE1hdGguYWJzKGZbay0yXSksTWF0aC5hYnMobVtjXSksTWF0aC5hYnMoZltjXSkpLFM9bVtrLTFdL0UsUD1tW2stMl0vRSxDPWZbay0yXS9FLHo9bVtjXS9FLEw9ZltjXS9FLFU9KChQK1MpKihQLVMpK0MqQykvMixCPVMqQyooUypDKTtsZXQgRD0wOyhVIT09MHx8QiE9PTApJiYoVTwwP0Q9MC1NYXRoLnNxcnQoVSpVK0IpOkQ9TWF0aC5zcXJ0KFUqVStCKSxEPUIvKFUrRCkpO2xldCBZPSh6K1MpKih6LVMpK0QsXz16Kkw7Zm9yKGxldCAkPWM7JDxrLTE7JCsrKXtsZXQgTz1LKFksXyk7Tz09PTAmJihPPU51bWJlci5NSU5fVkFMVUUpO2xldCBYPVkvTyxaPV8vTztpZigkIT09YyYmKGZbJC0xXT1PKSxZPVgqbVskXStaKmZbJF0sZlskXT1YKmZbJF0tWiptWyRdLF89WiptWyQrMV0sbVskKzFdPVgqbVskKzFdLGwpZm9yKGxldCBWPTA7VjxyO1YrKylPPVgqdi5nZXQoViwkKStaKnYuZ2V0KFYsJCsxKSx2LnNldChWLCQrMSwtWip2LmdldChWLCQpK1gqdi5nZXQoViwkKzEpKSx2LnNldChWLCQsTyk7aWYoTz1LKFksXyksTz09PTAmJihPPU51bWJlci5NSU5fVkFMVUUpLFg9WS9PLFo9Xy9PLG1bJF09TyxZPVgqZlskXStaKm1bJCsxXSxtWyQrMV09LVoqZlskXStYKm1bJCsxXSxfPVoqZlskKzFdLGZbJCsxXT1YKmZbJCsxXSxhJiYkPHQtMSlmb3IobGV0IFY9MDtWPHQ7VisrKU89WCp3LmdldChWLCQpK1oqdy5nZXQoViwkKzEpLHcuc2V0KFYsJCsxLC1aKncuZ2V0KFYsJCkrWCp3LmdldChWLCQrMSkpLHcuc2V0KFYsJCxPKX1mW2stMl09WTticmVha31jYXNlIDQ6e2lmKG1bY108PTAmJihtW2NdPW1bY108MD8tbVtjXTowLGwpKWZvcihsZXQgRT0wO0U8PU47RSsrKXYuc2V0KEUsYywtdi5nZXQoRSxjKSk7Zm9yKDtjPE4mJiEobVtjXT49bVtjKzFdKTspe2xldCBFPW1bY107aWYobVtjXT1tW2MrMV0sbVtjKzFdPUUsbCYmYzxyLTEpZm9yKGxldCBTPTA7UzxyO1MrKylFPXYuZ2V0KFMsYysxKSx2LnNldChTLGMrMSx2LmdldChTLGMpKSx2LnNldChTLGMsRSk7aWYoYSYmYzx0LTEpZm9yKGxldCBTPTA7Uzx0O1MrKylFPXcuZ2V0KFMsYysxKSx3LnNldChTLGMrMSx3LmdldChTLGMpKSx3LnNldChTLGMsRSk7YysrfWstLTticmVha319fWlmKGcpe2xldCBjPXY7dj13LHc9Y310aGlzLm09dCx0aGlzLm49cix0aGlzLnM9bSx0aGlzLlU9dyx0aGlzLlY9dn1zb2x2ZShlKXtsZXQgcz1lLHQ9dGhpcy50aHJlc2hvbGQscj10aGlzLnMubGVuZ3RoLG89VC56ZXJvcyhyLHIpO2ZvcihsZXQgcD0wO3A8cjtwKyspTWF0aC5hYnModGhpcy5zW3BdKTw9dD9vLnNldChwLHAsMCk6by5zZXQocCxwLDEvdGhpcy5zW3BdKTtsZXQgaT10aGlzLlUsaD10aGlzLnJpZ2h0U2luZ3VsYXJWZWN0b3JzLGE9aC5tbXVsKG8pLGw9aC5yb3dzLGc9aS5yb3dzLHU9VC56ZXJvcyhsLGcpO2ZvcihsZXQgcD0wO3A8bDtwKyspZm9yKGxldCB5PTA7eTxnO3krKyl7bGV0IG09MDtmb3IobGV0IHc9MDt3PHI7dysrKW0rPWEuZ2V0KHAsdykqaS5nZXQoeSx3KTt1LnNldChwLHksbSl9cmV0dXJuIHUubW11bChzKX1zb2x2ZUZvckRpYWdvbmFsKGUpe3JldHVybiB0aGlzLnNvbHZlKFQuZGlhZyhlKSl9aW52ZXJzZSgpe2xldCBlPXRoaXMuVixzPXRoaXMudGhyZXNob2xkLHQ9ZS5yb3dzLHI9ZS5jb2x1bW5zLG89bmV3IFQodCx0aGlzLnMubGVuZ3RoKTtmb3IobGV0IGc9MDtnPHQ7ZysrKWZvcihsZXQgdT0wO3U8cjt1KyspTWF0aC5hYnModGhpcy5zW3VdKT5zJiZvLnNldChnLHUsZS5nZXQoZyx1KS90aGlzLnNbdV0pO2xldCBpPXRoaXMuVSxoPWkucm93cyxhPWkuY29sdW1ucyxsPW5ldyBUKHQsaCk7Zm9yKGxldCBnPTA7Zzx0O2crKylmb3IobGV0IHU9MDt1PGg7dSsrKXtsZXQgcD0wO2ZvcihsZXQgeT0wO3k8YTt5KyspcCs9by5nZXQoZyx5KSppLmdldCh1LHkpO2wuc2V0KGcsdSxwKX1yZXR1cm4gbH1nZXQgY29uZGl0aW9uKCl7cmV0dXJuIHRoaXMuc1swXS90aGlzLnNbTWF0aC5taW4odGhpcy5tLHRoaXMubiktMV19Z2V0IG5vcm0yKCl7cmV0dXJuIHRoaXMuc1swXX1nZXQgcmFuaygpe2xldCBlPU1hdGgubWF4KHRoaXMubSx0aGlzLm4pKnRoaXMuc1swXSpOdW1iZXIuRVBTSUxPTixzPTAsdD10aGlzLnM7Zm9yKGxldCByPTAsbz10Lmxlbmd0aDtyPG87cisrKXRbcl0+ZSYmcysrO3JldHVybiBzfWdldCBkaWFnb25hbCgpe3JldHVybiBBcnJheS5mcm9tKHRoaXMucyl9Z2V0IHRocmVzaG9sZCgpe3JldHVybiBOdW1iZXIuRVBTSUxPTi8yKk1hdGgubWF4KHRoaXMubSx0aGlzLm4pKnRoaXMuc1swXX1nZXQgbGVmdFNpbmd1bGFyVmVjdG9ycygpe3JldHVybiB0aGlzLlV9Z2V0IHJpZ2h0U2luZ3VsYXJWZWN0b3JzKCl7cmV0dXJuIHRoaXMuVn1nZXQgZGlhZ29uYWxNYXRyaXgoKXtyZXR1cm4gVC5kaWFnKHRoaXMucyl9fWNsYXNzIGNle2NvbnN0cnVjdG9yKGUscz17fSl7Y29uc3R7YXNzdW1lU3ltbWV0cmljOnQ9ITF9PXM7aWYoZT1sdC5jaGVja01hdHJpeChlKSwhZS5pc1NxdWFyZSgpKXRocm93IG5ldyBFcnJvcigiTWF0cml4IGlzIG5vdCBhIHNxdWFyZSBtYXRyaXgiKTtpZihlLmlzRW1wdHkoKSl0aHJvdyBuZXcgRXJyb3IoIk1hdHJpeCBtdXN0IGJlIG5vbi1lbXB0eSIpO2xldCByPWUuY29sdW1ucyxvPW5ldyBUKHIsciksaT1uZXcgRmxvYXQ2NEFycmF5KHIpLGg9bmV3IEZsb2F0NjRBcnJheShyKSxhPWUsbCxnLHU9ITE7aWYodD91PSEwOnU9ZS5pc1N5bW1ldHJpYygpLHUpe2ZvcihsPTA7bDxyO2wrKylmb3IoZz0wO2c8cjtnKyspby5zZXQobCxnLGEuZ2V0KGwsZykpO2dlKHIsaCxpLG8pLG1lKHIsaCxpLG8pfWVsc2V7bGV0IHA9bmV3IFQocixyKSx5PW5ldyBGbG9hdDY0QXJyYXkocik7Zm9yKGc9MDtnPHI7ZysrKWZvcihsPTA7bDxyO2wrKylwLnNldChsLGcsYS5nZXQobCxnKSk7d2UocixwLHksbykscGUocixoLGksbyxwKX10aGlzLm49cix0aGlzLmU9aCx0aGlzLmQ9aSx0aGlzLlY9b31nZXQgcmVhbEVpZ2VudmFsdWVzKCl7cmV0dXJuIEFycmF5LmZyb20odGhpcy5kKX1nZXQgaW1hZ2luYXJ5RWlnZW52YWx1ZXMoKXtyZXR1cm4gQXJyYXkuZnJvbSh0aGlzLmUpfWdldCBlaWdlbnZlY3Rvck1hdHJpeCgpe3JldHVybiB0aGlzLlZ9Z2V0IGRpYWdvbmFsTWF0cml4KCl7bGV0IGU9dGhpcy5uLHM9dGhpcy5lLHQ9dGhpcy5kLHI9bmV3IFQoZSxlKSxvLGk7Zm9yKG89MDtvPGU7bysrKXtmb3IoaT0wO2k8ZTtpKyspci5zZXQobyxpLDApO3Iuc2V0KG8sbyx0W29dKSxzW29dPjA/ci5zZXQobyxvKzEsc1tvXSk6c1tvXTwwJiZyLnNldChvLG8tMSxzW29dKX1yZXR1cm4gcn19ZnVuY3Rpb24gZ2UobixlLHMsdCl7bGV0IHIsbyxpLGgsYSxsLGcsdTtmb3IoYT0wO2E8bjthKyspc1thXT10LmdldChuLTEsYSk7Zm9yKGg9bi0xO2g+MDtoLS0pe2Zvcih1PTAsaT0wLGw9MDtsPGg7bCsrKXU9dStNYXRoLmFicyhzW2xdKTtpZih1PT09MClmb3IoZVtoXT1zW2gtMV0sYT0wO2E8aDthKyspc1thXT10LmdldChoLTEsYSksdC5zZXQoaCxhLDApLHQuc2V0KGEsaCwwKTtlbHNle2ZvcihsPTA7bDxoO2wrKylzW2xdLz11LGkrPXNbbF0qc1tsXTtmb3Iocj1zW2gtMV0sbz1NYXRoLnNxcnQoaSkscj4wJiYobz0tbyksZVtoXT11Km8saT1pLXIqbyxzW2gtMV09ci1vLGE9MDthPGg7YSsrKWVbYV09MDtmb3IoYT0wO2E8aDthKyspe2ZvcihyPXNbYV0sdC5zZXQoYSxoLHIpLG89ZVthXSt0LmdldChhLGEpKnIsbD1hKzE7bDw9aC0xO2wrKylvKz10LmdldChsLGEpKnNbbF0sZVtsXSs9dC5nZXQobCxhKSpyO2VbYV09b31mb3Iocj0wLGE9MDthPGg7YSsrKWVbYV0vPWkscis9ZVthXSpzW2FdO2ZvcihnPXIvKGkraSksYT0wO2E8aDthKyspZVthXS09ZypzW2FdO2ZvcihhPTA7YTxoO2ErKyl7Zm9yKHI9c1thXSxvPWVbYV0sbD1hO2w8PWgtMTtsKyspdC5zZXQobCxhLHQuZ2V0KGwsYSktKHIqZVtsXStvKnNbbF0pKTtzW2FdPXQuZ2V0KGgtMSxhKSx0LnNldChoLGEsMCl9fXNbaF09aX1mb3IoaD0wO2g8bi0xO2grKyl7aWYodC5zZXQobi0xLGgsdC5nZXQoaCxoKSksdC5zZXQoaCxoLDEpLGk9c1toKzFdLGkhPT0wKXtmb3IobD0wO2w8PWg7bCsrKXNbbF09dC5nZXQobCxoKzEpL2k7Zm9yKGE9MDthPD1oO2ErKyl7Zm9yKG89MCxsPTA7bDw9aDtsKyspbys9dC5nZXQobCxoKzEpKnQuZ2V0KGwsYSk7Zm9yKGw9MDtsPD1oO2wrKyl0LnNldChsLGEsdC5nZXQobCxhKS1vKnNbbF0pfX1mb3IobD0wO2w8PWg7bCsrKXQuc2V0KGwsaCsxLDApfWZvcihhPTA7YTxuO2ErKylzW2FdPXQuZ2V0KG4tMSxhKSx0LnNldChuLTEsYSwwKTt0LnNldChuLTEsbi0xLDEpLGVbMF09MH1mdW5jdGlvbiBtZShuLGUscyx0KXtsZXQgcixvLGksaCxhLGwsZyx1LHAseSxtLHcsdixmLE0sYjtmb3IoaT0xO2k8bjtpKyspZVtpLTFdPWVbaV07ZVtuLTFdPTA7bGV0IGo9MCxSPTAsRj1OdW1iZXIuRVBTSUxPTjtmb3IobD0wO2w8bjtsKyspe2ZvcihSPU1hdGgubWF4KFIsTWF0aC5hYnMoc1tsXSkrTWF0aC5hYnMoZVtsXSkpLGc9bDtnPG4mJiEoTWF0aC5hYnMoZVtnXSk8PUYqUik7KWcrKztpZihnPmwpZG97Zm9yKHI9c1tsXSx1PShzW2wrMV0tcikvKDIqZVtsXSkscD1LKHUsMSksdTwwJiYocD0tcCksc1tsXT1lW2xdLyh1K3ApLHNbbCsxXT1lW2xdKih1K3ApLHk9c1tsKzFdLG89ci1zW2xdLGk9bCsyO2k8bjtpKyspc1tpXS09bztmb3Ioaj1qK28sdT1zW2ddLG09MSx3PW0sdj1tLGY9ZVtsKzFdLE09MCxiPTAsaT1nLTE7aT49bDtpLS0pZm9yKHY9dyx3PW0sYj1NLHI9bSplW2ldLG89bSp1LHA9Syh1LGVbaV0pLGVbaSsxXT1NKnAsTT1lW2ldL3AsbT11L3AsdT1tKnNbaV0tTSpyLHNbaSsxXT1vK00qKG0qcitNKnNbaV0pLGE9MDthPG47YSsrKW89dC5nZXQoYSxpKzEpLHQuc2V0KGEsaSsxLE0qdC5nZXQoYSxpKSttKm8pLHQuc2V0KGEsaSxtKnQuZ2V0KGEsaSktTSpvKTt1PS1NKmIqdipmKmVbbF0veSxlW2xdPU0qdSxzW2xdPW0qdX13aGlsZShNYXRoLmFicyhlW2xdKT5GKlIpO3NbbF09c1tsXStqLGVbbF09MH1mb3IoaT0wO2k8bi0xO2krKyl7Zm9yKGE9aSx1PXNbaV0saD1pKzE7aDxuO2grKylzW2hdPHUmJihhPWgsdT1zW2hdKTtpZihhIT09aSlmb3Ioc1thXT1zW2ldLHNbaV09dSxoPTA7aDxuO2grKyl1PXQuZ2V0KGgsaSksdC5zZXQoaCxpLHQuZ2V0KGgsYSkpLHQuc2V0KGgsYSx1KX19ZnVuY3Rpb24gd2UobixlLHMsdCl7bGV0IHI9MCxvPW4tMSxpLGgsYSxsLGcsdSxwO2Zvcih1PXIrMTt1PD1vLTE7dSsrKXtmb3IocD0wLGw9dTtsPD1vO2wrKylwPXArTWF0aC5hYnMoZS5nZXQobCx1LTEpKTtpZihwIT09MCl7Zm9yKGE9MCxsPW87bD49dTtsLS0pc1tsXT1lLmdldChsLHUtMSkvcCxhKz1zW2xdKnNbbF07Zm9yKGg9TWF0aC5zcXJ0KGEpLHNbdV0+MCYmKGg9LWgpLGE9YS1zW3VdKmgsc1t1XT1zW3VdLWgsZz11O2c8bjtnKyspe2ZvcihpPTAsbD1vO2w+PXU7bC0tKWkrPXNbbF0qZS5nZXQobCxnKTtmb3IoaT1pL2EsbD11O2w8PW87bCsrKWUuc2V0KGwsZyxlLmdldChsLGcpLWkqc1tsXSl9Zm9yKGw9MDtsPD1vO2wrKyl7Zm9yKGk9MCxnPW87Zz49dTtnLS0paSs9c1tnXSplLmdldChsLGcpO2ZvcihpPWkvYSxnPXU7Zzw9bztnKyspZS5zZXQobCxnLGUuZ2V0KGwsZyktaSpzW2ddKX1zW3VdPXAqc1t1XSxlLnNldCh1LHUtMSxwKmgpfX1mb3IobD0wO2w8bjtsKyspZm9yKGc9MDtnPG47ZysrKXQuc2V0KGwsZyxsPT09Zz8xOjApO2Zvcih1PW8tMTt1Pj1yKzE7dS0tKWlmKGUuZ2V0KHUsdS0xKSE9PTApe2ZvcihsPXUrMTtsPD1vO2wrKylzW2xdPWUuZ2V0KGwsdS0xKTtmb3IoZz11O2c8PW87ZysrKXtmb3IoaD0wLGw9dTtsPD1vO2wrKyloKz1zW2xdKnQuZ2V0KGwsZyk7Zm9yKGg9aC9zW3VdL2UuZ2V0KHUsdS0xKSxsPXU7bDw9bztsKyspdC5zZXQobCxnLHQuZ2V0KGwsZykraCpzW2xdKX19fWZ1bmN0aW9uIHBlKG4sZSxzLHQscil7bGV0IG89bi0xLGk9MCxoPW4tMSxhPU51bWJlci5FUFNJTE9OLGw9MCxnPTAsdT0wLHA9MCx5PTAsbT0wLHc9MCx2PTAsZixNLGIsaixSLEYsayxOLEksYyxkLEUsUyxQLEM7Zm9yKGY9MDtmPG47ZisrKWZvcigoZjxpfHxmPmgpJiYoc1tmXT1yLmdldChmLGYpLGVbZl09MCksTT1NYXRoLm1heChmLTEsMCk7TTxuO00rKylnPWcrTWF0aC5hYnMoci5nZXQoZixNKSk7Zm9yKDtvPj1pOyl7Zm9yKGo9bztqPmkmJihtPU1hdGguYWJzKHIuZ2V0KGotMSxqLTEpKStNYXRoLmFicyhyLmdldChqLGopKSxtPT09MCYmKG09ZyksIShNYXRoLmFicyhyLmdldChqLGotMSkpPGEqbSkpOylqLS07aWYoaj09PW8pci5zZXQobyxvLHIuZ2V0KG8sbykrbCksc1tvXT1yLmdldChvLG8pLGVbb109MCxvLS0sdj0wO2Vsc2UgaWYoaj09PW8tMSl7aWYoaz1yLmdldChvLG8tMSkqci5nZXQoby0xLG8pLHU9KHIuZ2V0KG8tMSxvLTEpLXIuZ2V0KG8sbykpLzIscD11KnUrayx3PU1hdGguc3FydChNYXRoLmFicyhwKSksci5zZXQobyxvLHIuZ2V0KG8sbykrbCksci5zZXQoby0xLG8tMSxyLmdldChvLTEsby0xKStsKSxOPXIuZ2V0KG8sbykscD49MCl7Zm9yKHc9dT49MD91K3c6dS13LHNbby0xXT1OK3csc1tvXT1zW28tMV0sdyE9PTAmJihzW29dPU4tay93KSxlW28tMV09MCxlW29dPTAsTj1yLmdldChvLG8tMSksbT1NYXRoLmFicyhOKStNYXRoLmFicyh3KSx1PU4vbSxwPXcvbSx5PU1hdGguc3FydCh1KnUrcCpwKSx1PXUveSxwPXAveSxNPW8tMTtNPG47TSsrKXc9ci5nZXQoby0xLE0pLHIuc2V0KG8tMSxNLHAqdyt1KnIuZ2V0KG8sTSkpLHIuc2V0KG8sTSxwKnIuZ2V0KG8sTSktdSp3KTtmb3IoZj0wO2Y8PW87ZisrKXc9ci5nZXQoZixvLTEpLHIuc2V0KGYsby0xLHAqdyt1KnIuZ2V0KGYsbykpLHIuc2V0KGYsbyxwKnIuZ2V0KGYsbyktdSp3KTtmb3IoZj1pO2Y8PWg7ZisrKXc9dC5nZXQoZixvLTEpLHQuc2V0KGYsby0xLHAqdyt1KnQuZ2V0KGYsbykpLHQuc2V0KGYsbyxwKnQuZ2V0KGYsbyktdSp3KX1lbHNlIHNbby0xXT1OK3Usc1tvXT1OK3UsZVtvLTFdPXcsZVtvXT0tdztvPW8tMix2PTB9ZWxzZXtpZihOPXIuZ2V0KG8sbyksST0wLGs9MCxqPG8mJihJPXIuZ2V0KG8tMSxvLTEpLGs9ci5nZXQobyxvLTEpKnIuZ2V0KG8tMSxvKSksdj09PTEwKXtmb3IobCs9TixmPWk7Zjw9bztmKyspci5zZXQoZixmLHIuZ2V0KGYsZiktTik7bT1NYXRoLmFicyhyLmdldChvLG8tMSkpK01hdGguYWJzKHIuZ2V0KG8tMSxvLTIpKSxOPUk9Ljc1Km0saz0tLjQzNzUqbSptfWlmKHY9PT0zMCYmKG09KEktTikvMixtPW0qbStrLG0+MCkpe2ZvcihtPU1hdGguc3FydChtKSxJPE4mJihtPS1tKSxtPU4tay8oKEktTikvMittKSxmPWk7Zjw9bztmKyspci5zZXQoZixmLHIuZ2V0KGYsZiktbSk7bCs9bSxOPUk9az0uOTY0fWZvcih2PXYrMSxSPW8tMjtSPj1qJiYodz1yLmdldChSLFIpLHk9Ti13LG09SS13LHU9KHkqbS1rKS9yLmdldChSKzEsUikrci5nZXQoUixSKzEpLHA9ci5nZXQoUisxLFIrMSktdy15LW0seT1yLmdldChSKzIsUisxKSxtPU1hdGguYWJzKHUpK01hdGguYWJzKHApK01hdGguYWJzKHkpLHU9dS9tLHA9cC9tLHk9eS9tLCEoUj09PWp8fE1hdGguYWJzKHIuZ2V0KFIsUi0xKSkqKE1hdGguYWJzKHApK01hdGguYWJzKHkpKTxhKihNYXRoLmFicyh1KSooTWF0aC5hYnMoci5nZXQoUi0xLFItMSkpK01hdGguYWJzKHcpK01hdGguYWJzKHIuZ2V0KFIrMSxSKzEpKSkpKSk7KVItLTtmb3IoZj1SKzI7Zjw9bztmKyspci5zZXQoZixmLTIsMCksZj5SKzImJnIuc2V0KGYsZi0zLDApO2ZvcihiPVI7Yjw9by0xJiYoUD1iIT09by0xLGIhPT1SJiYodT1yLmdldChiLGItMSkscD1yLmdldChiKzEsYi0xKSx5PVA/ci5nZXQoYisyLGItMSk6MCxOPU1hdGguYWJzKHUpK01hdGguYWJzKHApK01hdGguYWJzKHkpLE4hPT0wJiYodT11L04scD1wL04seT15L04pKSxOIT09MCk7YisrKWlmKG09TWF0aC5zcXJ0KHUqdStwKnAreSp5KSx1PDAmJihtPS1tKSxtIT09MCl7Zm9yKGIhPT1SP3Iuc2V0KGIsYi0xLC1tKk4pOmohPT1SJiZyLnNldChiLGItMSwtci5nZXQoYixiLTEpKSx1PXUrbSxOPXUvbSxJPXAvbSx3PXkvbSxwPXAvdSx5PXkvdSxNPWI7TTxuO00rKyl1PXIuZ2V0KGIsTSkrcCpyLmdldChiKzEsTSksUCYmKHU9dSt5KnIuZ2V0KGIrMixNKSxyLnNldChiKzIsTSxyLmdldChiKzIsTSktdSp3KSksci5zZXQoYixNLHIuZ2V0KGIsTSktdSpOKSxyLnNldChiKzEsTSxyLmdldChiKzEsTSktdSpJKTtmb3IoZj0wO2Y8PU1hdGgubWluKG8sYiszKTtmKyspdT1OKnIuZ2V0KGYsYikrSSpyLmdldChmLGIrMSksUCYmKHU9dSt3KnIuZ2V0KGYsYisyKSxyLnNldChmLGIrMixyLmdldChmLGIrMiktdSp5KSksci5zZXQoZixiLHIuZ2V0KGYsYiktdSksci5zZXQoZixiKzEsci5nZXQoZixiKzEpLXUqcCk7Zm9yKGY9aTtmPD1oO2YrKyl1PU4qdC5nZXQoZixiKStJKnQuZ2V0KGYsYisxKSxQJiYodT11K3cqdC5nZXQoZixiKzIpLHQuc2V0KGYsYisyLHQuZ2V0KGYsYisyKS11KnkpKSx0LnNldChmLGIsdC5nZXQoZixiKS11KSx0LnNldChmLGIrMSx0LmdldChmLGIrMSktdSpwKX19fWlmKGchPT0wKXtmb3Iobz1uLTE7bz49MDtvLS0paWYodT1zW29dLHA9ZVtvXSxwPT09MClmb3Ioaj1vLHIuc2V0KG8sbywxKSxmPW8tMTtmPj0wO2YtLSl7Zm9yKGs9ci5nZXQoZixmKS11LHk9MCxNPWo7TTw9bztNKyspeT15K3IuZ2V0KGYsTSkqci5nZXQoTSxvKTtpZihlW2ZdPDApdz1rLG09eTtlbHNlIGlmKGo9ZixlW2ZdPT09MD9yLnNldChmLG8sayE9PTA/LXkvazoteS8oYSpnKSk6KE49ci5nZXQoZixmKzEpLEk9ci5nZXQoZisxLGYpLHA9KHNbZl0tdSkqKHNbZl0tdSkrZVtmXSplW2ZdLEY9KE4qbS13KnkpL3Asci5zZXQoZixvLEYpLHIuc2V0KGYrMSxvLE1hdGguYWJzKE4pPk1hdGguYWJzKHcpPygteS1rKkYpL046KC1tLUkqRikvdykpLEY9TWF0aC5hYnMoci5nZXQoZixvKSksYSpGKkY+MSlmb3IoTT1mO008PW87TSsrKXIuc2V0KE0sbyxyLmdldChNLG8pL0YpfWVsc2UgaWYocDwwKWZvcihqPW8tMSxNYXRoLmFicyhyLmdldChvLG8tMSkpPk1hdGguYWJzKHIuZ2V0KG8tMSxvKSk/KHIuc2V0KG8tMSxvLTEscC9yLmdldChvLG8tMSkpLHIuc2V0KG8tMSxvLC0oci5nZXQobyxvKS11KS9yLmdldChvLG8tMSkpKTooQz1odCgwLC1yLmdldChvLTEsbyksci5nZXQoby0xLG8tMSktdSxwKSxyLnNldChvLTEsby0xLENbMF0pLHIuc2V0KG8tMSxvLENbMV0pKSxyLnNldChvLG8tMSwwKSxyLnNldChvLG8sMSksZj1vLTI7Zj49MDtmLS0pe2ZvcihjPTAsZD0wLE09ajtNPD1vO00rKyljPWMrci5nZXQoZixNKSpyLmdldChNLG8tMSksZD1kK3IuZ2V0KGYsTSkqci5nZXQoTSxvKTtpZihrPXIuZ2V0KGYsZiktdSxlW2ZdPDApdz1rLHk9YyxtPWQ7ZWxzZSBpZihqPWYsZVtmXT09PTA/KEM9aHQoLWMsLWQsayxwKSxyLnNldChmLG8tMSxDWzBdKSxyLnNldChmLG8sQ1sxXSkpOihOPXIuZ2V0KGYsZisxKSxJPXIuZ2V0KGYrMSxmKSxFPShzW2ZdLXUpKihzW2ZdLXUpK2VbZl0qZVtmXS1wKnAsUz0oc1tmXS11KSoyKnAsRT09PTAmJlM9PT0wJiYoRT1hKmcqKE1hdGguYWJzKGspK01hdGguYWJzKHApK01hdGguYWJzKE4pK01hdGguYWJzKEkpK01hdGguYWJzKHcpKSksQz1odChOKnktdypjK3AqZCxOKm0tdypkLXAqYyxFLFMpLHIuc2V0KGYsby0xLENbMF0pLHIuc2V0KGYsbyxDWzFdKSxNYXRoLmFicyhOKT5NYXRoLmFicyh3KStNYXRoLmFicyhwKT8oci5zZXQoZisxLG8tMSwoLWMtaypyLmdldChmLG8tMSkrcCpyLmdldChmLG8pKS9OKSxyLnNldChmKzEsbywoLWQtaypyLmdldChmLG8pLXAqci5nZXQoZixvLTEpKS9OKSk6KEM9aHQoLXktSSpyLmdldChmLG8tMSksLW0tSSpyLmdldChmLG8pLHcscCksci5zZXQoZisxLG8tMSxDWzBdKSxyLnNldChmKzEsbyxDWzFdKSkpLEY9TWF0aC5tYXgoTWF0aC5hYnMoci5nZXQoZixvLTEpKSxNYXRoLmFicyhyLmdldChmLG8pKSksYSpGKkY+MSlmb3IoTT1mO008PW87TSsrKXIuc2V0KE0sby0xLHIuZ2V0KE0sby0xKS9GKSxyLnNldChNLG8sci5nZXQoTSxvKS9GKX1mb3IoZj0wO2Y8bjtmKyspaWYoZjxpfHxmPmgpZm9yKE09ZjtNPG47TSsrKXQuc2V0KGYsTSxyLmdldChmLE0pKTtmb3IoTT1uLTE7TT49aTtNLS0pZm9yKGY9aTtmPD1oO2YrKyl7Zm9yKHc9MCxiPWk7Yjw9TWF0aC5taW4oTSxoKTtiKyspdz13K3QuZ2V0KGYsYikqci5nZXQoYixNKTt0LnNldChmLE0sdyl9fX1mdW5jdGlvbiBodChuLGUscyx0KXtsZXQgcixvO3JldHVybiBNYXRoLmFicyhzKT5NYXRoLmFicyh0KT8ocj10L3Msbz1zK3IqdCxbKG4rciplKS9vLChlLXIqbikvb10pOihyPXMvdCxvPXQrcipzLFsocipuK2UpL28sKHIqZS1uKS9vXSl9Y2xhc3MgZGV7Y29uc3RydWN0b3IoZSxzPXt9KXtlPWx0LmNoZWNrTWF0cml4KGUpO2xldHtZOnR9PXM7Y29uc3R7c2NhbGVTY29yZXM6cj0hMSxtYXhJdGVyYXRpb25zOm89MWUzLHRlcm1pbmF0aW9uQ3JpdGVyaWE6aT0xZS0xMH09cztsZXQgaDtpZih0KXtpZihBcnJheS5pc0FycmF5KHQpJiZ0eXBlb2YgdFswXT09Im51bWJlciI/dD1ULmNvbHVtblZlY3Rvcih0KTp0PWx0LmNoZWNrTWF0cml4KHQpLHQucm93cyE9PWUucm93cyl0aHJvdyBuZXcgRXJyb3IoIlkgc2hvdWxkIGhhdmUgdGhlIHNhbWUgbnVtYmVyIG9mIHJvd3MgYXMgWCIpO2g9dC5nZXRDb2x1bW5WZWN0b3IoMCl9ZWxzZSBoPWUuZ2V0Q29sdW1uVmVjdG9yKDApO2xldCBhPTEsbCxnLHUscDtmb3IobGV0IHk9MDt5PG8mJmE+aTt5KyspdT1lLnRyYW5zcG9zZSgpLm1tdWwoaCkuZGl2KGgudHJhbnNwb3NlKCkubW11bChoKS5nZXQoMCwwKSksdT11LmRpdih1Lm5vcm0oKSksbD1lLm1tdWwodSkuZGl2KHUudHJhbnNwb3NlKCkubW11bCh1KS5nZXQoMCwwKSkseT4wJiYoYT1sLmNsb25lKCkuc3ViKHApLnBvdygyKS5zdW0oKSkscD1sLmNsb25lKCksdD8oZz10LnRyYW5zcG9zZSgpLm1tdWwobCkuZGl2KGwudHJhbnNwb3NlKCkubW11bChsKS5nZXQoMCwwKSksZz1nLmRpdihnLm5vcm0oKSksaD10Lm1tdWwoZykuZGl2KGcudHJhbnNwb3NlKCkubW11bChnKS5nZXQoMCwwKSkpOmg9bDtpZih0KXtsZXQgeT1lLnRyYW5zcG9zZSgpLm1tdWwobCkuZGl2KGwudHJhbnNwb3NlKCkubW11bChsKS5nZXQoMCwwKSk7eT15LmRpdih5Lm5vcm0oKSk7bGV0IG09ZS5jbG9uZSgpLnN1YihsLmNsb25lKCkubW11bCh5LnRyYW5zcG9zZSgpKSksdz1oLnRyYW5zcG9zZSgpLm1tdWwobCkuZGl2KGwudHJhbnNwb3NlKCkubW11bChsKS5nZXQoMCwwKSksdj10LmNsb25lKCkuc3ViKGwuY2xvbmUoKS5tdWxTKHcuZ2V0KDAsMCkpLm1tdWwoZy50cmFuc3Bvc2UoKSkpO3RoaXMudD1sLHRoaXMucD15LnRyYW5zcG9zZSgpLHRoaXMudz11LnRyYW5zcG9zZSgpLHRoaXMucT1nLHRoaXMudT1oLHRoaXMucz1sLnRyYW5zcG9zZSgpLm1tdWwobCksdGhpcy54UmVzaWR1YWw9bSx0aGlzLnlSZXNpZHVhbD12LHRoaXMuYmV0YXM9d31lbHNlIHRoaXMudz11LnRyYW5zcG9zZSgpLHRoaXMucz1sLnRyYW5zcG9zZSgpLm1tdWwobCkuc3FydCgpLHI/dGhpcy50PWwuY2xvbmUoKS5kaXYodGhpcy5zLmdldCgwLDApKTp0aGlzLnQ9bCx0aGlzLnhSZXNpZHVhbD1lLnN1YihsLm1tdWwodS50cmFuc3Bvc2UoKSkpfX1jbGFzcyBmdHtjb25zdHJ1Y3RvcihlLHM9e30pe2lmKGU9PT0hMCl7Y29uc3QgbD1zO3RoaXMuY2VudGVyPWwuY2VudGVyLHRoaXMuc2NhbGU9bC5zY2FsZSx0aGlzLm1lYW5zPWwubWVhbnMsdGhpcy5zdGRldnM9bC5zdGRldnMsdGhpcy5VPVQuY2hlY2tNYXRyaXgobC5VKSx0aGlzLlM9bC5TLHRoaXMuUj1sLlIsdGhpcy5leGNsdWRlZEZlYXR1cmVzPWwuZXhjbHVkZWRGZWF0dXJlc3x8W107cmV0dXJufWU9bmV3IFQoZSk7Y29uc3R7aXNDb3ZhcmlhbmNlTWF0cml4OnQ9ITEsbWV0aG9kOnI9IlNWRCIsbkNvbXBOSVBBTFM6bz0yLGNlbnRlcjppPSEwLHNjYWxlOmg9ITEsaWdub3JlWmVyb1ZhcmlhbmNlOmE9ITF9PXM7aWYodGhpcy5jZW50ZXI9aSx0aGlzLnNjYWxlPWgsdGhpcy5tZWFucz1udWxsLHRoaXMuc3RkZXZzPW51bGwsdGhpcy5leGNsdWRlZEZlYXR1cmVzPVtdLHQpe3RoaXMuX2NvbXB1dGVGcm9tQ292YXJpYW5jZU1hdHJpeChlKTtyZXR1cm59c3dpdGNoKHRoaXMuX2FkanVzdChlLGEpLHIpe2Nhc2UiY292YXJpYW5jZU1hdHJpeCI6e2NvbnN0IGw9bmV3IGZlKGUpLm1tdWwoZSkuZGl2KGUucm93cy0xKTt0aGlzLl9jb21wdXRlRnJvbUNvdmFyaWFuY2VNYXRyaXgobCk7YnJlYWt9Y2FzZSJOSVBBTFMiOnt0aGlzLl9jb21wdXRlV2l0aE5JUEFMUyhlLG8pO2JyZWFrfWNhc2UiU1ZEIjp7Y29uc3QgbD1uZXcgYWUoZSx7Y29tcHV0ZUxlZnRTaW5ndWxhclZlY3RvcnM6ITEsY29tcHV0ZVJpZ2h0U2luZ3VsYXJWZWN0b3JzOiEwLGF1dG9UcmFuc3Bvc2U6ITB9KTt0aGlzLlU9bC5yaWdodFNpbmd1bGFyVmVjdG9ycztjb25zdCBnPWwuZGlhZ29uYWwsdT1bXTtmb3IoY29uc3QgcCBvZiBnKXUucHVzaChwKnAvKGUucm93cy0xKSk7dGhpcy5TPXU7YnJlYWt9ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoYHVua25vd24gbWV0aG9kOiAke3J9YCl9fXN0YXRpYyBsb2FkKGUpe2lmKHR5cGVvZiBlLm5hbWUhPSJzdHJpbmciKXRocm93IG5ldyBUeXBlRXJyb3IoIm1vZGVsIG11c3QgaGF2ZSBhIG5hbWUgcHJvcGVydHkiKTtpZihlLm5hbWUhPT0iUENBIil0aHJvdyBuZXcgUmFuZ2VFcnJvcihgaW52YWxpZCBtb2RlbDogJHtlLm5hbWV9YCk7cmV0dXJuIG5ldyBmdCghMCxlKX1wcmVkaWN0KGUscz17fSl7Y29uc3R7bkNvbXBvbmVudHM6dD10aGlzLlUuY29sdW1uc309cztpZihlPW5ldyBUKGUpLHRoaXMuY2VudGVyJiYoZS5zdWJSb3dWZWN0b3IodGhpcy5tZWFucyksdGhpcy5zY2FsZSkpe2ZvcihsZXQgbyBvZiB0aGlzLmV4Y2x1ZGVkRmVhdHVyZXMpZS5yZW1vdmVDb2x1bW4obyk7ZS5kaXZSb3dWZWN0b3IodGhpcy5zdGRldnMpfWxldCByPWUubW11bCh0aGlzLlUpO3JldHVybiByLnN1Yk1hdHJpeCgwLHIucm93cy0xLDAsdC0xKX1pbnZlcnQoZSl7ZT1ULmNoZWNrTWF0cml4KGUpO2xldCBzPWUubW11bCh0aGlzLlUudHJhbnNwb3NlKCkpO3JldHVybiB0aGlzLmNlbnRlciYmKHRoaXMuc2NhbGUmJnMubXVsUm93VmVjdG9yKHRoaXMuc3RkZXZzKSxzLmFkZFJvd1ZlY3Rvcih0aGlzLm1lYW5zKSksc31nZXRFeHBsYWluZWRWYXJpYW5jZSgpe2xldCBlPTA7Zm9yKGNvbnN0IHMgb2YgdGhpcy5TKWUrPXM7cmV0dXJuIHRoaXMuUy5tYXAocz0+cy9lKX1nZXRDdW11bGF0aXZlVmFyaWFuY2UoKXtsZXQgZT10aGlzLmdldEV4cGxhaW5lZFZhcmlhbmNlKCk7Zm9yKGxldCBzPTE7czxlLmxlbmd0aDtzKyspZVtzXSs9ZVtzLTFdO3JldHVybiBlfWdldEVpZ2VudmVjdG9ycygpe3JldHVybiB0aGlzLlV9Z2V0RWlnZW52YWx1ZXMoKXtyZXR1cm4gdGhpcy5TfWdldFN0YW5kYXJkRGV2aWF0aW9ucygpe3JldHVybiB0aGlzLlMubWFwKGU9Pk1hdGguc3FydChlKSl9Z2V0TG9hZGluZ3MoKXtyZXR1cm4gdGhpcy5VLnRyYW5zcG9zZSgpfXRvSlNPTigpe3JldHVybntuYW1lOiJQQ0EiLGNlbnRlcjp0aGlzLmNlbnRlcixzY2FsZTp0aGlzLnNjYWxlLG1lYW5zOnRoaXMubWVhbnMsc3RkZXZzOnRoaXMuc3RkZXZzLFU6dGhpcy5VLFM6dGhpcy5TLGV4Y2x1ZGVkRmVhdHVyZXM6dGhpcy5leGNsdWRlZEZlYXR1cmVzfX1fYWRqdXN0KGUscyl7aWYodGhpcy5jZW50ZXIpe2NvbnN0IHQ9ZS5tZWFuKCJjb2x1bW4iKSxyPXRoaXMuc2NhbGU/ZS5zdGFuZGFyZERldmlhdGlvbigiY29sdW1uIix7bWVhbjp0fSk6bnVsbDtpZih0aGlzLm1lYW5zPXQsZS5zdWJSb3dWZWN0b3IodCksdGhpcy5zY2FsZSl7Zm9yKGxldCBvPTA7bzxyLmxlbmd0aDtvKyspaWYocltvXT09PTApaWYocyllLnJlbW92ZUNvbHVtbihvKSxyLnNwbGljZShvLDEpLHRoaXMuZXhjbHVkZWRGZWF0dXJlcy5wdXNoKG8pLG8tLTtlbHNlIHRocm93IG5ldyBSYW5nZUVycm9yKGBDYW5ub3Qgc2NhbGUgdGhlIGRhdGFzZXQgKHN0YW5kYXJkIGRldmlhdGlvbiBpcyB6ZXJvIGF0IGluZGV4ICR7b31gKTt0aGlzLnN0ZGV2cz1yLGUuZGl2Um93VmVjdG9yKHIpfX19X2NvbXB1dGVGcm9tQ292YXJpYW5jZU1hdHJpeChlKXtjb25zdCBzPW5ldyBjZShlLHthc3N1bWVTeW1tZXRyaWM6ITB9KTt0aGlzLlU9cy5laWdlbnZlY3Rvck1hdHJpeCx0aGlzLlUuZmxpcFJvd3MoKSx0aGlzLlM9cy5yZWFsRWlnZW52YWx1ZXMsdGhpcy5TLnJldmVyc2UoKX1fY29tcHV0ZVdpdGhOSVBBTFMoZSxzKXt0aGlzLlU9bmV3IFQocyxlLmNvbHVtbnMpLHRoaXMuUz1bXTtsZXQgdD1lO2ZvcihsZXQgcj0wO3I8cztyKyspe2xldCBvPW5ldyBkZSh0KTt0aGlzLlUuc2V0Um93KHIsby53LnRyYW5zcG9zZSgpKSx0aGlzLlMucHVzaChNYXRoLnBvdyhvLnMuZ2V0KDAsMCksMikpLHQ9by54UmVzaWR1YWx9dGhpcy5VPXRoaXMuVS50cmFuc3Bvc2UoKX19ZnVuY3Rpb24geWUobixlKXtyZXR1cm4gbitNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqKGUtbisxKSl9ZnVuY3Rpb24gYXQobil7bnx8KG49eWUoMCxNYXRoLnBvdygyLDMxKS0xKSksdGhpcy5zZWVkPW4lMjE0NzQ4MzY0Nyx0aGlzLnNlZWQ8PTAmJih0aGlzLnNlZWQrPTIxNDc0ODM2NDYpfWF0LnByb3RvdHlwZS5uZXh0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2VlZD10aGlzLnNlZWQqMTY4MDclMjE0NzQ4MzY0Nyx0aGlzLnNlZWR9LGF0LnByb3RvdHlwZS5uZXh0RmxvYXQ9ZnVuY3Rpb24oKXtyZXR1cm4odGhpcy5uZXh0KCktMSkvMjE0NzQ4MzY0Nn07dmFyIHZlPWF0LFE9e30sRz17S246MTgsWG46Ljk1MDQ3LFluOjEsWm46MS4wODg4Myx0MDouMTM3OTMxMDM0LHQxOi4yMDY4OTY1NTIsdDI6LjEyODQxODU1LHQzOi4wMDg4NTY0NTJ9O2Z1bmN0aW9uIGN0KG4pe3JldHVybiBNYXRoLnJvdW5kKDI1NSoobjw9LjAwMzA0PzEyLjkyKm46MS4wNTUqTWF0aC5wb3cobiwxLzIuNCktLjA1NSkpfWZ1bmN0aW9uIGd0KG4pe3JldHVybihuLz0yNTUpPD0uMDQwNDU/bi8xMi45MjpNYXRoLnBvdygobisuMDU1KS8xLjA1NSwyLjQpfWZ1bmN0aW9uIG10KG4pe3JldHVybiBuPkcudDM/TWF0aC5wb3cobiwxLzMpOm4vRy50MitHLnQwfWZ1bmN0aW9uIE1lKG4pe3ZhciBlPW5bMF0scz1uWzFdLHQ9blsyXTtlPWd0KGUpLHM9Z3QocyksdD1ndCh0KTt2YXIgcj1tdCgoLjQxMjQ1NjQqZSsuMzU3NTc2MSpzKy4xODA0Mzc1KnQpL0cuWG4pLG89bXQoKC4yMTI2NzI5KmUrLjcxNTE1MjIqcysuMDcyMTc1KnQpL0cuWW4pLGk9bXQoKC4wMTkzMzM5KmUrLjExOTE5MipzKy45NTAzMDQxKnQpL0cuWm4pO3JldHVybltyLG8saV19ZnVuY3Rpb24gd3Qobil7cmV0dXJuIG4+Ry50MT9uKm4qbjpHLnQyKihuLUcudDApfWZ1bmN0aW9uIGJ0KG4pe3ZhciBlPW5bMF0scz1uWzFdLHQ9blsyXSxyPShlKzE2KS8xMTYsbz1pc05hTihzKT9yOnIrcy81MDAsaT1pc05hTih0KT9yOnItdC8yMDA7cj1HLlluKnd0KHIpLG89Ry5Ybip3dChvKSxpPUcuWm4qd3QoaSk7dmFyIGg9Y3QoMy4yNDA0NTQyKm8tMS41MzcxMzg1KnItLjQ5ODUzMTQqaSksYT1jdCgtLjk2OTI2NipvKzEuODc2MDEwOCpyKy4wNDE1NTYqaSk7cmV0dXJuIHQ9Y3QoLjA1NTY0MzQqby0uMjA0MDI1OSpyKzEuMDU3MjI1MippKSxbaCxhLHRdfWZ1bmN0aW9uIFNlKG4pe3ZhciBlPU1lKG4pLHM9ZVswXSx0PWVbMV0scj1lWzJdLG89MTE2KnQtMTY7cmV0dXJuW288MD8wOm8sNTAwKihzLXQpLDIwMCoodC1yKV19ZnVuY3Rpb24gYmUobil7dmFyIGU9blswXSxzPW5bMV0sdD1uWzJdO3JldHVybiBlPj0wJiZlPD0yNTUmJnM+PTAmJnM8PTI1NSYmdD49MCYmdDw9MjU1fWZ1bmN0aW9uIHB0KG4pe3JldHVybigiMCIrbi50b1N0cmluZygxNikpLnNsaWNlKC0yKX1mdW5jdGlvbiBqZShuKXt2YXIgZT1idChuKTtyZXR1cm4iIyIrcHQoZVswXSkrcHQoZVsxXSkrcHQoZVsyXSl9dmFyIEVlPTE4MC9NYXRoLlBJO2Z1bmN0aW9uIFJlKG4pe3ZhciBlPW5bMF0scz1uWzFdLHQ9blsyXSxyPU1hdGguc3FydChzKnMrdCp0KSxvPShNYXRoLmF0YW4yKHQscykqRWUrMzYwKSUzNjA7cmV0dXJuIE1hdGgucm91bmQocioxZTQpPT09MCYmKG89TmFOKSxbbyxyLGVdfWZ1bmN0aW9uIGtlKG4sZSl7ZT1lLnNsaWNlKCk7Zm9yKHZhciBzPVtlLnNoaWZ0KCldLHQscixvLGksaCxhLGw7ZS5sZW5ndGg+MDspe2Zvcih0PS0xLHI9LTEvMCxvPTA7bzxlLmxlbmd0aDtvKyspZm9yKGk9ZVtvXSxsPTA7bDxzLmxlbmd0aDtsKyspaD1zW2xdLGE9bihpLGgpLGE+ciYmKHI9YSx0PW8pO3MucHVzaChlW3RdKSxlLnNwbGljZSh0LDEpfXJldHVybiBzfWZ1bmN0aW9uIE5lKG4sZSl7dmFyIHMsdCxyLG89MS8wLGksaD0wLGE9MDtmb3Iocz0wLHI9ZS5sZW5ndGg7czxyO3MrKylmb3IodD1zKzE7dDxyO3QrKylpPW4oZVtzXSxlW3RdKSxpPG8mJihvPWkpLGgrPWksYSsrO3JldHVybnttaW46byxtZWFuOmgvYX19US52YWxpZGF0ZVJnYj1iZSxRLmxhYlRvUmdiPWJ0LFEubGFiVG9SZ2JIZXg9amUsUS5yZ2JUb0xhYj1TZSxRLmxhYlRvSGNsPVJlLFEuZGlmZlNvcnQ9a2UsUS5jb21wdXRlUXVhbGl0eU1ldHJpY3M9TmU7dmFyIGp0PVEsZXQ9e3Byb3Rhbm9wZTp7eDouNzQ2NSx5Oi4yNTM1LG06MS4yNzM0NjMseWludDotLjA3Mzg5NH0sZGV1dGVyYW5vcGU6e3g6MS40LHk6LS40LG06Ljk2ODQzNyx5aW50Oi4wMDMzMzF9LHRyaXRhbm9wZTp7eDouMTc0OCx5OjAsbTouMDYyOTIxLHlpbnQ6LjI5MjExOX19O2Z1bmN0aW9uIFRlKG4sZSl7cmV0dXJuIE1hdGguc3FydChNYXRoLnBvdyhuWzBdLWVbMF0sMikrTWF0aC5wb3coblsxXS1lWzFdLDIpK01hdGgucG93KG5bMl0tZVsyXSwyKSl9ZnVuY3Rpb24gSWUobixlLHMsdCl7Zm9yKHZhciByPXNbMF0sbz10WzBdLGk9c1sxXSxoPXRbMV0sYT1zWzJdLGw9dFsyXSxnPU1hdGguc3FydChNYXRoLnBvdyhpLDIpK01hdGgucG93KGEsMikpLHU9TWF0aC5zcXJ0KE1hdGgucG93KGgsMikrTWF0aC5wb3cobCwyKSkscD1nLXUseT1yLW8sbT1pLWgsdz1hLWwsdj1NYXRoLnNxcnQoTWF0aC5wb3cobSwyKStNYXRoLnBvdyh3LDIpK01hdGgucG93KHAsMikpLGY9TWF0aC5hdGFuMihhLGkpKigxODAvTWF0aC5QSSk7ZjwwOylmKz0zNjA7dmFyIE09TWF0aC5zcXJ0KE1hdGgucG93KGcsNCkvKE1hdGgucG93KGcsNCkrMTkwMCkpLGI9Zj49MTY0JiZmPD0zNDU/LjU2K01hdGguYWJzKC4yKk1hdGguY29zKGYrMTY4KSk6LjM2K01hdGguYWJzKC40Kk1hdGguY29zKGYrMzUpKSxqPXNbMF08MTY/LjUxMTouMDQwOTc1KnIvKDErLjAxNzY1KnIpLFI9LjA2MzgqZy8oMSsuMDEzMSpnKSsuNjM4LEY9UiooTSpiKzEtTSksaz1NYXRoLnNxcnQoTWF0aC5wb3coeS8obipqKSwyKStNYXRoLnBvdyhwLyhlKlIpLDIpK01hdGgucG93KHYvRiwyKSk7cmV0dXJuIGt9ZnVuY3Rpb24geCgpe3RoaXMuY2FjaGU9e319eC5wcm90b3R5cGUuc2ltdWxhdGU9ZnVuY3Rpb24obixlLHMpe3M9c3x8MTt2YXIgdD1uLmpvaW4oIi0iKSsiLSIrZSsiLSIrcyxyPXRoaXMuY2FjaGVbdF07aWYocilyZXR1cm4gcjt2YXIgbz1ldFtlXS54LGk9ZXRbZV0ueSxoPWV0W2VdLm0sYT1ldFtlXS55aW50LGw9anQubGFiVG9SZ2IobiksZz1sWzBdLHU9bFsxXSxwPWxbMl0seT1nLG09dSx3PXAsdj1NYXRoLnBvdyhnLDIuMiksZj1NYXRoLnBvdyh1LDIuMiksTT1NYXRoLnBvdyhwLDIuMiksYj12Ki40MTI0MjQrZiouMzU3NTc5K00qLjE4MDQ2NCxqPXYqLjIxMjY1NitmKi43MTUxNTgrTSouMDcyMTg1NixSPXYqLjAxOTMzMjQrZiouMTE5MTkzK00qLjk1MDQ0NCxGPWIvKGIraitSKSxrPWovKGIraitSKSxOPShrLWkpLyhGLW8pLEk9ay1GKk4sYz0oYS1JKS8oTi1oKSxkPU4qYytJO2I9YypqL2QsUj0oMS0oYytkKSkqai9kO3ZhciBFPS4zMTI3MTMqai8uMzI5MDE2LFM9LjM1ODI3MSpqLy4zMjkwMTYsUD1FLWIsQz1TLVIsej1QKjMuMjQwNzErQyotLjQ5ODU3MSxMPVAqLS45NjkyNTgrQyouMDQxNTU1NyxVPVAqLjA1NTYzNTIrQyoxLjA1NzA3O3k9YiozLjI0MDcxK2oqLTEuNTM3MjYrUiotLjQ5ODU3MSxtPWIqLS45NjkyNTgraioxLjg3NTk5K1IqLjA0MTU1NTcsdz1iKi4wNTU2MzUyK2oqLS4yMDM5OTYrUioxLjA1NzA3O3ZhciBCPSgoeTwwPzA6MSkteSkveixEPSgobTwwPzA6MSktbSkvTCxZPSgodzwwPzA6MSktdykvVSxfPU1hdGgubWF4KEI+MXx8QjwwPzA6QixEPjF8fEQ8MD8wOkQsWT4xfHxZPDA/MDpZKTt5PXkrXyp6LG09bStfKkwsdz13K18qVSx5PU1hdGgucG93KHksMS8yLjIpLG09TWF0aC5wb3cobSwxLzIuMiksdz1NYXRoLnBvdyh3LDEvMi4yKSx5PWcqKDEtcykreSpzLG09dSooMS1zKSttKnMsdz1wKigxLXMpK3cqczt2YXIgJD1beSxtLHddLE89anQucmdiVG9MYWIoJCk7cmV0dXJuIHRoaXMuY2FjaGVbdF09TyxPfSx4LnByb3RvdHlwZS5ldWNsaWRlYW49VGUseC5wcm90b3R5cGUuY21jPUllLmJpbmQobnVsbCwyLDEpLHgucHJvdG90eXBlLmNvbG9yYmxpbmQ9ZnVuY3Rpb24obixlLHMpe3JldHVybiBlPXRoaXMuc2ltdWxhdGUoZSxuKSxzPXRoaXMuc2ltdWxhdGUocyxuKSx0aGlzLmNtYyhlLHMpfSxPYmplY3Qua2V5cyhldCkuZm9yRWFjaChmdW5jdGlvbihuKXt4LnByb3RvdHlwZVtuXT1mdW5jdGlvbihlLHMpe3JldHVybiB0aGlzLmNvbG9yYmxpbmQobixlLHMpfX0pO3ZhciBxZT0xZTMrMTAwKzUwMCsxO3gucHJvdG90eXBlLmNvbXByb21pc2U9ZnVuY3Rpb24obixlKXt2YXIgcz0wLHQ9dGhpcy5jbWMobixlKTtyZXR1cm4gcys9dCoxZTMsdD10aGlzLmNvbG9yYmxpbmQoInByb3Rhbm9wZSIsbixlKSxpc05hTih0KXx8KHMrPXQqMTAwKSx0PXRoaXMuY29sb3JibGluZCgiZGV1dGVyYW5vcGUiLG4sZSksaXNOYU4odCl8fChzKz10KjUwMCksdD10aGlzLmNvbG9yYmxpbmQoInRyaXRhbm9wZSIsbixlKSxpc05hTih0KXx8KHMrPXQqMSkscy9xZX0seC5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKG4pe3JldHVybiBuIGluIGV0P3RoaXMuY29sb3JibGluZC5iaW5kKHRoaXMsbik6dGhpc1tuXS5iaW5kKHRoaXMpfTt2YXIgRmU9eCwkZT17YWxsOlswLDM2MCwwLDEwMCwwLDEwMF0sZGVmYXVsdDpbMCwzNjAsMzAsODAsMzUsODBdLGNvbG9yYmxpbmQ6WzAsMzYwLDQwLDcwLDE1LDg1XSwiZmFuY3ktbGlnaHQiOlswLDM2MCwxNSw0MCw3MCwxMDBdLCJmYW5jeS1kYXJrIjpbMCwzNjAsOCw0MCw3LDQwXSxzaGFkZXM6WzAsMjQwLDAsMTUsMCwxMDBdLHRhcm5pc2g6WzAsMzYwLDAsMTUsMzAsNzBdLHBhc3RlbDpbMCwzNjAsMCwzMCw3MCwxMDBdLHBpbXA6WzAsMzYwLDMwLDEwMCwyNSw3MF0saW50ZW5zZTpbMCwzNjAsMjAsMTAwLDE1LDgwXSxmbHVvOlswLDMwMCwzNSwxMDAsNzUsMTAwXSwicmVkLXJvc2VzIjpbMzMwLDIwLDEwLDEwMCwzNSwxMDBdLCJvY2hyZS1zYW5kIjpbMjAsNjAsMjAsNTAsMzUsMTAwXSwieWVsbG93LWxpbWUiOls2MCw5MCwxMCwxMDAsMzUsMTAwXSwiZ3JlZW4tbWludCI6WzkwLDE1MCwxMCwxMDAsMzUsMTAwXSwiaWNlLWN1YmUiOlsxNTAsMjAwLDAsMTAwLDM1LDEwMF0sImJsdWUtb2NlYW4iOlsyMjAsMjYwLDgsODAsMCw1MF0sImluZGlnby1uaWdodCI6WzI2MCwyOTAsNDAsMTAwLDM1LDEwMF0sInB1cnBsZS13aW5lIjpbMjkwLDMzMCwwLDEwMCwwLDQwXX0sQ2U9JGUsUGU9dmUsemU9RmUsc3Q9USxFdD1DZSxMZT1zdC52YWxpZGF0ZVJnYix1dD1zdC5sYWJUb1JnYixEZT1zdC5sYWJUb1JnYkhleCxSdD1zdC5sYWJUb0hjbCxVZT1zdC5kaWZmU29ydCxPZT17YXR0ZW1wdHM6MSxjb2xvckZpbHRlcjpudWxsLGNvbG9yU3BhY2U6ImRlZmF1bHQiLGNsdXN0ZXJpbmc6ImstbWVhbnMiLHF1YWxpdHk6NTAsdWx0cmFQcmVjaXNpb246ITEsZGlzdGFuY2U6ImV1Y2xpZGVhbiIsc2VlZDpudWxsfSxWZT1uZXcgU2V0KFsiZm9yY2UtdmVjdG9yIiwiay1tZWFucyJdKSxCZT1uZXcgU2V0KFsiZXVjbGlkZWFuIiwiY21jIiwiY29tcHJvbWlzZSIsInByb3Rhbm9wZSIsImRldXRlcmFub3BlIiwidHJpdGFub3BlIl0pLFllPW5ldyBTZXQoT2JqZWN0LmtleXMoRXQpKTtmdW5jdGlvbiBfZShuKXtmb3IodmFyIGU9MCxzPTAsdD1uLmxlbmd0aDtzPHQ7cysrKWUrPW4uY2hhckNvZGVBdChzKTtyZXR1cm4gZX1mdW5jdGlvbiBYZShuKXt2YXIgZT1PYmplY3QuYXNzaWduKHt9LE9lLG4pO2lmKHR5cGVvZiBlLmF0dGVtcHRzIT0ibnVtYmVyInx8ZS5hdHRlbXB0czw9MCl0aHJvdyBuZXcgRXJyb3IoIml3YW50aHVlOiBpbnZhbGlkIGBhdHRlbXB0c2Agc2V0dGluZy4gRXhwZWN0aW5nIGEgcG9zaXRpdmUgbnVtYmVyLiIpO2lmKGUuY29sb3JGaWx0ZXImJnR5cGVvZiBlLmNvbG9yRmlsdGVyIT0iZnVuY3Rpb24iKXRocm93IG5ldyBFcnJvcigiaXdhbnRodWU6IGludmFsaWQgYGNvbG9yRmlsdGVyYCBzZXR0aW5nLiBFeHBlY3RpbmcgYSBmdW5jdGlvbi4iKTtpZighVmUuaGFzKGUuY2x1c3RlcmluZykpdGhyb3cgbmV3IEVycm9yKCdpd2FudGh1ZTogdW5rbm93biBgY2x1c3RlcmluZ2AgIicrZS5jbHVzdGVyaW5nKyciLicpO2lmKHR5cGVvZiBlLnF1YWxpdHkhPSJudW1iZXIifHxpc05hTihlLnF1YWxpdHkpfHxlLnF1YWxpdHk8MSl0aHJvdyBuZXcgRXJyb3IoIml3YW50aHVlOiBpbnZhbGlkIGBxdWFsaXR5YC4gRXhwZWN0aW5nIGEgbnVtYmVyID4gMC4iKTtpZih0eXBlb2YgZS51bHRyYVByZWNpc2lvbiE9ImJvb2xlYW4iKXRocm93IG5ldyBFcnJvcigiaXdhbnRodWU6IGludmFsaWQgYHVsdHJhUHJlY2lzaW9uYC4gRXhwZWN0aW5nIGEgYm9vbGVhbi4iKTtpZighQmUuaGFzKGUuZGlzdGFuY2UpKXRocm93IG5ldyBFcnJvcignaXdhbnRodWU6IHVua25vd24gYGRpc3RhbmNlYCAiJytlLmRpc3RhbmNlKyciLicpO2lmKHR5cGVvZiBlLnNlZWQ9PSJzdHJpbmciJiYoZS5zZWVkPV9lKGUuc2VlZCkpLGUuc2VlZCE9PW51bGwmJnR5cGVvZiBlLnNlZWQhPSJudW1iZXIiKXRocm93IG5ldyBFcnJvcigiaXdhbnRodWU6IGludmFsaWQgYHNlZWRgLiBFeHBlY3RpbmcgYW4gaW50ZWdlciBvciBhIHN0cmluZy4iKTtpZighZS5jb2xvckZpbHRlciYmZS5jb2xvclNwYWNlJiZlLmNvbG9yU3BhY2UhPT0iYWxsIil7dmFyIHM7aWYodHlwZW9mIGUuY29sb3JTcGFjZT09InN0cmluZyIpe2lmKCFZZS5oYXMoZS5jb2xvclNwYWNlKSl0aHJvdyBuZXcgRXJyb3IoJ2l3YW50aHVlOiB1bmtub3duIGBjb2xvclNwYWNlYCAiJytlLmNvbG9yU3BhY2UrJyIuJyk7cz1FdFtlLmNvbG9yU3BhY2VdfWVsc2UgaWYoQXJyYXkuaXNBcnJheShlLmNvbG9yU3BhY2UpKXtpZihlLmNvbG9yU3BhY2UubGVuZ3RoIT09Nil0aHJvdyBuZXcgRXJyb3IoIml3YW50aHVlOiBleHBlY3RpbmcgYSBgY29sb3JTcGFjZWAgYXJyYXkgb2YgbGVuZ3RoIDYgKFtobWluLCBobWF4LCBjbWluLCBjbWF4LCBsbWluLCBsbWF4XSkuIik7cz1lLmNvbG9yU3BhY2V9ZWxzZSBzPVtlLmNvbG9yU3BhY2UuaG1pbnx8MCxlLmNvbG9yU3BhY2UuaG1heHx8MzYwLGUuY29sb3JTcGFjZS5jbWlufHwwLGUuY29sb3JTcGFjZS5jbWF4fHwxMDAsZS5jb2xvclNwYWNlLmxtaW58fDAsZS5jb2xvclNwYWNlLmxtYXh8fDEwMF07c1swXTxzWzFdP2UuY29sb3JGaWx0ZXI9ZnVuY3Rpb24odCxyKXt2YXIgbz1SdChyKTtyZXR1cm4gb1swXT49c1swXSYmb1swXTw9c1sxXSYmb1sxXT49c1syXSYmb1sxXTw9c1szXSYmb1syXT49c1s0XSYmb1syXTw9c1s1XX06ZS5jb2xvckZpbHRlcj1mdW5jdGlvbih0LHIpe3ZhciBvPVJ0KHIpO3JldHVybihvWzBdPj1zWzBdfHxvWzBdPD1zWzFdKSYmb1sxXT49c1syXSYmb1sxXTw9c1szXSYmb1syXT49c1s0XSYmb1syXTw9c1s1XX19cmV0dXJuIGV9ZnVuY3Rpb24gWmUobixlLHMpe2Zvcih2YXIgdD1uZXcgQXJyYXkoZSkscixvLGk9MDtpPGU7aSsrKXtkbyByPVsxMDAqbigpLDEwMCooMipuKCktMSksMTAwKigyKm4oKS0xKV0sbz11dChyKTt3aGlsZSghcyhvLHIpKTt0W2ldPXJ9cmV0dXJuIHR9dmFyIEdlPTEwMCxrdD0xMDA7ZnVuY3Rpb24gV2UobixlLHMsdCxyKXtmb3IodmFyIG89bmV3IEFycmF5KHQubGVuZ3RoKSxpPXIucXVhbGl0eSoyMCxoLGEsbD10Lmxlbmd0aCxnLHUscCx5LG0sdyx2LGYsTSxiLGosUjtpLS0gPjA7KXtmb3IoaD0wO2g8bDtoKyspb1toXT17ZGw6MCxkYTowLGRiOjB9O2ZvcihoPTA7aDxsO2grKylmb3IoZz10W2hdLGE9MDthPGg7YSsrKXU9dFthXSxwPWUoZyx1KSxwPjA/KHk9Z1swXS11WzBdLG09Z1sxXS11WzFdLHc9Z1syXS11WzJdLHY9R2UvTWF0aC5wb3cocCwyKSxvW2hdLmRsKz15KnYvcCxvW2hdLmRhKz1tKnYvcCxvW2hdLmRiKz13KnYvcCxvW2FdLmRsLT15KnYvcCxvW2FdLmRhLT1tKnYvcCxvW2FdLmRiLT13KnYvcCk6KG9bYV0uZGwrPTItNCpuKCksb1thXS5kYSs9Mi00Km4oKSxvW2FdLmRiKz0yLTQqbigpKTtmb3IoaD0wO2g8bDtoKyspTT10W2hdLGo9a3QqTWF0aC5zcXJ0KE1hdGgucG93KG9baF0uZGwsMikrTWF0aC5wb3cob1toXS5kYSwyKStNYXRoLnBvdyhvW2hdLmRiLDIpKSxqPjAmJihiPWt0Kk1hdGgubWluKC4xLGopL2osZj1bTVswXStvW2hdLmRsKmIsTVsxXStvW2hdLmRhKmIsTVsyXStvW2hdLmRiKmJdLFI9dXQoZikscyhSLGYpJiYodFtoXT1mKSl9fWZ1bmN0aW9uIEplKG4sZSxzLHQpe3ZhciByPVtdLG89W10saSxoLGEsbCxnLHU9NSxwPTEwLHk9MTA7Zm9yKHQudWx0cmFQcmVjaXNpb24mJih1PTEscD01LHk9NSksaT0wO2k8PTEwMDtpKz11KWZvcihoPS0xMDA7aDw9MTAwO2grPXApZm9yKGE9LTEwMDthPD0xMDA7YSs9eSlsPVtpLGgsYV0sZz11dChsKSwhIWUoZyxsKSYmKHIucHVzaChsKSxvLnB1c2gobnVsbCkpO2Zvcih2YXIgbT10LnF1YWxpdHksdyx2LGYsTSxiPXIubGVuZ3RoLGo9cy5sZW5ndGgsUixGLGssTixJLGM7bS0tID4wOyl7Zm9yKHc9MDt3PGI7dysrKWZvcihNPXJbd10sRj0xLzAsdj0wO3Y8ajt2KyspZj1zW3ZdLFI9bihmLE0pLFI8RiYmKEY9UixvW3ddPXYpO2ZvcihrPXIuc2xpY2UoKSx2PTA7djxqO3YrKyl7Zm9yKE49MCxJPVswLDAsMF0sdz0wO3c8Yjt3Kyspb1t3XT09PXYmJihOKyssSVswXSs9clt3XVswXSxJWzFdKz1yW3ddWzFdLElbMl0rPXJbd11bMl0pO2lmKE4hPT0wKWlmKElbMF0vPU4sSVsxXS89TixJWzJdLz1OLGc9dXQoSSksZShnLEkpKXNbdl09STtlbHNle2lmKGsubGVuZ3RoPjApe2ZvcihGPTEvMCxjPS0xLHc9MDt3PGsubGVuZ3RoO3crKylSPW4oa1t3XSxJKSxSPEYmJihGPVIsYz13KTtzW3ZdPXJbY119ZWxzZXtmb3IoRj0xLzAsYz0tMSx3PTA7dzxyLmxlbmd0aDt3KyspUj1uKHJbd10sSSksUjxGJiYoRj1SLGM9dyk7c1t2XT1yW2NdfWs9ay5maWx0ZXIoZnVuY3Rpb24oZCl7cmV0dXJuIGRbMF0hPT1zW3ZdWzBdfHxkWzFdIT09c1t2XVsxXXx8ZFsyXSE9PXNbdl1bMl19KX19fXJldHVybiBzfXZhciBOdD1mdW5jdGlvbihlLHMpe2lmKHR5cGVvZiBlIT0ibnVtYmVyInx8ZTwyKXRocm93IG5ldyBFcnJvcigiaXdhbnRodWU6IGV4cGVjdGluZyBhIGNvbG9yIGNvdW50ID4gMi4iKTtzPVhlKHMpO2Zvcih2YXIgdD1uZXcgUGUocy5zZWVkKSxyPWZ1bmN0aW9uKCl7cmV0dXJuIHQubmV4dEZsb2F0KCl9LG89bmV3IHplLGk9by5nZXQocy5kaXN0YW5jZSksaD1mdW5jdGlvbih5LG0pe3JldHVybiBMZSh5KT9zLmNvbG9yRmlsdGVyPyEhcy5jb2xvckZpbHRlcih5LG0pOiEwOiExfSxhPXMuYXR0ZW1wdHMsbCxnLHU9LTEvMCxwO2E+MDspbD1aZShyLGUsaCkscy5jbHVzdGVyaW5nPT09ImZvcmNlLXZlY3RvciI/V2UocixpLGgsbCxzKTpKZShpLGgsbCxzKSxnPXN0LmNvbXB1dGVRdWFsaXR5TWV0cmljcyhpLGwpLGcubWluPnUmJih1PWcubWluLHA9bCksYS0tO3JldHVybiBsPXAsbD1VZShpLGwpLGwubWFwKERlKX07ZnVuY3Rpb24gUWUobil7cmV0dXJuIG49PT0xP1tOdCgyKVswXV06TnQobix7c2VlZDoxfSl9ZnVuY3Rpb24gS2Uobil7cmV0dXJuIHR5cGVvZiBuPT0ibnVtYmVyIiYmIWlzTmFOKG4pfWZ1bmN0aW9uIHhlKG4sZT1bXSxzPVtdKXtjb25zdCB0PShnLHUpPT5lLmluY2x1ZGVzKGcpP3U6dm9pZCAwO2xldCByPVtdO2UubGVuZ3RoPjAmJihyPWUubWFwKHQpLmZpbHRlcihLZSkpO2NvbnN0IG89KGcsdSk9PnIuaW5jbHVkZXModSksaT1nPT5wYXJzZUZsb2F0KGcpLGg9Zz0+e2NvbnN0Wyx1XT1nO2xldCBwPXU7cmV0dXJuIGUmJnIubGVuZ3RoPjAmJihwPXUuZmlsdGVyKG8pKSxwLm1hcChpKX07cmV0dXJuIHMubWFwKGc9PltnLG5bZ11dKS5tYXAoaCl9ZnVuY3Rpb24gQWUobil7cmV0dXJuIG4ubWFwKGU9Pntjb25zdCBzPSR0KGUpLHQ9cXQoZSk7cmV0dXJuIHQ9PT0wP2U6ZS5tYXAobz0+KG8tcykvdCl9KX1jb25zdCBUdD1uPT4oTWF0aC5yb3VuZChuKjFlMykvMWUzKS50b0ZpeGVkKDMpO2Z1bmN0aW9uIEhlKG4sZSxzLHQscixvLGk9ITEpe2xldCBoPXhlKG4sZSxzKTtyJiYoaD1BZShoKSksaXx8KGg9Q3QoaCkpO2NvbnN0IGE9bmV3IGZ0KGgse2NlbnRlcjohMSxzY2FsZTohMX0pLGw9YS5wcmVkaWN0KGgpLHU9KGk/czplKS5yZWR1Y2UoKHYsZixNKT0+e2NvbnN0IGI9Zi5zcGxpdCh0KSxqPWk/ZjpgJHtiWzBdfSR7dH0ke2JbMV19YDtyZXR1cm4gdltqXT8odltqXS54LnB1c2gobC5nZXRSb3coTSlbMF0pLHZbal0ueS5wdXNoKGwuZ2V0Um93KE0pWzFdKSx2W2pdLnRleHQucHVzaChmKSk6dltqXT17eDpbbC5nZXRSb3coTSlbMF1dLHk6W2wuZ2V0Um93KE0pWzFdXSx0eXBlOiJzY2F0dGVyIixtb2RlOiJtYXJrZXJzIixtYXJrZXI6e3NpemU6OX0sbmFtZTpqKyIgICAgICAgIix0ZXh0OltmXSx0ZXh0Zm9udDp7ZmFtaWx5OiJUaW1lcyBOZXcgUm9tYW4ifSx0ZXh0cG9zaXRpb246ImJvdHRvbSBjZW50ZXIifSx2fSx7fSkscD1RZShPYmplY3Qua2V5cyh1KS5sZW5ndGgpLHk9T2JqZWN0LnZhbHVlcyh1KSxtPWEuZ2V0RXhwbGFpbmVkVmFyaWFuY2UoKSx3PXt0aXRsZTp7dGV4dDpvLGZvbnQ6e3NpemU6MjB9fSx4YXhpczp7dGl0bGU6e3RleHQ6YFBDLTEgKGZyYWN0aW9uIG9mIHZhcmlhbmNlIGV4cGxhaW5lZDogfiR7VHQobVswXSl9KWB9fSx5YXhpczp7dGl0bGU6e3RleHQ6YFBDLTIgKGZyYWN0aW9uIG9mIHZhcmlhbmNlIGV4cGxhaW5lZDogfiR7VHQobVsxXSl9KWB9fSxzaG93bGVnZW5kOiEwLGF1dG9zaXplOiEwLGhvdmVybW9kZToiY2xvc2VzdCIsY29sb3J3YXk6cH07cmV0dXJue2RhdGE6eSxsYXlvdXQ6d319b25tZXNzYWdlPWZ1bmN0aW9uKG4pe2NvbnN0e2RhdGFSb3dzOmUsc3JjUmVwbGljYXRlTmFtZXM6cyxzcmNBY2Nlc3Npb25JZHM6dCxtdWx0aUhlYWRlclNlcDpyLHRyYW5zcG9zZTpvLHBsb3RUaXRsZTppLHpUcmFuc2Zvcm06aH09bi5kYXRhLGE9SGUoZSxzLHQscixoLGksbyk7cG9zdE1lc3NhZ2UoYSx2b2lkIDApfX0pKCk7fSkoKTsK",Jl=typeof window!="undefined"&&window.Blob&&new Blob([atob(wl)],{type:"text/javascript;charset=utf-8"});function Ra(){const t=Jl&&(window.URL||window.webkitURL).createObjectURL(Jl);try{return t?new Worker(t):new Worker("data:application/javascript;base64,"+wl,{type:"module"})}finally{t&&(window.URL||window.webkitURL).revokeObjectURL(t)}}const Ta=(t,l)=>{const c=[];return t.forEach(a=>{const n=S.getRowAsTree(a),o=[[],[]],i=[],d=[];K.groupOrder.forEach(s=>{K.sampleOrder.forEach(m=>{const b=n[s][m];b&&(o[0].push(s),o[1].push(m),i.push(tt(b)),d.push(Zt(b)))})}),c.push({x:o,y:i,error_y:{type:"data",array:d,visible:!0},type:"bar",name:a,showlegend:l.showlegend})}),c};function Ma(t){t.setAttribute("xlink","http://www.w3.org/1999/xlink");const l=Ya(t),c=document.createElement("style");c.setAttribute("type","text/css"),c.innerHTML=l;const a=t.hasChildNodes()?t.children[0]:null;t.insertBefore(c,a);let o=new XMLSerializer().serializeToString(t);return o=o.replace(/(\w+)?:?xlink=/g,"xmlns:xlink="),o=o.replace(/NS\d+:href/g,"xlink:href"),o}function Ya(t){const l=[];l.push("#"+t.id);for(let n=0;n<t.classList.length;n++)Bt("."+t.classList[n],l)||l.push("."+t.classList[n]);const c=t.getElementsByTagName("*");for(let n=0;n<c.length;n++){const o=c[n].id;Bt("#"+o,l)||l.push("#"+o);const i=c[n].classList;for(let d=0;d<i.length;d++)Bt("."+i[d],l)||l.push("."+i[d])}let a="";for(let n=0;n<document.styleSheets.length;n++){const o=document.styleSheets[n];try{if(!o.cssRules)continue}catch(d){if(d.name!=="SecurityError")throw d;continue}const i=o.cssRules;for(let d=0;d<i.length;d++){const s=i[d];Bt(s.selectorText,l)&&(a+=i[d].cssText)}}return a}function Bt(t,l){return l.indexOf(t)!==-1}const bt=n=>{var o=n,{status:t,figureRef:l,plotType:c}=o,a=j(o,["status","figureRef","plotType"]);const i=()=>{var y;const s=(y=l==null?void 0:l.current)==null?void 0:y.getElementsByClassName("main-svg")[0],m=s?Ma(s):"",b=new Blob([m],{type:"image/svg+xml"});tl.exports.saveAs(b,"plot.svg")},d=()=>{J.deletePlot(a.id)};return e.createElement(g,x({_focus:{outline:"none",border:"1px solid",borderColor:"orange.600"},as:"figure",alignItems:"center",backgroundColor:"white",border:"1px solid",borderColor:"transparent",boxShadow:"sm",flexDirection:"column",justifyContent:"center",margin:3,overflow:"hidden",height:800,padding:6,position:"relative",ref:s=>l?l.current=s:s,resize:"horizontal",role:"group",tabIndex:0,width:"100%"},a),t==="idle"?e.createElement(e.Fragment,null,(c==="heatmap"||c==="image")&&e.createElement(I,{_focusWithin:{"& button":{visibility:"visible"}},"aria-label":"Plot actions",as:"section",left:5,position:"absolute",top:5},c==="heatmap"&&e.createElement(Ze,{_focus:{border:"1px solid",borderColor:"orange.600",color:"orange.600",outline:"none",visibility:"visible"},_groupFocus:{visibility:"visible"},_groupHover:{visibility:"visible"},_hover:{color:"orange.600"},"aria-label":"Download plot",color:"gray.600",icon:e.createElement(Xl,null),variant:"outline",size:"lg",onClick:i,visibility:"hidden",zIndex:"modal"}),e.createElement(Ze,{_focus:{border:"1px solid",borderColor:"orange.600",color:"orange.600",outline:"none",visibility:"visible"},_groupFocus:{visibility:"visible"},_groupHover:{visibility:"visible"},_hover:{color:"orange.600"},"aria-label":"Delete plot",color:"gray.600",icon:e.createElement(Pt,null),marginLeft:2,size:"lg",variant:"outline",onClick:d,visibility:"hidden",zIndex:"overlay"})),a.children):e.createElement(st,{thickness:"4px",speed:"0.65s",emptyColor:"gray.200",color:"blue.500",size:"xl"}))},Nt=["#c7566f","#57bf67","#845ec9","#90b83d","#d3a333","#c363ab","#4a7c38","#adab63","#698ccc","#c94f32","#826627","#52b8a4","#d88e61"],fl=Te.exports.createContext({hoveredGene:""}),Pa=t=>{const[l,c]=e.useState(""),a=e.useRef(null),n=e.useRef(null),o=e.useRef(),[i,d]=e.useState({title:{text:t.options.plotTitle,font:{size:20},y:.9},showlegend:t.options.showlegend,legend:{orientation:"h",x:0,y:-.5},yaxis:{title:{text:`count [${K.unit}]`},hoverformat:".2f"},autosize:!0,colorway:Nt}),s={toImageButtonOptions:{format:"svg",filename:"plot"},displaylogo:!1,modeBarButtonsToRemove:["zoom2d","pan2d","select2d","lasso2d","zoomIn2d","zoomOut2d","autoScale2d","resetScale2d","hoverClosestCartesian","hoverCompareCartesian","hoverClosestGl2d","hoverClosestPie","toggleHover","resetViews","sendDataToCloud","toggleSpikelines"],modeBarButtonsToAdd:[{title:"Delete plot",name:"Delete plot",icon:{width:21,height:21,path:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"},click:()=>{J.deletePlot(t.id)}}]};e.useEffect(function(){let h;const u=n.current,r=new ResizeObserver(z=>{clearTimeout(o.current),h=window.setTimeout(()=>{d(L=>F(x({},L),{width:z[0].target.clientWidth}))},250),o.current=h});return u&&r.observe(u),()=>{u&&r.unobserve(u),h&&clearTimeout(h)}},[]);const m=y=>{var r;const{points:h}=y;if(h.length!==1||((r=t.accessions)==null?void 0:r.length)<=1)return;const u=h[0].data.name;c(u)},b=()=>{c("")};return e.createElement(fl.Provider,{value:{hoveredGene:l}},e.createElement(bt,{status:"idle",figureRef:n,id:t.id},e.createElement(Kl,{ref:y=>a.current=y,data:t.data,layout:i,config:s,onHover:m,onUnhover:b,style:{width:"100%",height:"100%"}}),e.createElement(I,{marginX:"12",width:"full",overflow:"auto",flexShrink:3},t.children)))};var ka=ht(Pa);const wa=(t,l)=>{const c=[];return t.forEach((a,n)=>{const o=S.getRowAsTree(a),i={color:Nt[n]};K.groupOrder.forEach((d,s)=>{const m=[[],[]],b=[],y=[];K.sampleOrder.forEach(h=>{const u=o[d][h];u&&(m[0].push(d),m[1].push(h),b.push(tt(u)),y.push(Zt(u)))}),c.push({x:m,y:b,error_y:{type:"data",array:y,visible:!0},name:a,type:"scatter",showlegend:s>0?!1:l.showlegend,line:i})})}),c},Ja=(t,l)=>{const c=S.getRowAsTree(t),a=[];return K.groupOrder.forEach(n=>{const o=[[],[]],i=[],d=[];K.sampleOrder.forEach(s=>{const m=c[n][s];m&&(o[0].push(n),o[1].push(s),i.push(tt(m)),d.push(Zt(m)))}),a.push({x:o,y:i,error_y:{type:"data",array:d,visible:!0},type:"scatter",name:n,showlegend:l.showlegend})}),a},fa=(t,l)=>{const c=S.getRowAsTree(t),a=[];return K.groupOrder.forEach(n=>{const o=[[],[]],i=[],d=[];K.sampleOrder.forEach(s=>{const m=c[n][s];m&&(o[0].push(n),o[1].push(s),i.push(tt(m)),d.push(Zt(m)))}),a.push({x:o,y:i,error_y:{type:"data",array:d,visible:!0},type:"bar",name:n,showlegend:l.showlegend})}),a},Ba=["solid","dot","dash","longdash","dashdot","longdashdot"],Na=["circle","square","diamond","cross","triangle-up","pentagon"],Qa=(t,l)=>{const c=[];let a=0,n=0;return t.forEach(o=>{const i=S.getRowAsTree(o);K.groupOrder.forEach(d=>{const s=[],m=[],b=[];l.colorBy==="group"?a++:n++,K.sampleOrder.forEach(y=>{const h=i[d][y];h&&(s.push(y),m.push(tt(h)),b.push(Zt(h)))}),c.push({x:s,y:m,error_y:{type:"data",array:b,visible:!0},name:t.length>1?`${d} - ${o}`:d,type:"scatter",showlegend:l.showlegend,line:t.length>1?{color:Nt[a],dash:Ba[n]}:{},marker:t.length>1?{symbol:Na[n]}:{}})}),l.colorBy==="group"?(a=0,n++):(a++,n=0)}),c};async function Bl(t){const l=new DOMParser,a=await(await fetch(t)).text();return l.parseFromString(a,"application/xml")}function Ea(t){var a,n;const l=(a=t.attributes.getNamedItem("x"))==null?void 0:a.nodeValue,c=(n=t.attributes.getNamedItem("y"))==null?void 0:n.nodeValue;if(!l||!c)throw new Error("Missing coordinates in DataArea");return{x:parseInt(l),y:parseInt(c)}}function Fa(t){var a,n;const l=[],c=t.getElementsByTagName("Identifier");for(let o=0;o<c.length;o++){const i=(a=c[o].attributes.getNamedItem("id"))==null?void 0:a.nodeValue,d=(n=c[o].attributes.getNamedItem("recursive"))==null?void 0:n.nodeValue;if(!i||!d)throw new Error("Missing attribues in Identifier");l.push({id:i,recursive:JSON.parse(d)})}return l}function Ua(t){var n;const l=(n=t.attributes.getNamedItem("blockFormat"))==null?void 0:n.nodeValue,c=l==null?void 0:l.substr(0,1),a=l==null?void 0:l.substr(1);if(c&&c!=="x"&&c!=="y")throw new Error(`unallowed blockFormat type ${c}`);return c&&c==="x"&&a?{bformat:"x",fnumber:parseInt(a)}:c&&c==="y"&&a?{bformat:"y",fnumber:parseInt(a)}:{bformat:"x",fnumber:5}}async function Oa(t,l,c,a,n){var D,le,ce,ye,Xe,Ke,Se,ze,Le,se,me,xe;const o=5,[i,d]=n?n.split(S.config.multiHeader):[void 0,void 0],s=a==="expressionValue"&&i&&d?S.getMapManMeanValues(i,d):R.getColumn(a),m=await Bl(`mapman-templates/${t}.xml`),b=await Bl(`mapman-templates/${t}.svg`),y=parseInt((ce=(le=(D=b.firstElementChild)==null?void 0:D.attributes.getNamedItem("width"))==null?void 0:le.nodeValue)!=null?ce:"1024"),h=parseInt((Ke=(Xe=(ye=b.firstElementChild)==null?void 0:ye.attributes.getNamedItem("height"))==null?void 0:Xe.nodeValue)!=null?Ke:"800"),u=m.querySelectorAll("DataArea"),r=[],z=[],L=[];u.forEach(ve=>{const{x:C,y:T}=Ea(ve),{bformat:P,fnumber:M}=Ua(ve),G=Fa(ve),W={},N=R.getGenesForMapManBin(l,c,G[0].id,G[0].recursive);let Q=0,H=0;N.forEach(U=>{const w=parseFloat(s[U]);z.push(w),W[U]=w;const Ce=P==="x"?C+Q%M*o:C+Q*o,be=P==="y"?T+H%M*o:T+H*o;L.push({geneId:U,bin:G[0].id,value:w,x:Ce,y:be,xOffset:P==="x"?Q%M:Q,yOffset:P==="y"?H%M:H}),P==="x"?Q++:H++,P==="x"&&Q!=0&&Q%M==0?H++:P==="y"&&H!=0&&H%M==0&&Q++}),r.push({bincode:G[0].id,x:C,y:T,bformat:P,fnumber:M,geneValues:W})});const E=(Se=sc(z))!=null?Se:0,V=(ze=Ll(z,.25))!=null?ze:0,X=(Le=mc(z))!=null?Le:0,Y=(se=tt(z))!=null?se:0,O=(me=Ll(z,.75))!=null?me:0,te=(xe=bc(z))!=null?xe:0;return{rects:L,stats:{min:E,q1:V,median:X,mean:Y,q3:O,max:te},width:y,height:h}}class ja{constructor(){Pe(this,"plots",[]);Pe(this,"_image",null);Pe(this,"countUnit",null);Yt(this)}loadCountUnit(l){this.countUnit=l}get hasPlots(){return this.plots.length>0}clearPlots(){this.plots=[]}deletePlot(l){const c=this.plots.findIndex(a=>a.id===l);if(c>-1){const a=this.plots[c];if(a.type==="image"){const n=a;URL.revokeObjectURL(n.src)}this.plots.splice(c,1)}}toJSObject(l){const c=this.plots.find(n=>n.id===l);if(c){const a=c,{id:n,isLoading:o}=a;return j(a,["id","isLoading"])}}plotNamesForExport(){return this.plots.length>0?this.plots.map(l=>`plots/${l.id}_${l.type}.json`):void 0}addRawPlot(l){this.plots.push(l)}addHeatmapPlot({plotTitle:l,accessions:c,distanceMethod:a,replicates:n,clusterBy:o,zTransform:i}){const d=re(),s=o!=="replicates",m={id:d,type:"heatmap",isLoading:!0},b=this.plots.push(m)-1,y=new va,h={dataRows:ll(S.rows),distanceMethod:a,srcReplicateNames:(n==null?void 0:n.length)?n:S.colNames,srcAccessionIds:(c==null?void 0:c.length)?c:S.rowNames,transpose:s,zTransform:i};y.postMessage(h),y.onmessage=function(u){kt(()=>{const r=F(x({},J.plots[b]),{isLoading:!1,binData:u.data.bins,tree:u.data.tree,distanceMethod:a,plotTitle:l,zTransform:i});J.plots[b].id===d&&(J.plots[b]=r)})}}addImagePlot(l,c){const a={alt:c,id:re(),isLoading:!1,type:"image",src:l};this.plots.push(a)}addPCAPlot({plotTitle:l,accessions:c,replicates:a,calculateFor:n,zTransform:o}){const i=re(),d=n!=="replicates",s={id:i,type:"pca",isLoading:!0},m=this.plots.push(s)-1,b=new Ra,y={dataRows:ll(S.rows),srcReplicateNames:(a==null?void 0:a.length)?a:S.colNames,srcAccessionIds:(c==null?void 0:c.length)?c:S.rowNames,multiHeaderSep:S.config.multiHeader,transpose:d,zTransform:o,plotTitle:l};b.postMessage(y),b.onmessage=function(h){kt(()=>{const u=F(x(x({},J.plots[m]),h.data),{isLoading:!1});J.plots[m].id===i&&(J.plots[m]=u)})}}addSingleGeneBarPlot(l,c){const a=fa(l[0],c),n={id:re(),type:"plotly",isLoading:!1,accessions:l,data:a,options:c};this.plots.push(n)}addMultiGeneBarPlot(l,c){const a=Ta(l,c),n={id:re(),type:"plotly",isLoading:!1,accessions:l,data:a,options:c};this.plots.push(n)}addSingleGeneIndividualLinesPlot(l,c){const a=Ja(l[0],c),n={id:re(),type:"plotly",isLoading:!1,accessions:l,data:a,options:c};this.plots.push(n)}addMultiGeneIndividualLinesPlot(l,c){const a=wa(l,c),n={id:re(),type:"plotly",isLoading:!1,accessions:l,data:a,options:c};this.plots.push(n)}addStackedLinesPlot(l,c){const a=Qa(l,c),n={id:re(),type:"plotly",isLoading:!1,accessions:l,data:a,options:c};this.plots.push(n)}async addMapManPlot(l){const{template:c,infoTableColumn:a,infoTableColumnSep:n,valuesFrom:o,sample:i}=l,d=re(),s={id:d,type:"mapman",isLoading:!0},m=this.plots.push(s)-1;Oa(c,a,n,o,i).then(b=>{kt(()=>{const y=x(F(x({},J.plots[m]),{isLoading:!1,rects:b.rects,stats:b.stats,width:b.width,height:b.height}),l);J.plots[m].id===d&&(J.plots[m]=y)})})}}const J=new ja;async function Ee(t,l,c){const a=await fetch(t,c);if(!a||!a.ok)throw new Error(`Fetching resource "${t}" failed with status "${a.status}: ${a.statusText}"`);switch(l){case"blob":return await a.blob();case"json":return await a.json();case"text":return await a.text();case"url":return a.url;default:throw new Error(`Unsupported read method for ${t}`)}}function Ae(t,l){const c=t.split(/\r?\n|\r/),n=c.splice(0,1)[0].split(l.fieldSeparator).reduce((i,d,s)=>(s===l.rowNameColumn||i.push(d),i),[]),o=c.reduce((i,d)=>{if(!d)return i;const s=d.split(l.fieldSeparator),m=s.splice(l.rowNameColumn,1)[0];return Object.assign(i,{[m]:s})},{});return{header:n,rows:o}}function Nl(t,l){const c=t.split(/\r?\n|\r/);return c.splice(0,1)[0],c.reduce((a,n)=>{if(!n)return a;const o=n.split(l);return a.push(o),a},[])}var Da=function(){return function(t){t=t||{};var t=typeof t!="undefined"?t:{},l,c;t.ready=new Promise(function(p,Z){l=p,c=Z});var a={},n;for(n in t)t.hasOwnProperty(n)&&(a[n]=t[n]);var o=!0,i="",d;typeof document!="undefined"&&document.currentScript&&(i=document.currentScript.src),i.indexOf("blob:")!==0?i=i.substr(0,i.lastIndexOf("/")+1):i="";var s=t.print||console.log.bind(console),m=t.printErr||console.warn.bind(console);for(n in a)a.hasOwnProperty(n)&&(t[n]=a[n]);a=null,t.arguments,t.thisProgram,t.quit;var b;t.wasmBinary&&(b=t.wasmBinary),t.noExitRuntime,typeof WebAssembly!="object"&&W("no native wasm support detected");var y,h=!1;function u(p,Z){p||W("Assertion failed: "+Z)}function r(p){var Z=t["_"+p];return u(Z,"Cannot call unknown function "+p+", make sure it is exported"),Z}function z(p,Z,v,oe,de){var q={string:function(Re){var dt=0;if(Re!=null&&Re!==0){var ul=(Re.length<<2)+1;dt=ot(ul),O(Re,dt,ul)}return dt},array:function(Re){var dt=ot(Re.length);return te(Re,dt),dt}};function B(Re){return Z==="string"?X(Re):Z==="boolean"?Boolean(Re):Re}var f=r(p),ae=[],qe=0;if(oe)for(var $e=0;$e<oe.length;$e++){var rl=q[v[$e]];rl?(qe===0&&(qe=Ht()),ae[$e]=rl(oe[$e])):ae[$e]=oe[$e]}var Ut=f.apply(null,ae);return Ut=B(Ut),qe!==0&&zt(qe),Ut}function L(p,Z,v,oe){v=v||[];var de=v.every(function(B){return B==="number"}),q=Z!=="string";return q&&de&&!oe?r(p):function(){return z(p,Z,v,arguments)}}var E=typeof TextDecoder!="undefined"?new TextDecoder("utf8"):void 0;function V(p,Z,v){for(var oe=Z+v,de=Z;p[de]&&!(de>=oe);)++de;if(de-Z>16&&p.subarray&&E)return E.decode(p.subarray(Z,de));for(var q="";Z<de;){var B=p[Z++];if(!(B&128)){q+=String.fromCharCode(B);continue}var f=p[Z++]&63;if((B&224)==192){q+=String.fromCharCode((B&31)<<6|f);continue}var ae=p[Z++]&63;if((B&240)==224?B=(B&15)<<12|f<<6|ae:B=(B&7)<<18|f<<12|ae<<6|p[Z++]&63,B<65536)q+=String.fromCharCode(B);else{var qe=B-65536;q+=String.fromCharCode(55296|qe>>10,56320|qe&1023)}}return q}function X(p,Z){return p?V(le,p,Z):""}function Y(p,Z,v,oe){if(!(oe>0))return 0;for(var de=v,q=v+oe-1,B=0;B<p.length;++B){var f=p.charCodeAt(B);if(f>=55296&&f<=57343){var ae=p.charCodeAt(++B);f=65536+((f&1023)<<10)|ae&1023}if(f<=127){if(v>=q)break;Z[v++]=f}else if(f<=2047){if(v+1>=q)break;Z[v++]=192|f>>6,Z[v++]=128|f&63}else if(f<=65535){if(v+2>=q)break;Z[v++]=224|f>>12,Z[v++]=128|f>>6&63,Z[v++]=128|f&63}else{if(v+3>=q)break;Z[v++]=240|f>>18,Z[v++]=128|f>>12&63,Z[v++]=128|f>>6&63,Z[v++]=128|f&63}}return Z[v]=0,v-de}function O(p,Z,v){return Y(p,le,Z,v)}typeof TextDecoder!="undefined"&&new TextDecoder("utf-16le");function te(p,Z){D.set(p,Z)}var D,le,ce;function ye(p){t.HEAP8=D=new Int8Array(p),t.HEAP16=new Int16Array(p),t.HEAP32=ce=new Int32Array(p),t.HEAPU8=le=new Uint8Array(p),t.HEAPU16=new Uint16Array(p),t.HEAPU32=new Uint32Array(p),t.HEAPF32=new Float32Array(p),t.HEAPF64=new Float64Array(p)}t.INITIAL_MEMORY;var Xe,Ke=[],Se=[],ze=[];function Le(){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)xe(t.preRun.shift());be(Ke)}function se(){be(Se)}function me(){if(t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;)C(t.postRun.shift());be(ze)}function xe(p){Ke.unshift(p)}function ve(p){Se.unshift(p)}function C(p){ze.unshift(p)}var T=0,P=null;function M(p){T++,t.monitorRunDependencies&&t.monitorRunDependencies(T)}function G(p){if(T--,t.monitorRunDependencies&&t.monitorRunDependencies(T),T==0&&P){var Z=P;P=null,Z()}}t.preloadedImages={},t.preloadedAudios={};function W(p){t.onAbort&&t.onAbort(p),p+="",m(p),h=!0,p="abort("+p+"). Build with -s ASSERTIONS=1 for more info.";var Z=new WebAssembly.RuntimeError(p);throw c(Z),Z}var N="data:application/octet-stream;base64,";function Q(p){return p.startsWith(N)}var H;({VITE_APP_TITLE:"GXP",VITE_PRELOAD_DATA:"",VITE_PRELOAD_INFO:"",VITE_PRELOAD_IMAGE:"",VITE_PRELOAD_SETTINGS:"",VITE_PRELOAD_PLOTS:"",VITE_PRELOAD_ENRICHMENTS:"",BASE_URL:"/GeneExpressionPlots/",MODE:"production",DEV:!1,PROD:!0}===void 0)?H="/public/gsl.wasm":H="/GeneExpressionPlots/gsl.wasm";function U(p){try{if(p==H&&b)return new Uint8Array(b);if(!d)throw"both async and sync fetching of the wasm failed"}catch(Z){W(Z)}}function w(){return!b&&o&&typeof fetch=="function"?fetch(H,{credentials:"same-origin"}).then(function(p){if(!p.ok)throw"failed to load wasm binary file at '"+H+"'";return p.arrayBuffer()}).catch(function(){return U(H)}):Promise.resolve().then(function(){return U(H)})}function Ce(){var p={env:Et,wasi_snapshot_preview1:Et};function Z(B,f){var ae=B.exports;t.asm=ae,y=t.asm.memory,ye(y.buffer),Xe=t.asm.__indirect_function_table,ve(t.asm.__wasm_call_ctors),G()}M();function v(B){Z(B.instance)}function oe(B){return w().then(function(f){var ae=WebAssembly.instantiate(f,p);return ae}).then(B,function(f){m("failed to asynchronously prepare wasm: "+f),W(f)})}function de(){return!b&&typeof WebAssembly.instantiateStreaming=="function"&&!Q(H)&&typeof fetch=="function"?fetch(H,{credentials:"same-origin"}).then(function(B){var f=WebAssembly.instantiateStreaming(B,p);return f.then(v,function(ae){return m("wasm streaming compile failed: "+ae),m("falling back to ArrayBuffer instantiation"),oe(v)})}):oe(v)}if(t.instantiateWasm)try{var q=t.instantiateWasm(p,Z);return q}catch(B){return m("Module.instantiateWasm callback failed with error: "+B),!1}return de().catch(c),{}}function be(p){for(;p.length>0;){var Z=p.shift();if(typeof Z=="function"){Z(t);continue}var v=Z.func;typeof v=="number"?Z.arg===void 0?Xe.get(v)():Xe.get(v)(Z.arg):v(Z.arg===void 0?null:Z.arg)}}function It(){W()}function St(p,Z,v){le.copyWithin(p,Z,Z+v)}var Ge={mappings:{},buffers:[null,[],[]],printChar:function(p,Z){var v=Ge.buffers[p];Z===0||Z===10?((p===1?s:m)(V(v,0)),v.length=0):v.push(Z)},varargs:void 0,get:function(){Ge.varargs+=4;var p=ce[Ge.varargs-4>>2];return p},getStr:function(p){var Z=X(p);return Z},get64:function(p,Z){return p}};function we(p){return 0}function Ct(p,Z,v,oe,de){}function yt(p,Z,v,oe){for(var de=0,q=0;q<v;q++){for(var B=ce[Z+q*8>>2],f=ce[Z+(q*8+4)>>2],ae=0;ae<f;ae++)Ge.printChar(p,le[B+ae]);de+=f}return ce[oe>>2]=de,0}function Gt(p){}var Et={abort:It,emscripten_memcpy_big:St,fd_close:we,fd_seek:Ct,fd_write:yt,setTempRet0:Gt};Ce(),t.___wasm_call_ctors=function(){return(t.___wasm_call_ctors=t.asm.__wasm_call_ctors).apply(null,arguments)},t._gsl_ran_hypergeometric_pdf=function(){return(t._gsl_ran_hypergeometric_pdf=t.asm.gsl_ran_hypergeometric_pdf).apply(null,arguments)},t.___errno_location=function(){return(t.___errno_location=t.asm.__errno_location).apply(null,arguments)};var Ht=t.stackSave=function(){return(Ht=t.stackSave=t.asm.stackSave).apply(null,arguments)},zt=t.stackRestore=function(){return(zt=t.stackRestore=t.asm.stackRestore).apply(null,arguments)},ot=t.stackAlloc=function(){return(ot=t.stackAlloc=t.asm.stackAlloc).apply(null,arguments)};t.dynCall_jiji=function(){return(t.dynCall_jiji=t.asm.dynCall_jiji).apply(null,arguments)},t.ccall=z,t.cwrap=L;var vt;P=function p(){vt||Ft(),vt||(P=p)};function Ft(p){if(T>0||(Le(),T>0))return;function Z(){vt||(vt=!0,t.calledRun=!0,!h&&(se(),l(t),t.onRuntimeInitialized&&t.onRuntimeInitialized(),me()))}t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),Z()},1)):Z()}if(t.run=Ft,t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.pop()();return Ft(),t.ready}}();Da();function Aa(t,l){switch(t){case"<":return c=>Object.entries(c).filter(a=>parseFloat(a[1])<parseFloat(l)).map(a=>a[0]);case">":return c=>Object.entries(c).filter(a=>parseFloat(a[1])>parseFloat(l)).map(a=>a[0]);case"<=":return c=>Object.entries(c).filter(a=>parseFloat(a[1])<=parseFloat(l)).map(a=>a[0]);case">=":return c=>Object.entries(c).filter(a=>Math.abs(parseFloat(a[1]))>=Math.abs(parseFloat(l))).map(a=>a[0]);case"abs >=":return c=>Object.entries(c).filter(a=>Math.abs(parseFloat(a[1]))>=Math.abs(parseFloat(l))).map(a=>a[0]);case"abs <=":return c=>Object.entries(c).filter(a=>Math.abs(parseFloat(a[1]))<=Math.abs(parseFloat(l))).map(a=>a[0]);case"abs >":return c=>Object.entries(c).filter(a=>Math.abs(parseFloat(a[1]))>Math.abs(parseFloat(l))).map(a=>a[0]);case"abs <":return c=>Object.entries(c).filter(a=>Math.abs(parseFloat(a[1]))<Math.abs(parseFloat(l))).map(a=>a[0]);case"==":return c=>Object.entries(c).filter(a=>a[1]==l).map(a=>a[0]);case"regexp":return c=>Object.entries(c).filter(a=>{const n=new RegExp(l);return!!a[1].match(n)}).map(a=>a[0]);default:throw new Error(`unsupported selector ${t}`)}}function _a(){return new Worker("/GeneExpressionPlots/assets/enrichment.4b0cb010.js",{type:"module"})}class qa{constructor(){Pe(this,"analyses",[]);Yt(this)}getAnalysisById(l){return this.analyses.find(c=>c.id===l)}clearAnalyses(){this.analyses=[]}deleteAnalysis(l){const c=this.analyses.findIndex(a=>a.id===l);c>-1&&this.analyses.splice(c,1)}addRawEnrichmentAnalysis(l){this.analyses.push(l)}metadataToJSON(){return this.analyses.length>0?this.analyses.map(l=>{const{options:c}=l;return F(x({},c),{rawData:`enrichment_analyses/${c.title.replace(/\s+/g,"_")}.txt`})}):void 0}dataToCSV(l,c){var o;const a=`Test Entry${c}p_Value${c}adjusted p_Value
`,n=(o=l.data)==null?void 0:o.map(i=>i.join(c));return a+(n==null?void 0:n.join(`
`))}addEnrichmentAnalysis(l){if(this.analyses.findIndex(b=>b.options.title===l.title)!=-1)throw new Error(`Analysis with title ${l.title} already exists. Please select a unique name.`);const c=re(),a={id:c,isLoading:!0,options:l},n=this.analyses.push(a)-1;let o=new Set,i=new Set;if(l.filterGeneIds)o=new Set(l.filterGeneIds);else if(l.TEFselector&&l.TEFselectorValue){const b=Aa(l.TEFselector,l.TEFselectorValue),y=R.getColumn(l.TEFcolumn);o=new Set(b(y))}i=new Set(Object.keys(R.rows).filter(b=>!o.has(b)));const d=R.getColumn(l.TEIcolumn),s=l.descriptionColumn!=="None"?R.getUniqueABColumnValues(l.TEIcolumn,l.descriptionColumn,","):void 0,m=new _a;m.postMessage({geneIdsTEFpos:o,geneIdsTEFneg:i,TEIpayload:d,TEIdescriptions:s,options:l}),m.onmessage=function(b){kt(()=>{const y=F(x({},ue.analyses[n]),{isLoading:!1,data:b.data});ue.analyses[n].id===c&&(ue.analyses[n]=y)})}}}const ue=new qa;function Ql(t){const l=t.split("	");return l[0]==="BINCODE"&&l[1]==="NAME"&&l[2]==="IDENTIFIER"&&l[3]==="DESCRIPTION"&&l[4]==="TYPE"}function $a(t,l,c){if(t)if(Array.isArray(R.rows[t])||(R.rows[t]=[]),R.rows[t].length<=c)R.rows[t].push(...l);else for(let a=c;a<l.length+c;a++)R.rows[t][a]+=`,${l[a-c]}`}function El(t,l){const c=t.split(`
`).map(function(d){return d.split("	")}),a=R.header.length,n=1+(l.addName?1:0)+(l.addDescription?1:0),o={};R.hasData?R.rowNames.forEach((d,s)=>{o[d.toLowerCase()]=s}):S.rowNames.forEach((d,s)=>{o[d.toLowerCase()]=s});const i=R.rowNames.slice();R.addMercatorHeaderAndPrepareColumns(l.addName,l.addDescription),c.forEach((d,s)=>{if(s!==0&&d[0].length!==0&&d[2].length!==0){const m=d[0].replace(/[']+/g,""),b=d[1].replace(/[']+/g,""),y=d[2].replace(/[']+/g,""),h=d[3].replace(/[']+/g,"");if(y.length!==0){const u=[m],r=o[y],z=i[r];(l==null?void 0:l.addName)&&u.push(b),(l==null?void 0:l.addDescription)&&u.push(h),$a(z,u,a)}}}),R.hasData?R.rowNames.forEach(d=>{if(R.rows[d].length<R.header.length){const s=R.header.length-R.rows[d].length;R.rows[d].push(...Array(s).fill(""))}}):S.rowNames.forEach(d=>{R.rows[d]||(R.rows[d]=Array(n).fill(""))})}const Fl=t=>{const l=c=>{if(!c)return"A file input is required"};return e.createElement(ge,{initialValues:{addName:!1,addDescription:!1},validateOnBlur:!1,onSubmit:t.onSubmit},c=>e.createElement(I,{as:We},e.createElement(Lt,{name:"file",label:"Tabular File",validate:l,isRequired:!0}),e.createElement(Ye,{controlProps:{marginTop:"1rem"},color:"orange.600",id:"add-name",name:"addName",label:"add Mercator Name column"}),e.createElement(Ye,{controlProps:{marginTop:"1rem"},color:"orange.600",id:"add-description",name:"addDescription",label:"add Mercator Description column"}),e.createElement(g,{as:"p",paddingY:6,justifyContent:"flex-end"},e.createElement(k,{onClick:t.onCancel,colorScheme:"red",variant:"ghost"},"Cancel"),e.createElement(k,{colorScheme:"orange",isLoading:c.isSubmitting,marginLeft:".5rem",type:"submit",variant:"solid"},"Load"))))},en=()=>{const t=it({base:"100%",lg:"45%",xl:"30%"}),[l,c]=e.useState([]),[a,n]=e.useState(!1),o=wt(),i=C=>{S.removeColumns(C)},d=(C,T)=>{c(T?[...l,C]:l.filter(P=>P!==C))},s=e.useRef(null),{isOpen:m,onOpen:b,onClose:y}=ie(),h=(C,T)=>{J.loadCountUnit(Qe(C.countUnit)),K.loadgxpSettings({unit:C.countUnit,expression_field_sep:Qe(C.columnSep),expression_header_sep:Qe(C.headerSep)});const P=C.file;if(P)try{const M=new FileReader;M.onload=()=>{const G=Ae(M.result,{fieldSeparator:Qe(C.columnSep),rowNameColumn:0});S.loadFromObject(G,{multiHeader:C.headerSep}),K.setGroupOrder(S.groupsAsArray),K.setSampleOrder(S.samplesAsArray)},M.onloadend=()=>{T.setSubmitting(!1),y()},M.onerror=()=>{T.setSubmitting(!1),console.error("There was an error while reading the file")},M.readAsText(P)}catch(M){T.setSubmitting(!1),console.error(M)}},u=e.useRef(null),{isOpen:r,onOpen:z,onClose:L}=ie(),E=(C,T)=>{const P=C.file;if(P)try{K.loadgxpSettings({info_field_sep:Qe(C.columnSep)});const M=new FileReader;M.onload=()=>{const G=Ae(M.result,{fieldSeparator:Qe(C.columnSep),rowNameColumn:0});R.loadFromObject(G)},M.onloadend=()=>{T.setSubmitting(!1),L()},M.onerror=()=>{T.setSubmitting(!1),console.error("There was an error while reading the file")},M.readAsText(P)}catch{T.setSubmitting(!1),console.error("There was an error while reading the file")}},V=e.useRef(null),{isOpen:X,onOpen:Y,onClose:O}=ie(),te=(C,T)=>{const P=C.file;if(P)try{const M=new FileReader;M.onload=()=>{const G=M.result.split(`
`,1)[0];if(Ql(G))El(M.result,{addDescription:C.addDescription,addName:C.addName}),o({title:"Successfully imported Mercator table",status:"success",description:"The provided Mercator tabular output was successfully imported into the application.",isClosable:!0});else{o({title:"Error",status:"error",description:"Invalid Mercator Input.",isClosable:!0});return}},M.onloadend=()=>{T.setSubmitting(!1),O()},M.onerror=()=>{T.setSubmitting(!1),console.error("There was an error while reading the file")},M.readAsText(P)}catch(M){T.setSubmitting(!1),console.error(M)}},D=e.useRef(null),{isOpen:le,onOpen:ce,onClose:ye}=ie(),Xe=async(C,T)=>{var M;const P=C.file;if(P)try{const G=new el,W=await G.loadAsync(P),Q=await W.files["GXP_settings.json"].async("string"),H=JSON.parse(Q);K.loadgxpSettings(H);const w=await W.files["expression_table.txt"].async("string"),Ce=Ae(w,{fieldSeparator:K.gxpSettings.expression_field_sep,rowNameColumn:0});if(S.loadFromObject(Ce,{multiHeader:K.gxpSettings.expression_header_sep}),!K.gxpSettings.groupOrder||K.gxpSettings.groupOrder.length===0){const Ge=S.groupsAsArray;K.setGroupOrder(Ge)}if(!K.gxpSettings.sampleOrder||K.gxpSettings.sampleOrder.length===0){const Ge=S.samplesAsArray;K.setSampleOrder(Ge)}const be=W.files["info_table.txt"];if(be){const Ge=await be.async("string"),we=Ae(Ge,{fieldSeparator:K.gxpSettings.info_field_sep,rowNameColumn:0});R.loadFromObject(we)}const It=W.files["image.png"];if(It){const Ge=await It.async("blob"),we=URL.createObjectURL(Ge);J.addImagePlot(we,"Database Image")}const St=W.files["enrichment_analyses.json"];if(St){const Ge=await St.async("string"),we=JSON.parse(Ge);await Promise.all(we.map(async Ct=>{const ot=Ct,{rawData:yt}=ot,Gt=j(ot,["rawData"]),Ht=await W.files[yt].async("string"),zt=Nl(Ht,K.gxpSettings.expression_field_sep);ue.addRawEnrichmentAnalysis({id:re(),isLoading:!1,options:Gt,data:zt})}))}(M=G.folder("plots"))==null||M.forEach(async(Ge,we)=>{const yt=await W.files[we.name].async("string"),Gt=JSON.parse(yt);J.addRawPlot(x({id:re(),isLoading:!1},Gt))}),T.setSubmitting(!1),ye()}catch(G){T.setSubmitting(!1),console.error(G)}},Ke=e.useRef(null),{isOpen:Se,onOpen:ze,onClose:Le}=ie(),se=async(C,T)=>{try{const P=S.toString(Qe(C.columnSep)),M=R.hasData?R.toString(K.gxpSettings.info_field_sep):null,G=J.plots.find(H=>H.type==="image"),W=JSON.stringify(Object.assign({},K.gxpSettings,{expression_field_sep:Qe(C.columnSep)}),null,2),N=new el;if(N.file("GXP_settings.json",W),N.file("expression_table.txt",P),C.exportEnrichments){const H=C.exportEnrichments?JSON.stringify(ue.metadataToJSON(),null,2):void 0;H&&(N.file("enrichment_analyses.json",H),N.folder("enrichment_analyses"),ue.analyses.forEach(U=>{const w=ue.dataToCSV(U,Qe(C.columnSep));N.file(`enrichment_analyses/${U.options.title.replace(/\s+/g,"_")}.txt`,w)}))}if(C.exportPlots){const H=JSON.stringify(J.plotNamesForExport());H&&(N.file("plots.json",H),N.folder("plots"),J.plots.forEach(U=>{const w=JSON.stringify(J.toJSObject(U.id),null,2);w&&N.file(`plots/${U.id}_${U.type}.json`,w)}))}if(M&&N.file("info_table.txt",M),G){const H=await Ee(G.src,"blob");H&&N.file("image.png",H,{base64:!0})}const Q=await N.generateAsync({type:"blob"});tl.exports.saveAs(Q,C.fileName+".zip"),T.setSubmitting(!1),Le()}catch(P){T.setSubmitting(!1),console.error(P)}},me=S.hasData,xe=()=>{l.length>0?(S.removeColumns(...l),c([])):(S.clearData(),R.clearData())},ve=async()=>{n(!0),J.loadCountUnit("raw"),K.loadgxpSettings({unit:"raw",expression_field_sep:"	",expression_header_sep:".",info_field_sep:"	"});try{const T=await(await fetch("20220127_Analysis_Tomato_both_cpm_merged.csv")).text(),P=Ae(T,{fieldSeparator:"	",rowNameColumn:0});S.loadFromObject(P,{multiHeader:"."}),K.setGroupOrder(S.groupsAsArray),K.setSampleOrder(S.samplesAsArray);const G=await(await fetch("20220127_Analysis_Tomato_both_toptags_merged_MapMan_HRDs.csv")).text(),W=Ae(G,{fieldSeparator:"	",rowNameColumn:0});R.loadFromObject(W),o({title:"Example data has been loaded",description:'Click on the above "Plots" button and start plotting!',status:"success",duration:9e3,isClosable:!0})}catch{console.error("There was an error while loading the examle data")}n(!1)};return e.createElement(g,{as:"main",flexGrow:1},e.createElement(vl,{maxWidth:"17rem"},!K.preloaded.data&&e.createElement(he,{text:"Load Expression Table",icon:rc,onClick:b}),!K.preloaded.data&&e.createElement(he,{text:"Load Gene Info Table",icon:uc,onClick:z}),!K.preloaded.data&&e.createElement(he,{text:"Load Mercator Table",icon:xl,onClick:Y,disabled:!me}),!K.preloaded.data&&e.createElement(he,{text:"Import GXP Database",icon:yc,onClick:ce}),e.createElement(he,{text:"Export GXP Database",icon:Gc,onClick:ze}),!K.preloaded.data&&e.createElement(he,{text:l.length>0?"Remove selected":"Remove All Data",icon:Pt,onClick:xe,disabled:!me}),e.createElement(mt,null),e.createElement(il,{to:"/tools/gene-browser",_hover:{textColor:"orange.600"}},e.createElement(he,{text:"Gene Browser",icon:gl,disabled:!me}))),e.createElement(g,{alignItems:"center",flexDirection:"column",padding:"2rem",width:"100%"},!me&&e.createElement(Fe,{alignItems:"center",flexDirection:"column",minHeight:"20rem",justifyContent:"center",marginLeft:3,marginTop:3,status:"info",textAlign:"center",variant:"subtle",colorScheme:"orange"},e.createElement(Ue,{boxSize:"3rem",mr:0}),e.createElement(Oe,{mt:4,mb:1,fontSize:"lg"},"No data has been loaded"),e.createElement(Ne,{maxWidth:"xl"},"It seems no data has been loaded into the application yet."),e.createElement(Ne,{maxWidth:"xl",marginTop:3},"Load your data via the Sidebar or play around with some examples using the button below."),e.createElement(k,{isLoading:a,colorScheme:"orange",variant:"solid",marginTop:3,onClick:ve},"Load example data")),e.createElement(pc,{role:"region","aria-label":"Loaded replicates",justify:"center",spacing:"1rem",width:"100%"},S.colNames.map(C=>e.createElement(Zc,{key:C,width:t},e.createElement(ra,{"aria-label":C,key:C,name:C,onDelete:K.preloaded.data?void 0:i,onSelect:K.preloaded.data?void 0:d,tabIndex:K.preloaded.data?0:void 0}))))),e.createElement(Ie,{initialFocusRef:s,isOpen:m,onClose:y,title:"Load Expression Table"},e.createElement(za,{initialFocusRef:s,onCancel:y,onSubmit:h})),e.createElement(Ie,{initialFocusRef:u,isOpen:r,onClose:L,title:"Load Gene-Info Table"},e.createElement(Ha,{initialFocusRef:u,onCancel:L,onSubmit:E})),e.createElement(Ie,{initialFocusRef:V,isOpen:X,onClose:O,title:"Load Mercator Table"},e.createElement(Fl,{initialFocusRef:V,onCancel:O,onSubmit:te})),e.createElement(Ie,{initialFocusRef:D,isOpen:le,onClose:ye,title:"Import GXP Database"},e.createElement(Ca,{initialFocusRef:D,onCancel:ye,onSubmit:Xe})),e.createElement(Ie,{initialFocusRef:Ke,isOpen:Se,onClose:Le,title:"Export GXP Database"},e.createElement(Sa,{initialFocusRef:Ke,onCancel:Le,onSubmit:se})))};var tn=ht(en);const ln=()=>e.createElement(Xt,null,e.createElement(Me,{path:"/",element:e.createElement(tn,null)})),cn=et(g),an=et(I),Ul=n=>{var o=n,{label:t,text:l,icon:c}=o,a=j(o,["label","text","icon"]);return e.createElement(pl,F(x({},a),{_focus:x({outline:"none",borderLeftColor:"orange.600"},a._focus),_hover:x({borderLeftColor:"orange.600",boxShadow:"md",textDecoration:"none"},a._hover),backgroundColor:"white",borderLeft:"4px",borderLeftColor:"transparent",boxShadow:"xs",display:"flex",padding:5,rel:"noopener noreferrer",target:"_blank",tabIndex:0,width:"100%"}),c&&e.createElement(pe,{as:c,color:"gray.600",height:"1.5rem",marginTop:1,marginRight:"1rem",width:"1.5rem"}),e.createElement(cn,{as:"section",alignItems:"center",flexGrow:1,whileHover:"hover"},e.createElement(I,{width:"100%"},e.createElement($,{as:"h1",fontSize:"xl",fontWeight:"semibold"},t),e.createElement($,{marginTop:"1.5"},l)),e.createElement(an,{marginX:"1rem",variants:{hover:{x:[0,10],transition:{duration:.8,repeat:1/0,repeatType:"mirror"}}}},e.createElement(pe,{as:cl,color:"orange.600",height:"1.5rem",width:"1.5rem"}))))},nn=()=>e.createElement(I,{as:"main",padding:6,width:"100%",__css:{"& a:not(:first-of-type)":{marginTop:"2rem"}}},e.createElement(Ul,{icon:hc,label:"User Manual",text:`
          The user manual contains detailed information on how to load data
          and create new plots. All the data loaded in the application is kept
          private to your browser tab and will never be uploaded to the
          internet.
        `,href:"https://zendro-dev.gitbook.io/geneexpressionplots/documentation/user-manual"}),e.createElement(Ul,{_hover:{textDecoration:"none"},icon:Xc,label:"API",text:`
          The application programming interface contains instructions for
          advanced users that want to deploy this application with data
          already pre-loaded. This type of deployment is useful to showcase
          public datasets.
        `,href:"https://zendro-dev.gitbook.io/geneexpressionplots/documentation/api"})),on=()=>e.createElement(Xt,null,e.createElement(Me,{path:"/",element:e.createElement(nn,null)}));function dn(t){const l=e.useCallback(a=>{const n=S.rowNames,o=10,i=[];for(let d=0;d<n.length&&(n[d].includes(a)&&i.push(n[d]),!(i.length>=o));d++);return i},[]),c=e.useMemo(()=>{if((t==null?void 0:t.accession)!==void 0)return l(t==null?void 0:t.accession)},[l,t==null?void 0:t.accession]);return c!=null?c:l}function sn(t){const l=e.useCallback(a=>{const n=S.colNames,o=10,i=[];for(let d=0;d<n.length&&(n[d].includes(a)&&i.push(n[d]),!(i.length>=o));d++);return i},[]),c=e.useMemo(()=>{if((t==null?void 0:t.replicate)!==void 0)return l(t==null?void 0:t.replicate)},[l,t==null?void 0:t.replicate]);return c!=null?c:l}const xt=y=>{var h=y,{children:t,controlProps:l,groupProps:c,hideLabel:a,initialFocusRef:n,label:o,leftChildren:i,name:d,rightChildren:s,validate:m}=h,b=j(h,["children","controlProps","groupProps","hideLabel","initialFocusRef","label","leftChildren","name","rightChildren","validate"]);const[u,r]=Je({name:d,validate:m}),z=dn({accession:u.value});return e.createElement(fe,F(x({},l),{isInvalid:r.error!==void 0&&r.touched!==void 0,isRequired:b.isRequired}),a?e.createElement(ee,null,e.createElement(A,{fontWeight:"semibold"},o)):e.createElement(A,{fontWeight:"semibold"},o),e.createElement(Mt,x({as:"span"},c),i,e.createElement(pt,F(x({ref:L=>n?n.current=L:L,name:u.name,onBlur:u.onBlur,onChange:u.onChange,multiple:u.multiple,value:u.value},b),{list:`${u.name}-list`})),e.createElement(I,{as:"datalist",id:`${u.name}-list`},z.map(L=>e.createElement(I,{as:"option",key:L,value:L}))),t,s),e.createElement(Be,{as:"span"},r.error))},mn=t=>{const l=c=>{if(!S.getRow(c))return"The identifier does not exist";if(!c)return"The identifier cannot be empty"};return e.createElement(ge,{initialValues:{accessions:[""],plotTitle:"",withCaption:!0,withLegend:!0},onSubmit:t.onSubmit,validateOnBlur:!1},c=>e.createElement(I,{as:We},e.createElement(I,{as:"fieldset"},e.createElement(ee,{as:"legend"},"Legend and caption switches"),e.createElement(g,{as:"ul",listStyleType:"none"},e.createElement(Ye,{controlProps:{as:"li"},color:"orange.600",id:"plot-legend",label:"Legend",name:"withLegend"}),e.createElement(Ye,{controlProps:{as:"li"},color:"orange.600",id:"plot-caption",label:"Caption",name:"withCaption"}))),e.createElement(ne,{controlProps:{as:"p",marginTop:"1rem"},initialFocusRef:t.initialFocusRef,label:"Plot Title",name:"plotTitle"}),e.createElement(lt,{name:"accessions"},a=>e.createElement(I,{as:"fieldset"},e.createElement(ee,{as:"legend"},"Gene Accessions"),c.values.accessions&&c.values.accessions.length>0&&c.values.accessions.map((n,o)=>e.createElement(xt,{controlProps:{as:"p",marginTop:"1rem"},groupProps:{_focusWithin:{"& > button":{display:"inline-flex"}}},isRequired:!0,key:o,label:`Identifier (gene/metabolite/accession) ${o+1}`,name:`accessions.${o}`,rightChildren:c.values.accessions.length>1&&e.createElement(ct,{_focusWithin:{backgroundColor:"white"},_hover:{backgroundColor:"white"},as:"span",padding:0},e.createElement(Ze,{_focus:{color:"red.600",outline:"none"},_groupHover:{color:"red.600"},"aria-label":`Remove ${n}`,color:"gray.600",display:"flex",justifyContent:"center",icon:e.createElement(at,null),onClick:()=>a.remove(o),size:"md",variant:"unstyled"})),validate:l},e.createElement(I,{display:"none",color:"gray.500",_groupFocus:{display:"inline-flex"},_groupHover:{display:"inline-flex"},_focus:{backgroundColor:"orange.600",color:"white",outline:"none"},_hover:{backgroundColor:"orange.600",color:"white"},alignItems:"center",as:"button","aria-label":"Insert new below",backgroundColor:"white",height:"1rem",justifyContent:"center",left:"43%",padding:".75rem",position:"absolute",rounded:"full",top:"28px",type:"button",width:"1rem",zIndex:"popover",onClick:()=>a.insert(o+1,"")},e.createElement(pe,{as:je})))),e.createElement(k,{_focus:{outline:"none",backgroundColor:"orange.100"},_hover:{backgroundColor:"orange.100"},colorScheme:"orange",marginTop:"1rem",type:"button",onClick:()=>a.push(""),variant:"ghost"},"Add New"))),e.createElement(g,{as:"p",paddingY:6,justifyContent:"flex-end"},e.createElement(k,{onClick:t.onCancel,colorScheme:"red",variant:"ghost"},"Cancel"),e.createElement(k,{colorScheme:"orange",isLoading:c.isSubmitting,marginLeft:".5rem",type:"submit",variant:"solid"},"Load"))))},sl=({controlProps:t,direction:l,hideLabel:c,label:a,name:n,options:o,validate:i})=>{const[d,s,m]=Je({name:n,validate:i}),b=y=>{m.setValue(y)};return e.createElement(fe,F(x({},t),{isInvalid:s.error!==void 0&&s.touched!==void 0}),c?e.createElement(ee,null,e.createElement(A,{fontWeight:"semibold"},a)):e.createElement(A,{fontWeight:"semibold"},a),e.createElement(Kc,{name:d.name,value:d.value,onChange:b,defaultValue:o[0].value},e.createElement(Zl,{direction:l},o.map((y,h)=>e.createElement(Lc,x({colorScheme:"orange",key:`${y.label}-${h}`,value:y.value,isDisabled:y.disabled},y),y.label)))),e.createElement(Be,{as:"span"},s.error))},Ol=y=>{var h=y,{children:t,controlProps:l,groupProps:c,hideLabel:a,initialFocusRef:n,label:o,leftChildren:i,name:d,rightChildren:s,validate:m}=h,b=j(h,["children","controlProps","groupProps","hideLabel","initialFocusRef","label","leftChildren","name","rightChildren","validate"]);const[u,r]=Je({name:d,validate:m}),z=sn({replicate:u.value});return e.createElement(fe,F(x({},l),{isInvalid:r.error!==void 0&&r.touched!==void 0,isRequired:b.isRequired}),a?e.createElement(ee,null,e.createElement(A,{fontWeight:"semibold"},o)):e.createElement(A,{fontWeight:"semibold"},o),e.createElement(Mt,x({as:"span"},c),i,e.createElement(pt,F(x({ref:L=>n?n.current=L:L,name:u.name,onBlur:u.onBlur,onChange:u.onChange,multiple:u.multiple,value:u.value},b),{list:`${u.name}-list`})),e.createElement(I,{as:"datalist",id:`${u.name}-list`},z.map(L=>e.createElement(I,{as:"option",key:L,value:L}))),t,s),e.createElement(Be,{as:"span"},r.error))},He=s=>{var m=s,{controlProps:t,hideLabel:l,label:c,name:a,validate:n,options:o,tooltip:i}=m,d=j(m,["controlProps","hideLabel","label","name","validate","options","tooltip"]);const[b,y,h]=Je({name:a,validate:n});return e.createElement(fe,F(x({},t),{isInvalid:y.error!==void 0&&y.touched!==void 0}),l?e.createElement(ee,null,e.createElement(A,{fontWeight:"semibold"},c)):e.createElement(Tt,{label:i,placement:"auto"},e.createElement(A,{fontWeight:"semibold"},c)),e.createElement(xc,x({value:b.value,onChange:u=>h.setValue(u.target.value),onBlur:b.onBlur},d),o.map(u=>e.createElement("option",{key:u.value,value:u.value},u.label))),e.createElement(Be,{as:"span"},y.error))},gt=s=>{var m=s,{controlProps:t,hideLabel:l,label:c,name:a,validate:n,initialFocusRef:o,tooltip:i}=m,d=j(m,["controlProps","hideLabel","label","name","validate","initialFocusRef","tooltip"]);const[b,y]=Je({name:a,validate:n});return e.createElement(fe,F(x({},t),{isInvalid:y.error!==void 0&&y.touched!==void 0,isRequired:d.isRequired}),l?e.createElement(ee,null,e.createElement(A,{fontWeight:"semibold"},c)):e.createElement(Tt,{label:i,placement:"auto"},e.createElement(A,{fontWeight:"semibold"},c)),e.createElement(gc,x({ref:h=>o?o.current=h:h,name:b.name,value:b.value,onChange:b.onChange,onBlur:b.onBlur},d)),e.createElement(Be,{as:"span"},y.error))};var _e;(function(t){t.EMPTY_REPLICATE="A replicate field cannot be empty",t.EMPTY_ACCESSION="A gene accession field cannot be empty",t.MIN_OPTIONAL_REPLICATES="At least two replicates must be selected",t.MIN_OPTIONAL_ACCESSIONS="At least two genes must be selected"})(_e||(_e={}));const bn=t=>{const l=n=>{if(n.replicates.length===1&&n.clusterBy==="replicates")return{replicates:[_e.MIN_OPTIONAL_REPLICATES]};if(n.accessions.length===1&&n.clusterBy==="genes")return{accessions:[_e.MIN_OPTIONAL_ACCESSIONS]}},c=n=>{if(!n)return _e.EMPTY_REPLICATE},a=n=>{if(!n)return _e.EMPTY_ACCESSION};return e.createElement(ge,{initialValues:{accessions:[],accessionsList:"",clusterBy:"replicates",distanceMethod:"correlation",replicates:[],replicatesList:"",plotTitle:"",zTransform:!0},validateOnBlur:!1,validate:l,onSubmit:t.onSubmit},n=>{var o;return e.createElement(e.Fragment,null,((o=n.errors.replicates)==null?void 0:o[0])===_e.MIN_OPTIONAL_REPLICATES&&e.createElement(ee,null,e.createElement(Fe,{status:"error",variant:"subtle",alignItems:"center"},e.createElement(Ue,{mr:4}),e.createElement(I,{flex:"1"},e.createElement(Oe,{fontSize:"lg"},"Errors"),e.createElement(Ne,{display:"block"},_e.MIN_OPTIONAL_REPLICATES)),e.createElement(Wc,{position:"absolute",right:"8px",top:"8px"}))),e.createElement(I,{as:We},e.createElement(ne,{controlProps:{as:"p",marginTop:"1rem"},initialFocusRef:t.initialFocusRef,label:"Plot Title",name:"plotTitle"}),e.createElement(He,{controlProps:{marginTop:"2rem"},label:"Likelihood measure",name:"distanceMethod",options:[{value:"correlation",label:"correlation"},{value:"euclidean",label:"euclidean distance"}]}),e.createElement(sl,{controlProps:{marginTop:"2rem"},label:"Cluster",name:"clusterBy",options:[{label:"Replicates",value:"replicates"},{label:"Genes",value:"genes"}],direction:"row"}),e.createElement(Ye,{controlProps:{marginTop:"2rem"},color:"orange.600",id:"heatmap z-transform",label:"z-transform data",name:"zTransform"}),e.createElement(lt,{name:"replicates"},i=>e.createElement(I,{as:"fieldset"},e.createElement(ee,{as:"legend"},"Replicates"),e.createElement(A,{as:"p",marginTop:"2rem",fontWeight:"semibold"},"Optionally filter replicates"),e.createElement(gt,{controlProps:{marginTop:"1rem",marginLeft:".5rem"},focusBorderColor:"orange.300",name:"replicatesList",label:"replicates",hideLabel:!0,placeholder:"List your replicates here, separated by a newline.",isDisabled:n.values.replicates.length>0}),n.values.replicates.length>0&&n.values.replicates.map((d,s)=>e.createElement(Ol,{controlProps:{as:"p"},groupProps:{_focusWithin:{"& > button":{display:"inline-flex"}}},isRequired:!0,key:s,label:`Replicate ${s+1}`,name:`replicates.${s}`,rightChildren:e.createElement(ct,{_focusWithin:{backgroundColor:"white"},_hover:{backgroundColor:"white"},as:"span",padding:0},e.createElement(Ze,{_focus:{color:"red.600",outline:"none"},_groupHover:{color:"red.600"},"aria-label":`Remove ${d}`,color:"gray.600",display:"flex",justifyContent:"center",icon:e.createElement(at,null),onClick:()=>i.remove(s),size:"md",variant:"unstyled"})),validate:c},e.createElement(I,{display:"none",color:"gray.500",_groupFocus:{display:"inline-flex"},_groupHover:{display:"inline-flex"},_focus:{backgroundColor:"orange.600",color:"white",outline:"none"},_hover:{backgroundColor:"orange.600",color:"white"},alignItems:"center",as:"button","aria-label":"Insert new below",backgroundColor:"white",height:"1rem",justifyContent:"center",left:"43%",padding:".75rem",position:"absolute",rounded:"full",top:"28px",type:"button",width:"1rem",zIndex:"popover",onClick:()=>i.insert(s+1,"")},e.createElement(pe,{as:je})))),e.createElement(k,{_focus:{outline:"none",backgroundColor:"orange.100"},_hover:{backgroundColor:"orange.100"},colorScheme:"orange",type:"button",onClick:()=>{n.values.replicates.length===0&&i.push(""),i.push("")},variant:"ghost",marginTop:".5rem",disabled:n.values.replicatesList!==""},n.values.replicates.length===0?"Select Replicates":"Add Another Replicate"))),e.createElement(lt,{name:"accessions"},i=>e.createElement(I,{as:"fieldset"},e.createElement(ee,{as:"legend"},"Genes"),e.createElement(A,{as:"p",marginTop:"1rem",fontWeight:"semibold"},"Optionally filter genes"),e.createElement(gt,{controlProps:{marginTop:"1rem",marginLeft:".5rem"},focusBorderColor:"orange.300",name:"accessionsList",label:"accession",hideLabel:!0,placeholder:"List your identifiers here, separated by a newline.",isDisabled:n.values.accessions.length>0}),n.values.accessions&&n.values.accessions.length>0&&n.values.accessions.map((d,s)=>e.createElement(xt,{controlProps:{as:"p"},groupProps:{_focusWithin:{"& > button":{display:"inline-flex"}}},isRequired:!0,key:s,label:`Gene Identifier ${s+1}`,name:`accessions.${s}`,rightChildren:e.createElement(ct,{_focusWithin:{backgroundColor:"white"},_hover:{backgroundColor:"white"},as:"span",padding:0},e.createElement(Ze,{_focus:{color:"red.600",outline:"none"},_groupHover:{color:"red.600"},"aria-label":`Remove ${d}`,color:"gray.600",display:"flex",justifyContent:"center",icon:e.createElement(at,null),onClick:()=>i.remove(s),size:"md",variant:"unstyled"})),validate:a},e.createElement(I,{display:"none",color:"gray.500",_groupFocus:{display:"inline-flex"},_groupHover:{display:"inline-flex"},_focus:{backgroundColor:"orange.600",color:"white",outline:"none"},_hover:{backgroundColor:"orange.600",color:"white"},alignItems:"center",as:"button","aria-label":"Insert new below",backgroundColor:"white",height:"1rem",justifyContent:"center",left:"43%",padding:".75rem",position:"absolute",rounded:"full",top:"28px",type:"button",width:"1rem",zIndex:"popover",onClick:()=>i.insert(s+1,"")},e.createElement(pe,{as:je})))),e.createElement(k,{_focus:{outline:"none",backgroundColor:"orange.100"},_hover:{backgroundColor:"orange.100"},colorScheme:"orange",marginTop:".5rem",type:"button",onClick:()=>{n.values.accessions.length===0&&i.push(""),i.push("")},variant:"ghost",disabled:n.values.accessionsList!==""},n.values.accessions.length===0?"Select Genes":"Add Another Genes"))),e.createElement(g,{as:"p",paddingY:6,justifyContent:"flex-end"},e.createElement(k,{onClick:t.onCancel,colorScheme:"red",variant:"ghost"},"Cancel"),e.createElement(k,{colorScheme:"orange",isLoading:n.isSubmitting,marginLeft:".5rem",type:"submit",variant:"solid"},"Load"))))})},jl=({colorScale:t,id:l,minVal:c,maxVal:a,label:n,width:o,height:i,x:d,y:s,reverse:m,labelOffset:b})=>{const y=Te.exports.useRef(null);return Te.exports.useLayoutEffect(()=>{const h=Vc().domain([c,a]).range([i,0]),u=Ic(h).scale(h).tickValues([c,a]),r=ke(y.current),L=r.append("defs").append("linearGradient").attr("id",`linear-gradient-${l}`);L.attr("x1","0%").attr("y1",`${m?"0":"100"}%`).attr("x2","0%").attr("y2",`${m?"110":"0"}%`),L.selectAll("stop").data(t.ticks().map((E,V,X)=>({offset:`${100*V/X.length}%`,color:t(E)}))).enter().append("stop").attr("offset",E=>E.offset).attr("stop-color",E=>E.color),r.append("rect").attr("width",o).attr("height",i).attr("x",d).attr("y",s).style("fill",`url(#linear-gradient-${l})`),r.append("g").style("font-size","1rem").attr("transform",`translate(${d-10}, ${s})`).call(u),r.append("text").attr("class","y label").attr("text-anchor","middle").attr("font-size","smaller").attr("transform",`translate (${d-20},${s+80-(b!=null?b:0)}) rotate(-90)`).text(n)},[]),e.createElement("svg",{ref:y})},rn="#b4fbde",un="#f33d15";function Dl(t,l){return Math.max(...t.map(l))}function Al(t,l){return Math.min(...t.map(l))}const _l=t=>t.bins,ql=t=>t.count,yn=t=>{var E;const{tooltipData:l,tooltipLeft:c,tooltipTop:a,tooltipOpen:n,showTooltip:o,hideTooltip:i}=Sc(),{containerRef:d,TooltipInPortal:s}=Cc({detectBounds:!0,scroll:!0}),m=Al(t.binData,V=>Al(_l(V),ql)),b=Dl(t.binData,V=>Dl(_l(V),ql)),y=t.distanceMethod==="correlation"?Wl([1,-1],Vl):Jt({range:[rn,un],domain:[m,b]}),h=e.useRef(null),u=e.useRef(),[r,z]=e.useState(),L=Te.exports.useMemo(()=>Hc(t.tree),[t.tree]);return e.useEffect(function(){let X;const Y=h.current,O=new ResizeObserver(te=>{u.current&&clearTimeout(u.current),z(void 0),X=window.setTimeout(()=>{const D=window.getComputedStyle(te[0].target,null),le=parseFloat(D.getPropertyValue("padding-top")),ce=parseFloat(D.getPropertyValue("padding-bottom")),ye=parseFloat(D.getPropertyValue("padding-left")),Ke=parseFloat(D.getPropertyValue("padding-right"))+ye,Se=le+ce,ze=t.plotTitle?50:25,Le=20,se=Math.max(...t.binData.map(H=>H.bin.length))*6+5,me=te[0].target.clientWidth-Ke-Le-(se!=null?se:0),xe=te[0].target.clientHeight-Se-(se!=null?se:0)-ze,ve=xe/6,C=xe-ve-25,T=t.binData.length,P=me/T,M=C/T,G=Jt({domain:[0,t.binData.length],range:[0,me]}),W=Jt({domain:[0,t.binData.length],range:[0,C]}),N=Il({domain:t.binData.map(H=>H.bin),range:[0,me]}),Q=Il({domain:t.binData[0].bins.map(H=>H.bin),range:[0,C]});z({binWidth:P,binHeight:M,tickLineSize:Le,titleHeight:ze,tickLabelSize:se,xScaleAxis:N,xScalePlot:G,yScaleAxis:Q,yScalePlot:W,xMax:me,yMax:xe,treeBoundsY:ve,heatmapBoundsY:C})},100),u.current=X});return Y&&O.observe(Y),()=>{Y&&O.unobserve(Y),X&&clearTimeout(X)}},[t.binData,t.plotTitle]),e.createElement(bt,{justifyContent:"center",status:r?"idle":"loading",figureRef:h,position:"relative",height:1200,plotType:"heatmap",id:t.id},r&&e.createElement(e.Fragment,null,e.createElement("svg",{className:"main-svg",width:"100%",height:"100%",ref:d},e.createElement(jl,{colorScale:y,id:re(),minVal:t.distanceMethod==="euclidean"?m:-1,maxVal:t.distanceMethod==="euclidean"?b:1,width:20,height:225,x:60,y:10,labelOffset:-20,reverse:t.distanceMethod==="correlation",label:t.distanceMethod==="euclidean"?"euclidean distance":"correlation coefficient"}),r.titleHeight!==0&&e.createElement(Kt,{top:15},e.createElement(ft,{x:r.xMax/2+r.tickLabelSize,textAnchor:"middle",fontSize:20},t.plotTitle)),e.createElement(ft,{x:r.xMax/2+r.tickLabelSize,y:r.titleHeight-10,textAnchor:"middle",fontSize:15},`Agglomerative hierarchical clustering on distance measure: ${t.distanceMethod==="euclidean"?"euclidean distance":"abs(corr) - 1"}.`),e.createElement(Kt,{top:r.titleHeight,left:r.tickLabelSize+r.tickLineSize},e.createElement(zc,{root:L,size:[r.xMax,r.treeBoundsY],separation:()=>5},V=>e.createElement(Kt,null,V.links().map((X,Y)=>e.createElement(vc,{key:`cluster-link-${Y}`,data:X,stroke:"black",strokeWidth:"1",fill:"none",percent:0})),V.descendants().map((X,Y)=>e.createElement(Kt,{top:X.y,left:X.x,key:`cluster-node-${Y}`},!X.children&&e.createElement(ft,{dy:3,fontSize:10,fontFamily:"Arial",textAnchor:"end",angle:270,dx:4},X.data.name)))))),e.createElement(Kt,{top:r.titleHeight+r.treeBoundsY+r.tickLabelSize,left:r.tickLabelSize+r.tickLineSize},e.createElement(Rc,{data:t.binData,xScale:V=>(r==null?void 0:r.xScalePlot)?r.xScalePlot(V):0,yScale:V=>(r==null?void 0:r.yScalePlot)?r.yScalePlot(V):0,colorScale:y,binWidth:r==null?void 0:r.binWidth,binHeight:r==null?void 0:r.binHeight,bins:V=>V&&V.bins,count:V=>V&&V.count,gap:1},V=>V.map(X=>X.map(Y=>e.createElement("rect",{key:`heatmap-rect-${Y.row}-${Y.column}`,width:Y.width,height:Y.height,x:Y.x,y:Y.y,fill:Y.color,fillOpacity:Y.opacity,onMouseOver:()=>{o({tooltipData:Y,tooltipTop:Y.y+r.titleHeight+r.treeBoundsY+r.tickLabelSize,tooltipLeft:Y.x})},onMouseOut:i})))),e.createElement(Tc,{left:-10,numTicks:t.binData.length,tickLabelProps:()=>({lengthAdjust:"spacing",fontSize:10,textAnchor:"end",dy:3,dx:-3}),scale:r.yScaleAxis}),e.createElement(ft,{dy:r.heatmapBoundsY+15,fontSize:12},`${t.zTransform?" Data has been centered via z-transformation.":""}`)))),n&&l&&e.createElement(s,{left:c,top:a},e.createElement("p",null,e.createElement($,{as:"span",fontWeight:"semibold"},"Column"),e.createElement($,{as:"span",ml:1},t.binData[l.column].bin)),e.createElement("p",null,e.createElement($,{as:"span",fontWeight:"semibold"},"Row"),e.createElement($,{as:"span",ml:1},t.binData[l.column].bins[l.row].bin)),e.createElement("p",null,e.createElement($,{as:"span",fontWeight:"semibold"},t.distanceMethod.charAt(0).toUpperCase()+t.distanceMethod.slice(1)),e.createElement($,{as:"span",ml:1},(E=l.count)==null?void 0:E.toFixed(4)))))},Gn=n=>{var o=n,{alt:t,src:l,id:c}=o,a=j(o,["alt","src","id"]);return e.createElement(bt,{"aria-label":t,id:c,plotType:"image",status:"idle"},e.createElement(Mc,x({alt:t,backgroundColor:"white",objectFit:"scale-down",src:l,width:"100%"},a)))};var Wt;(function(t){t.FILE_EMPTY="An image file is required",t.FILE_FORMAT="Supported formats are: png",t.ALT_EMPTY="An image label is required"})(Wt||(Wt={}));const pn=t=>{const l=a=>{if(!a)return Wt.FILE_EMPTY;if(a.type!=="image/png")return Wt.FILE_FORMAT},c=a=>{if(!a)return Wt.ALT_EMPTY};return e.createElement(ge,{initialValues:{alt:""},validateOnBlur:!1,onSubmit:t.onSubmit},a=>e.createElement(I,{as:We},e.createElement(ne,{controlProps:{as:"p",marginTop:"1rem",marginBottom:"1rem"},initialFocusRef:t.initialFocusRef,isRequired:!0,label:"Image label",name:"alt",validate:c}),e.createElement(Lt,{name:"file",label:"Image file",validate:l,isRequired:!0}),e.createElement(g,{as:"p",paddingY:6,justifyContent:"flex-end"},e.createElement(k,{onClick:t.onCancel,colorScheme:"red",variant:"ghost"},"Cancel"),e.createElement(k,{colorScheme:"orange",isLoading:a.isSubmitting,marginLeft:".5rem",type:"submit",variant:"solid"},"Add"))))},Zn=t=>{const l=e.useRef(null),c=e.useRef(null),a=e.useRef(),[n,o]=e.useState(t.layout),i={toImageButtonOptions:{format:"svg",filename:"plot"},displaylogo:!1,modeBarButtonsToRemove:["zoom2d","pan2d","select2d","lasso2d","zoomIn2d","zoomOut2d","autoScale2d","resetScale2d","hoverClosestCartesian","hoverCompareCartesian","hoverClosestGl2d","hoverClosestPie","toggleHover","resetViews","sendDataToCloud","toggleSpikelines"],modeBarButtonsToAdd:[{title:"Delete plot",name:"Delete plot",icon:{width:21,height:21,path:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"},click:()=>{J.deletePlot(t.id)}}]};return e.useEffect(function(){let s;const m=c.current,b=new ResizeObserver(y=>{clearTimeout(a.current),s=window.setTimeout(()=>{o(h=>F(x({},h),{width:y[0].target.clientWidth}))},250),a.current=s});return m&&b.observe(m),()=>{m&&b.unobserve(m),s&&clearTimeout(s)}},[]),e.createElement(bt,{status:"idle",figureRef:c,id:t.id},e.createElement(Kl,{ref:d=>l.current=d,data:t.data,layout:n,config:i,style:{width:"100%",height:"100%"}}))};var hn=ht(Zn);const Xn="#f33d15",Kn="#b4fbde",ml=5,Ln=t=>{const l=Te.exports.useRef(null),c=Te.exports.useRef(null),[a,n]=Te.exports.useState(5),[o,i]=Te.exports.useState("loading");let d=0,s=0;switch(t.colorScale){case"diverging_-xx":d=-t.colorScaleValueX,s=t.colorScaleValueX;break;case"continuous_0q3":d=0,s=t.stats.q3;break;case"continuous_q1q3":d=t.stats.q1,s=t.stats.q3;break;case"continuous_xy":d=t.colorScaleValueX,s=t.colorScaleValueY;break}const m=[d,s],b=t.colorScale==="diverging_-xx"?Wl(m.reverse(),Vl):Jt({range:[Kn,Xn],domain:m});return Te.exports.useLayoutEffect(()=>{Yc(`mapman-templates/${t.template}.svg`).then(y=>{const h=t.plotTitle?t.height+30:t.height,u=ke(c.current).attr("width","90%").attr("height","100%").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox",`0 ${t.plotTitle?-30:0} ${t.width+100} ${h}`).classed("main-svg",!0);u.node().append(y.documentElement);const r=ke(c.current).append("g").attr("id","viz-layer");u.append("text").attr("x",t.width/2).attr("y",0).attr("text-anchor","middle").style("font-size",t.height/25).text(`${t.plotTitle}`),r.selectAll("rect").data(t.rects).enter().append("rect").attr("x",({x:L})=>L).attr("y",({y:L})=>L).attr("height",ml).attr("width",ml).attr("xOffset",({xOffset:L})=>L).attr("yOffset",({yOffset:L})=>L).attr("value",({value:L})=>L).style("stroke","lightgray").style("stroke-width",ml*.1).style("fill",({value:L})=>b(L)).append("title").text(({geneId:L,bin:E,value:V})=>`Gene-ID: ${L}
MapMan_BINCODE: ${E}
${t.valuesFrom}: ${V}`),i("idle")})},[]),Te.exports.useLayoutEffect(()=>{const y=ke(c.current).select("#viz-layer").selectAll("rect");y.attr("x",function(){const h=parseInt(ke(this).attr("x")),u=parseInt(ke(this).attr("xOffset")),r=a-parseInt(ke(this).attr("width"));return h+u*r}),y.attr("y",function(){const h=parseInt(ke(this).attr("y")),u=parseInt(ke(this).attr("yOffset")),r=a-parseInt(ke(this).attr("width"));return h+u*r}),y.style("stroke-width",function(){return a*.1}),y.attr("height",a).attr("width",a)},[a]),e.createElement(bt,{figureRef:l,position:"relative",height:800,plotType:"heatmap",status:"idle",id:t.id,overflow:"auto"},e.createElement(g,{justifyContent:"center",height:"100%",flexDirection:"column",alignItems:"center"},o==="loading"&&e.createElement(st,{position:"absolute",thickness:"4px",speed:"0.65s",emptyColor:"gray.200",color:"blue.500",size:"xl"}),e.createElement("svg",{ref:c},e.createElement(jl,{colorScale:b,id:re(),minVal:d,maxVal:s,width:20,height:250,x:t.width+50,y:10,label:t.valuesFrom,labelOffset:-40,reverse:t.colorScale==="diverging_-xx"})),e.createElement(g,{marginTop:"2rem",marginRight:"8rem",flexDirection:"row",justifyContent:"space-around",width:"full"},e.createElement(al,{variant:"simple",size:"sm",width:"25rem"},e.createElement(Sl,null,`Distribution of ${t.valuesFrom}`),e.createElement(nl,null,e.createElement(De,null,e.createElement(_,{isNumeric:!0},"Min"),e.createElement(_,{isNumeric:!0},"Q1"),e.createElement(_,{isNumeric:!0},"Median"),e.createElement(_,{isNumeric:!0},"Mean"),e.createElement(_,{isNumeric:!0},"Q3"),e.createElement(_,{isNumeric:!0},"Max"))),e.createElement(ol,null,e.createElement(De,null,e.createElement(Ve,{isNumeric:!0},t.stats.min.toFixed(2)),e.createElement(Ve,{isNumeric:!0},t.stats.q1.toFixed(2)),e.createElement(Ve,{isNumeric:!0},t.stats.median.toFixed(2)),e.createElement(Ve,{isNumeric:!0},t.stats.mean.toFixed(2)),e.createElement(Ve,{isNumeric:!0},t.stats.q3.toFixed(2)),e.createElement(Ve,{isNumeric:!0},t.stats.max.toFixed(2))))),e.createElement(g,{flexDirection:"column"},e.createElement(g,{justifyContent:"center",alignItems:"center",gridGap:2},e.createElement(Ze,{"aria-label":"decrease rect size",isRound:!0,colorScheme:"black",variant:"outline",size:"sm",icon:e.createElement(Pc,null),onClick:()=>n(Math.max(1,a-1))}),e.createElement($,null,`[ ${a} ]`),e.createElement(Ze,{"aria-label":"increase rect size",isRound:!0,colorScheme:"black",variant:"outline",size:"sm",icon:e.createElement(kc,null),onClick:()=>n(a+1)})),e.createElement($,null,"Adjust Box Size")))))},xn=t=>{const l=c=>{if(!S.getRow(c))return"The identifier does not exist";if(!c)return"The identifier cannot be empty"};return e.createElement(ge,{initialValues:{accessions:[""],plotTitle:"",withCaption:!0,withLegend:!0},onSubmit:t.onSubmit,validateOnBlur:!1},c=>e.createElement(I,{as:We},e.createElement(I,{as:"fieldset"},e.createElement(ee,{as:"legend"},"Legend and caption switches"),e.createElement(g,{as:"ul",listStyleType:"none"},e.createElement(Ye,{controlProps:{as:"li"},color:"orange.600",id:"plot-legend",label:"Legend",name:"withLegend"}),e.createElement(Ye,{controlProps:{as:"li"},color:"orange.600",id:"plot-caption",label:"Caption",name:"withCaption"}))),e.createElement(ne,{controlProps:{as:"p",marginTop:"1rem"},initialFocusRef:t.initialFocusRef,label:"Plot Title",name:"plotTitle"}),e.createElement(lt,{name:"accessions"},a=>e.createElement(I,{as:"fieldset"},e.createElement(ee,{as:"legend"},"Gene Accessions"),c.values.accessions&&c.values.accessions.length>0&&c.values.accessions.map((n,o)=>e.createElement(xt,{controlProps:{as:"p",marginTop:"1rem"},groupProps:{_focusWithin:{"& > button":{display:"inline-flex"}}},isRequired:!0,key:o,label:`Identifier (gene/metabolite/accession) ${o+1}`,name:`accessions.${o}`,rightChildren:c.values.accessions.length>1&&e.createElement(ct,{_focusWithin:{backgroundColor:"white"},_hover:{backgroundColor:"white"},as:"span",padding:0},e.createElement(Ze,{_focus:{color:"red.600",outline:"none"},_groupHover:{color:"red.600"},"aria-label":`Remove ${n}`,color:"gray.600",display:"flex",justifyContent:"center",icon:e.createElement(at,null),onClick:()=>a.remove(o),size:"md",variant:"unstyled"})),validate:l},e.createElement(I,{display:"none",color:"gray.500",_groupFocus:{display:"inline-flex"},_groupHover:{display:"inline-flex"},_focus:{backgroundColor:"orange.600",color:"white",outline:"none"},_hover:{backgroundColor:"orange.600",color:"white"},alignItems:"center",as:"button","aria-label":"Insert new below",backgroundColor:"white",height:"1rem",justifyContent:"center",left:"43%",padding:".75rem",position:"absolute",rounded:"full",top:"28px",type:"button",width:"1rem",zIndex:"popover",onClick:()=>a.insert(o+1,"")},e.createElement(pe,{as:je})))),e.createElement(k,{_focus:{outline:"none",backgroundColor:"orange.100"},_hover:{backgroundColor:"orange.100"},colorScheme:"orange",marginTop:"1rem",type:"button",onClick:()=>a.push(""),variant:"ghost"},"Add New"))),e.createElement(g,{as:"p",paddingY:6,justifyContent:"flex-end"},e.createElement(k,{onClick:t.onCancel,colorScheme:"red",variant:"ghost"},"Cancel"),e.createElement(k,{colorScheme:"orange",isLoading:c.isSubmitting,marginLeft:".5rem",type:"submit",variant:"solid"},"Load"))))},gn=t=>{const l=c=>{if(!S.getRow(c))return"The identifier does not exist";if(!c)return"The identifier cannot be empty"};return e.createElement(ge,{initialValues:{accessions:[""],plotTitle:"",withCaption:!0,withLegend:!0,colorBy:"group"},onSubmit:t.onSubmit,validateOnBlur:!1},c=>e.createElement(I,{as:We},e.createElement(I,{as:"fieldset"},e.createElement(ee,{as:"legend"},"Legend and caption switches"),e.createElement(g,{as:"ul",listStyleType:"none"},e.createElement(Ye,{controlProps:{as:"li"},color:"orange.600",id:"plot-legend",label:"Legend",name:"withLegend"}),e.createElement(Ye,{controlProps:{as:"li"},color:"orange.600",id:"plot-caption",label:"Caption",name:"withCaption"}))),e.createElement(ne,{controlProps:{as:"p",marginTop:"1rem"},initialFocusRef:t.initialFocusRef,label:"Plot Title",name:"plotTitle"}),e.createElement(sl,{controlProps:{as:"p",marginTop:"1rem"},direction:"row",label:"Color by",name:"colorBy",options:[{label:"Group",value:"group",disabled:!1},{label:"Gene",value:"accession",disabled:c.values.accessions.length===1}]}),e.createElement(lt,{name:"accessions"},a=>e.createElement(I,{as:"fieldset"},e.createElement(ee,{as:"legend"},"Gene Accessions"),c.values.accessions&&c.values.accessions.length>0&&c.values.accessions.map((n,o)=>e.createElement(xt,{controlProps:{as:"p",marginTop:"1rem"},groupProps:{_focusWithin:{"& > button":{display:"inline-flex"}}},isRequired:!0,key:o,label:`Identifier (gene/metabolite/accession) ${o+1}`,name:`accessions.${o}`,rightChildren:c.values.accessions.length>1&&e.createElement(ct,{_focusWithin:{backgroundColor:"white"},_hover:{backgroundColor:"white"},as:"span",padding:0},e.createElement(Ze,{_focus:{color:"red.600",outline:"none"},_groupHover:{color:"red.600"},"aria-label":`Remove ${n}`,color:"gray.600",display:"flex",justifyContent:"center",icon:e.createElement(at,null),onClick:()=>a.remove(o),size:"md",variant:"unstyled"})),validate:l},e.createElement(I,{display:"none",color:"gray.500",_groupFocus:{display:"inline-flex"},_groupHover:{display:"inline-flex"},_focus:{backgroundColor:"orange.600",color:"white",outline:"none"},_hover:{backgroundColor:"orange.600",color:"white"},alignItems:"center",as:"button","aria-label":"Insert new below",backgroundColor:"white",height:"1rem",justifyContent:"center",left:"43%",padding:".75rem",position:"absolute",rounded:"full",top:"28px",type:"button",width:"1rem",zIndex:"popover",onClick:()=>a.insert(o+1,"")},e.createElement(pe,{as:je})))),e.createElement(k,{_focus:{outline:"none",backgroundColor:"orange.100"},_hover:{backgroundColor:"orange.100"},colorScheme:"orange",marginTop:"1rem",type:"button",onClick:()=>a.push(""),variant:"ghost"},"Add New"))),e.createElement(g,{as:"p",paddingY:6,justifyContent:"flex-end"},e.createElement(k,{onClick:t.onCancel,colorScheme:"red",variant:"ghost"},"Cancel"),e.createElement(k,{colorScheme:"orange",isLoading:c.isSubmitting,marginLeft:".5rem",type:"submit",variant:"solid"},"Load"))))},Wn=({color:t,accession:l,geneInfo:c})=>e.createElement(I,{as:"div",px:"2"},e.createElement(g,{alignItems:"center",mb:"4"},e.createElement(I,{fontWeight:"semibold",fontSize:"lg",px:"2",color:t},l)),c.size>0?[...c.entries()].map(([a,n])=>e.createElement(g,{key:`${l}-${a}`},e.createElement(g,{flexShrink:"unset",ml:"2",py:"1",w:"36",textTransform:"uppercase",textColor:"yellow.700",wordBreak:"break-all"},a),e.createElement(g,{ml:"5",py:"1",wordBreak:"break-all"},n))):"No information available for this gene."),Vn=t=>e.createElement(fl.Consumer,null,({hoveredGene:l})=>e.createElement(g,{as:"figcaption",py:"5",textColor:"gray.600",textAlign:"justify",fontSize:"sm",_hover:{backgroundColor:"yellow.100"},_odd:{backgroundColor:"gray.100"}},e.createElement(Wn,{accession:t.accession,geneInfo:t.caption,color:t.color})));var rt;(function(t){t.EMPTY_REPLICATE="A replicate field cannot be empty",t.EMPTY_ACCESSION="A gene accession field cannot be empty",t.MIN_OPTIONAL_REPLICATES="At least two replicates must be selected",t.MIN_OPTIONAL_ACCESSIONS="At least two genes must be selected"})(rt||(rt={}));const In=t=>{const l=n=>{if(n.replicates.length===1&&n.calculateFor==="replicates")return{replicates:[rt.MIN_OPTIONAL_REPLICATES]};if(n.accessions.length===1&&n.calculateFor==="genes")return{accessions:[rt.MIN_OPTIONAL_ACCESSIONS]}},c=n=>{if(!n)return rt.EMPTY_REPLICATE},a=n=>{if(!n)return rt.EMPTY_ACCESSION};return e.createElement(ge,{initialValues:{accessions:[],accessionsList:"",calculateFor:"replicates",replicates:[],replicatesList:"",plotTitle:"",zTransform:!0},validateOnBlur:!1,validate:l,onSubmit:t.onSubmit},n=>e.createElement(I,{as:We},e.createElement(ne,{controlProps:{as:"p",marginTop:"1rem"},initialFocusRef:t.initialFocusRef,label:"Plot Title",name:"plotTitle"}),e.createElement(sl,{controlProps:{marginTop:"2rem"},label:"Calculate For",name:"calculateFor",options:[{label:"Replicates",value:"replicates"},{label:"Genes",value:"genes"}],direction:"row"}),e.createElement(Ye,{controlProps:{marginTop:"2rem"},color:"orange.600",id:"z-transform",label:"z-transform data",name:"zTransform"}),e.createElement(lt,{name:"replicates"},o=>e.createElement(I,{as:"fieldset"},e.createElement(ee,{as:"legend"},"Replicates"),e.createElement(A,{as:"p",marginTop:"2rem",fontWeight:"semibold"},"Optionally filter replicates"),e.createElement(gt,{controlProps:{marginTop:"1rem",marginLeft:".5rem"},focusBorderColor:"orange.300",name:"replicatesList",label:"replicates",hideLabel:!0,placeholder:"List your replicates here, separated by a newline.",isDisabled:n.values.replicates.length>0}),n.values.replicates.length>0&&n.values.replicates.map((i,d)=>e.createElement(Ol,{controlProps:{as:"p"},groupProps:{_focusWithin:{"& > button":{display:"inline-flex"}}},isRequired:!0,key:d,label:`Replicate ${d+1}`,name:`replicates.${d}`,rightChildren:e.createElement(ct,{_focusWithin:{backgroundColor:"white"},_hover:{backgroundColor:"white"},as:"span",padding:0},e.createElement(Ze,{_focus:{color:"red.600",outline:"none"},_groupHover:{color:"red.600"},"aria-label":`Remove ${i}`,color:"gray.600",display:"flex",justifyContent:"center",icon:e.createElement(at,null),onClick:()=>o.remove(d),size:"md",variant:"unstyled"})),validate:c},e.createElement(I,{display:"none",color:"gray.500",_groupFocus:{display:"inline-flex"},_groupHover:{display:"inline-flex"},_focus:{backgroundColor:"orange.600",color:"white",outline:"none"},_hover:{backgroundColor:"orange.600",color:"white"},alignItems:"center",as:"button","aria-label":"Insert new below",backgroundColor:"white",height:"1rem",justifyContent:"center",left:"43%",padding:".75rem",position:"absolute",rounded:"full",top:"28px",type:"button",width:"1rem",zIndex:"popover",onClick:()=>o.insert(d+1,"")},e.createElement(pe,{as:je})))),e.createElement(k,{_focus:{outline:"none",backgroundColor:"orange.100"},_hover:{backgroundColor:"orange.100"},colorScheme:"orange",marginTop:".5rem",type:"button",onClick:()=>{n.values.replicates.length===0&&o.push(""),o.push("")},variant:"ghost",disabled:n.values.replicatesList!==""},n.values.replicates.length===0?"Select Replicates":"Add Another Replicate"))),e.createElement(lt,{name:"accessions"},o=>e.createElement(I,{as:"fieldset"},e.createElement(ee,{as:"legend"},"Genes"),e.createElement(A,{as:"p",marginTop:"1rem",fontWeight:"semibold"},"Optionally filter genes"),e.createElement(gt,{controlProps:{marginTop:"1rem",marginLeft:".5rem"},focusBorderColor:"orange.300",name:"accessionsList",label:"accession",hideLabel:!0,placeholder:"List your identifiers here, separated by a newline.",isDisabled:n.values.accessions.length>0}),n.values.accessions&&n.values.accessions.length>0&&n.values.accessions.map((i,d)=>e.createElement(xt,{controlProps:{as:"p"},groupProps:{_focusWithin:{"& > button":{display:"inline-flex"}}},isRequired:!0,key:d,label:`Gene Identifier ${d+1}`,name:`accessions.${d}`,rightChildren:e.createElement(ct,{_focusWithin:{backgroundColor:"white"},_hover:{backgroundColor:"white"},as:"span",padding:0},e.createElement(Ze,{_focus:{color:"red.600",outline:"none"},_groupHover:{color:"red.600"},"aria-label":`Remove ${i}`,color:"gray.600",display:"flex",justifyContent:"center",icon:e.createElement(at,null),onClick:()=>o.remove(d),size:"md",variant:"unstyled"})),validate:a},e.createElement(I,{display:"none",color:"gray.500",_groupFocus:{display:"inline-flex"},_groupHover:{display:"inline-flex"},_focus:{backgroundColor:"orange.600",color:"white",outline:"none"},_hover:{backgroundColor:"orange.600",color:"white"},alignItems:"center",as:"button","aria-label":"Insert new below",backgroundColor:"white",height:"1rem",justifyContent:"center",left:"43%",padding:".75rem",position:"absolute",rounded:"full",top:"28px",type:"button",width:"1rem",zIndex:"popover",onClick:()=>o.insert(d+1,"")},e.createElement(pe,{as:je})))),e.createElement(k,{_focus:{outline:"none",backgroundColor:"orange.100"},_hover:{backgroundColor:"orange.100"},colorScheme:"orange",marginTop:".5rem",type:"button",onClick:()=>{n.values.accessions.length===0&&o.push(""),o.push("")},variant:"ghost",disabled:n.values.accessionsList!==""},n.values.accessions.length===0?"Select Genes":"Add Another Genes"))),e.createElement(g,{as:"p",paddingY:6,justifyContent:"flex-end"},e.createElement(k,{onClick:t.onCancel,colorScheme:"red",variant:"ghost"},"Cancel"),e.createElement(k,{colorScheme:"orange",isLoading:n.isSubmitting,marginLeft:".5rem",type:"submit",variant:"solid"},"Load"))))},Vt=y=>{var h=y,{children:t,controlProps:l,groupProps:c,hideLabel:a,initialFocusRef:n,label:o,leftChildren:i,name:d,rightChildren:s,validate:m}=h,b=j(h,["children","controlProps","groupProps","hideLabel","initialFocusRef","label","leftChildren","name","rightChildren","validate"]);const[u,r,z]=Je({name:d,validate:m});return e.createElement(fe,F(x({},l),{isInvalid:r.error!==void 0&&r.touched!==void 0,isRequired:b.isRequired}),a?e.createElement(ee,null,e.createElement(A,{fontWeight:"semibold"},o)):e.createElement(A,{fontWeight:"semibold"},o),e.createElement(Mt,x({},c),i,e.createElement(wc,F(x({},b),{name:u.name,value:u.value,onChange:L=>z.setValue(L?parseFloat(L):"")}),e.createElement(Jc,{ref:L=>n?n.current=L:L}),e.createElement(fc,null,e.createElement(Bc,null),e.createElement(Nc,null))),t,s),e.createElement(Be,{as:"span"},r.error))},Sn=[{label:"Amino acid metabolism",value:"X4.3_Amino_acid_metabolism_R3.0"},{label:"Carbohydrate metabolism",value:"X4.3_Carbohydrate_metabolism_R3.0"},{label:"Cellular respiration",value:"X4.3_Cellular_respiration_R3.0"},{label:"Coenzyme metabolism",value:"X4.3_Coenzyme_metabolism_R3.0"},{label:"GA synthesis",value:"X4.3_GA_synthesis_R3.0"},{label:"JA synthesis",value:"X4.3_JA_synthesis_R3.0"},{label:"Lignin",value:"X4.3_Lignin_R3.0"},{label:"Lipid metabolism",value:"X4.3_Lipid_metabolism_R3.0"},{label:"Metabolism overview",value:"X4.3_Metabolism_overview_R3.0"},{label:"Nucleotide metabolism",value:"X4.3_Nucleotide_metabolism_R3.0"},{label:"Photosynthesis",value:"X4.3_Photosynthesis_R3.0"},{label:"Polyamine metabolism",value:"X4.3_Polyamine_metabolism_R3.0"},{label:"Secondary metabolism",value:"X4.3_Secondary_metabolism_R3.0"},{label:"Tetrapyrrole biosynthesis",value:"X4.3_Tetrapyrrole_biosynthesis_R3.0"},{label:"Tocopherol biosynthesis",value:"X4.3_Tocopherol_biosynthesis_R3.0"},{label:"Vesicle trafficking",value:"X4.3_Vesicle_trafficking_R3.0"}],Cn=t=>{var a;const l=it({base:"column",sm:"row"}),c=Te.exports.useMemo(()=>ll(R.sliceColumns(0,9)).reduce((o,i,d)=>{if(Ga(i)){const s=R.colNames[d];o.push({value:s,label:s})}return o},[{value:"expressionValue",label:"Mean expression value"}]),[]);return e.createElement(ge,{initialValues:{infoTableColumn:(a=R.colNames.find(n=>n==="MapMan_BINCODE"))!=null?a:R.colNames[0],infoTableColumnSep:",",template:"X4.3_Amino_acid_metabolism_R3.0",valuesFrom:c[0].value,colorScale:"diverging_-xx",sample:S.sampleGroupsAsArray[0],colorScaleValueX:3,colorScaleValueY:3,plotTitle:""},validateOnBlur:!1,onSubmit:t.onSubmit},n=>e.createElement(I,{as:We},e.createElement(ne,{controlProps:{as:"p"},initialFocusRef:t.initialFocusRef,label:"Plot Title",name:"plotTitle"}),e.createElement(g,{gridGap:"1rem",flexDirection:l,marginTop:"2rem"},e.createElement(He,{label:"MapMan BINCODE column",name:"infoTableColumn",options:R.colNames.map(o=>({value:o,label:o})),tooltip:"Select the column from your gene info table that holds MapMan BINCODE(s).",width:"20rem"}),e.createElement(ne,{controlProps:{as:"p"},initialFocusRef:t.initialFocusRef,label:"BINCODE separator",name:"infoTableColumnSep",tooltip:"In-column separator for MapMan BINCODEs, in case a gene is annotated with multiple bins.",isRequired:!0})),e.createElement(He,{controlProps:{marginTop:"1rem"},label:"Values from",name:"valuesFrom",options:c,tooltip:"Select where to get the values to be plotted from. Can be any numeric value from the info table or mean expression values for a specific sample."}),n.values.valuesFrom=="expressionValue"&&e.createElement(He,{controlProps:{marginTop:"1rem"},label:"Sample",name:"sample",options:S.sampleGroupsAsArray.map(o=>({label:o,value:o})),tooltip:"Select the sample to get the shown values for each gene from"}),e.createElement(g,{marginTop:"2rem",gridGap:"1rem",flexDirection:l},e.createElement(He,{label:"Color Scale",name:"colorScale",width:"20rem",options:[{value:"diverging_-xx",label:"diverging (-x to x)"},{value:"continuous_0q3",label:"continuous (0 to 3. quartile)"},{value:"continuous_q1q3",label:"continuous (1. quartile to 3. quartile)"},{value:"continuous_xy",label:"continuous (x to y)"}],tooltip:"Select a color scale for your values. For log2FC or similar, choose a divergent scale."}),n.values.colorScale==="diverging_-xx"&&e.createElement(Vt,{label:"Value (x)",name:"colorScaleValueX",min:1,isRequired:!0}),n.values.colorScale==="continuous_xy"&&e.createElement(e.Fragment,null,e.createElement(Vt,{label:"Value (x)",name:"colorScaleValueX",isRequired:!0}),e.createElement(Vt,{label:"Value (y)",name:"colorScaleValueY",isRequired:!0}))),e.createElement(He,{controlProps:{marginTop:"2rem"},label:"MapMan Template",name:"template",options:Sn,tooltip:"Select the MapMan Pathway File to use as template for plotting your values"}),e.createElement(g,{as:"p",paddingY:6,justifyContent:"flex-end"},e.createElement(k,{onClick:t.onCancel,colorScheme:"red",variant:"ghost"},"Cancel"),e.createElement(k,{colorScheme:"orange",isLoading:n.isSubmitting,marginLeft:".5rem",type:"submit",variant:"solid"},"Load"))))},Hn=()=>{const t=wt(),l=e.useRef(null),{isOpen:c,onOpen:a,onClose:n}=ie(),o=(G,W)=>{G.accessions.length===1?J.addSingleGeneBarPlot(G.accessions,{showlegend:G.withLegend,showCaption:G.withCaption,plotTitle:G.plotTitle}):J.addMultiGeneBarPlot(G.accessions,{showlegend:G.withLegend,showCaption:G.withCaption,plotTitle:G.plotTitle}),W.setSubmitting(!1),n()},i=e.useRef(null),{isOpen:d,onOpen:s,onClose:m}=ie(),b=(G,W)=>{G.accessions.length===1?J.addSingleGeneIndividualLinesPlot(G.accessions,{showlegend:G.withLegend,showCaption:G.withCaption,plotTitle:G.plotTitle}):J.addMultiGeneIndividualLinesPlot(G.accessions,{showlegend:G.withLegend,showCaption:G.withCaption,plotTitle:G.plotTitle}),W.setSubmitting(!1),m()},y=e.useRef(null),{isOpen:h,onOpen:u,onClose:r}=ie(),z=(G,W)=>{J.addStackedLinesPlot(G.accessions,{showlegend:G.withLegend,showCaption:G.withCaption,plotTitle:G.plotTitle,colorBy:G.colorBy}),W.setSubmitting(!1),r()},L=e.useRef(null),{isOpen:E,onOpen:V,onClose:X}=ie(),Y=(G,W)=>{W.setSubmitting(!1);let N=G.replicates;const Q=[];G.replicatesList!==""&&(N=G.replicatesList.split(`
`),N.forEach((w,Ce,be)=>{w=w.trim(),be[Ce]=w,S.colNames.includes(w)||Q.push(w)}),Q.length>0&&t({title:"Error",description:`Invalid replicates: ${JSON.stringify(Q)}`,status:"error",isClosable:!0}));let H=G.accessions;const U=[];G.accessionsList!==""&&(H=G.accessionsList.split(`
`),H.forEach((w,Ce,be)=>{w=w.trim(),be[Ce]=w,S.rowNames.includes(w)||U.push(w)}),U.length>0&&t({title:"Error",description:`Invalid accessions: ${JSON.stringify(U)}`,status:"error",isClosable:!0})),!(Q.length>0||U.length>0)&&(X(),setTimeout(()=>J.addHeatmapPlot({accessions:H,clusterBy:G.clusterBy,distanceMethod:G.distanceMethod,replicates:N,plotTitle:G.plotTitle,zTransform:G.zTransform}),10))},O=e.useRef(null),{isOpen:te,onOpen:D,onClose:le}=ie(),ce=(G,W)=>{W.setSubmitting(!1);let N=G.replicates;const Q=[];G.replicatesList!==""&&(N=G.replicatesList.split(`
`),N.forEach((w,Ce,be)=>{w=w.trim(),be[Ce]=w,S.colNames.includes(w)||Q.push(w)}),Q.length>0&&t({title:"Error",description:`Invalid replicates: ${JSON.stringify(Q)}`,status:"error",isClosable:!0}));let H=G.accessions;const U=[];G.accessionsList!==""&&(H=G.accessionsList.split(`
`),H.forEach((w,Ce,be)=>{w=w.trim(),be[Ce]=w,S.rowNames.includes(w)||U.push(w)}),U.length>0&&t({title:"Error",description:`Invalid accessions: ${JSON.stringify(U)}`,status:"error",isClosable:!0})),!(Q.length>0||U.length>0)&&(le(),setTimeout(()=>J.addPCAPlot({accessions:H,calculateFor:G.calculateFor,replicates:N,plotTitle:G.plotTitle,zTransform:G.zTransform}),10))},ye=e.useRef(null),{isOpen:Xe,onOpen:Ke,onClose:Se}=ie(),ze=async(G,W)=>{Se(),setTimeout(()=>J.addMapManPlot(G),10),W.setSubmitting(!1)},Le=e.useRef(null),{isOpen:se,onOpen:me,onClose:xe}=ie(),ve=(G,W)=>{if(W.setSubmitting(!1),xe(),G.file){const N=URL.createObjectURL(G.file);J.addImagePlot(N,G.alt)}},C=()=>{J.clearPlots()},T=S.hasData,P=J.hasPlots,M=R.hasData;return e.createElement(g,{as:"main",flexGrow:1},e.createElement(vl,{background:"white",marginTop:5,minWidth:"4.5rem",maxWidth:"14rem",position:"fixed",boxShadow:"2xl",zIndex:"popover"},e.createElement(he,{text:"Bars",icon:Cl,onClick:a,disabled:!T}),e.createElement(he,{text:"Individual Lines",icon:Qc,onClick:s,disabled:!T}),e.createElement(he,{text:"Stacked Lines",icon:Ec,onClick:u,disabled:!T}),e.createElement(mt,null),e.createElement(he,{text:"Cluster Heatmap",icon:Fc,onClick:V,disabled:!T}),e.createElement(he,{text:"PCA",icon:Uc,onClick:D,disabled:!T}),e.createElement(mt,null),e.createElement(he,{text:"MapMan Function",icon:dl,onClick:Ke,disabled:!T||!M}),e.createElement(mt,null),e.createElement(he,{text:"Custom figure",icon:Oc,onClick:me}),e.createElement(he,{text:"Remove All",icon:Pt,onClick:C,disabled:!P})),e.createElement(g,{"aria-label":"Visualizations",flexWrap:"wrap",role:"region",width:"100%",margin:2,marginLeft:20,overflow:"hidden"},!T&&e.createElement(Fe,{alignItems:"center",flexDirection:"column",minHeight:"16rem",maxHeight:"20rem",justifyContent:"center",marginLeft:3,marginTop:3,status:"warning",textAlign:"center",variant:"subtle"},e.createElement(Ue,{boxSize:"3rem",mr:0}),e.createElement(Oe,{mt:4,mb:1,fontSize:"lg"},"No data has been loaded"),e.createElement(Ne,{maxWidth:"xl"},"It seems no data has been loaded into the application yet. You can load data from various formats in the Data section of the toolbar above.")),J.plots.map(G=>{if(G.isLoading)return e.createElement(bt,{key:G.id,status:"loading",id:G.id},e.createElement(st,{key:`${G.id}-loading`,thickness:"4px",speed:"0.65s",emptyColor:"gray.200",color:"blue.500",size:"xl"}));switch(G.type){case"heatmap":{const W=G;return e.createElement(yn,F(x({},W),{key:W.id}))}case"image":{const W=G;return e.createElement(Gn,{key:G.id,alt:W.alt,id:W.id,src:W.src})}case"plotly":{const W=G;return e.createElement(ka,F(x({},W),{key:W.id}),W.options.showCaption&&W.accessions.map((N,Q)=>{const H=R.getRowAsMap(N);return H&&e.createElement(Vn,{key:`${N}-${Q}`,accession:N,caption:H,color:W.accessions.length>1?Nt[Q]:void 0})}))}case"pca":{const W=G;return e.createElement(hn,x({key:W.id},W))}case"mapman":{const W=G;return e.createElement(Ln,x({key:W.id},W))}}})),e.createElement(Ie,{initialFocusRef:l,isOpen:c,onClose:n,size:"xl",title:"Bar Plot",scrollBehavior:"outside"},e.createElement(mn,{initialFocusRef:l,onCancel:n,onSubmit:o})),e.createElement(Ie,{initialFocusRef:i,isOpen:d,onClose:m,size:"xl",title:"Individual Lines Plot",scrollBehavior:"outside"},e.createElement(xn,{initialFocusRef:i,onCancel:m,onSubmit:b})),e.createElement(Ie,{initialFocusRef:y,isOpen:h,onClose:r,size:"xl",title:"Stacked Lines Plot",scrollBehavior:"outside"},e.createElement(gn,{initialFocusRef:y,onCancel:r,onSubmit:z})),e.createElement(Ie,{initialFocusRef:L,isOpen:E,onClose:X,size:"xl",title:"Heatmap Plot",scrollBehavior:"outside"},e.createElement(bn,{initialFocusRef:L,onCancel:X,onSubmit:Y})),e.createElement(Ie,{initialFocusRef:O,isOpen:te,onClose:le,size:"xl",title:"PCA Plot",scrollBehavior:"outside"},e.createElement(In,{initialFocusRef:O,onCancel:le,onSubmit:ce})),e.createElement(Ie,{initialFocusRef:ye,isOpen:Xe,onClose:Se,size:"xl",title:"MapMan Functional Template Plot",scrollBehavior:"outside"},e.createElement(Cn,{initialFocusRef:ye,onCancel:Se,onSubmit:ze})),e.createElement(Ie,{initialFocusRef:Le,isOpen:se,onClose:xe,size:"xl",title:"Custom figure",scrollBehavior:"outside"},e.createElement(pn,{initialFocusRef:Le,onCancel:xe,onSubmit:ve})))};var zn=ht(Hn);const vn=()=>e.createElement(Xt,null,e.createElement(Me,{path:"/",element:e.createElement(zn,null)})),Rn=et(g),Tn=et(I),bl=n=>{var o=n,{label:t,text:l,icon:c}=o,a=j(o,["label","text","icon"]);return e.createElement(il,F(x({},a),{_focus:x({outline:"none",borderLeftColor:"orange.600"},a._focus),_hover:x({borderLeftColor:"orange.600",boxShadow:"md",textDecoration:"none"},a._hover),backgroundColor:"white",borderLeft:"4px",borderLeftColor:"transparent",boxShadow:"xs",display:"flex",padding:5,tabIndex:0,width:"100%"}),c&&e.createElement(pe,{as:c,color:"gray.600",height:"1.5rem",marginTop:"2",marginRight:"1rem",width:"1.5rem"}),e.createElement(Rn,{as:"section",alignItems:"center",flexGrow:1,whileHover:"hover"},e.createElement(I,{width:"100%"},e.createElement($,{as:"h1",fontSize:"xl",fontWeight:"semibold"},t),e.createElement($,{marginTop:"1.5"},l)),e.createElement(Tn,{marginX:"1rem",variants:{hover:{x:[0,10],transition:{duration:.8,repeat:1/0,repeatType:"mirror"}}}},e.createElement(pe,{as:cl,color:"orange.600",height:"1.5rem",width:"1.5rem"}))))},Mn=()=>e.createElement(I,{as:"main",padding:6,width:"100%",__css:{"& a:not(:first-of-type)":{marginTop:"2rem"}}},e.createElement(bl,{icon:gl,label:"Gene Browser",text:`
          The gene browser provides an interface to search and inspect the
          individual gene information stored in the replicates database.
          All searches are privately kept within your browser and will not be
          sent anywhere.
        `,to:"/tools/gene-browser"}),e.createElement(bl,{icon:jc,label:"Enrichment Analyses",text:`
          The enrichment analyses tool allows you to run enrichment tests for your data.
          Use the "Gene Info Table" to store information about differentially expressed genes.
          All tests and results will be private to your browser and will not be sent anywhere.
        `,to:"/tools/enrichment"}),e.createElement(bl,{icon:dl,label:"MapMan Functional Annotations",text:`
          The MapMan Functional Annotations provide resources to run functional annotations on your
          sequence data via Mercator v4, that can automatically be linked to your supplementary gene information.
          You can then directly use the protein annotation metadata to plot MapMan Classification and expression of your genes. 
        `,to:"/tools/mapman"})),Yn=a=>{var n=a,{accession:t,geneInfo:l}=n,c=j(n,["accession","geneInfo"]);return e.createElement(I,x({as:"section","aria-label":"Gene info card","aria-describedby":t,display:"flex",flexDirection:"column"},c),e.createElement(g,{alignItems:"center",marginBottom:2,gridGap:"1rem"},e.createElement($,{as:"h1",color:"orange.600",fontWeight:"semibold",fontSize:"lg",id:t},t),e.createElement(Dc,{"aria-label":"show tabular transcript expression values",as:Ac,w:5,h:5,color:"gray.600",onClick:c.onDoubleClick,_hover:{color:"gray.800"}})),l.size>0?[...l.entries()].map(([o,i])=>e.createElement(g,{key:`${o}-${t}`,paddingY:1},e.createElement(g,{flexShrink:0,marginLeft:2,maxWidth:36,fontWeight:"semibold",textColor:"gray.600",textTransform:"uppercase",width:36,wordBreak:"break-all"},o),e.createElement(g,{marginLeft:5,wordBreak:"break-all"},i))):e.createElement($,null,"There is no information available for this gene"))},Pn=t=>{const l=S.getRow(t.accessionId),c=K.gxpSettings.expression_header_sep,a=K.gxpSettings.unit,n=S.colNames.map((o,i)=>[...o.split(c),l[i]]);return e.createElement(al,{colorScheme:"orange",variant:"striped"},e.createElement(Sl,null,"Expression count per replicate file found for this accession"),e.createElement(nl,null,e.createElement(De,{sx:{"& > th":{fontSize:14}}},e.createElement(_,null,"Group"),e.createElement(_,null,"Sample"),e.createElement(_,null,"Replicate"),e.createElement(_,{isNumeric:!0},"Count [",a,"]"))),e.createElement(ol,null,n.map(([o,i,d,s])=>e.createElement(De,{key:`${o}-${i}-${d}`,tabIndex:0,"aria-label":`Group: ${o}, Sample: ${i}, Replicate: ${d} Count: ${s}`,_focus:{outline:"2px solid",outlineColor:"orange.600"}},e.createElement(Ve,null,o),e.createElement(Ve,null,i),e.createElement(Ve,null,d),e.createElement(Ve,{isNumeric:!0},s)))),e.createElement(Hl,null,e.createElement(De,null,e.createElement(_,null,"Group"),e.createElement(_,null,"Sample"),e.createElement(_,null,"Replicate"),e.createElement(_,{isNumeric:!0},"Count [",a,"]"))))};var nt;(function(t){t.COUNT_EMPTY="The results value cannot be empty",t.COUNT_LT_ONE="Results cannot be less than 1",t.PAGE_EMPTY="The page number cannot be empty",t.PAGE_GT_MAX="The page number cannot be over the max",t.PAGE_LT_ONE="The page number cannot be less than 1"})(nt||(nt={}));const kn=n=>{var o=n,{initialFocusRef:t,onSubmit:l,pageMax:c}=o,a=j(o,["initialFocusRef","onSubmit","pageMax"]);const i=s=>{if(typeof s=="string"&&s==="")return nt.PAGE_EMPTY;if(s<1)return nt.PAGE_LT_ONE;if(s>c)return nt.PAGE_GT_MAX},d=s=>{if(typeof s=="string"&&s==="")return nt.COUNT_EMPTY;if(s<1)return nt.COUNT_LT_ONE};return e.createElement(ge,{initialValues:{searchText:"",countView:20,pageNum:1},validateOnBlur:!1,onSubmit:l},s=>e.createElement(g,x({as:We},a),e.createElement(ne,{controlProps:{flexShrink:.7,marginLeft:2},initialFocusRef:t,label:"Search in accessions",leftChildren:e.createElement(_c,{_focusWithin:{backgroundColor:"white"},_hover:{backgroundColor:"white"},as:"span",padding:0},e.createElement(Ze,{_focus:{color:"orange.600",outline:"none"},_groupHover:{color:"orange.600"},"aria-label":"Search database",color:"gray.600",display:"flex",justifyContent:"center",icon:e.createElement(qc,null),isLoading:s.isSubmitting,size:"md",type:"submit",variant:"unstyled"})),name:"searchText"}),e.createElement(Vt,{allowMouseWheel:!0,controlProps:{marginLeft:3},label:`Page ${s.values.pageNum} / ${c}`,name:"pageNum",min:1,max:c,validate:i,width:"100%"}),e.createElement(Vt,{allowMouseWheel:!0,controlProps:{marginLeft:3},label:"Results per page",name:"countView",min:1,validate:d,width:"100%"})))},wn=()=>{const t=it({base:"full",lg:"6xl"}),{isOpen:l,onOpen:c,onClose:a}=ie(),n=e.useRef(""),o=u=>()=>{n.current=u,c()},[i,d]=e.useState({geneCards:[],pageMax:1}),[s,m]=e.useState(!0),b=e.useCallback((u,r,z)=>{const L=new RegExp(Va(u),"i"),E=S.rowNames.reduce((te,D)=>{var Xe;const le=D.search(L)>-1,ce=(Xe=R.getRowAsMap(D))!=null?Xe:new Map,ye=ce?Array.from(ce.values()).some(Ke=>Ke.search(L)>-1):!1;return(le||ye)&&te.push({accession:D,geneInfo:ce}),te},[]),V=(z-1)*r,X=z*r,Y=E.slice(V,X),O=Math.ceil(E.length/r)||1;return{geneCards:Y,pageMax:O}},[]);e.useEffect(function(){m(!0);const r=b("",20,1);d(r),m(!1)},[b]);const y=(u,r)=>{m(!0),setTimeout(()=>{const z=b(u.searchText,u.countView,u.pageNum);d(z),r.setSubmitting(!1),m(!1)},10)},h=S.hasData;return e.createElement(g,{flexDirection:"column",backgroundColor:"white",flexGrow:1,padding:6},e.createElement(kn,{alignItems:"start",flexDirection:{base:"column",md:"row"},justifyContent:"space-around",onSubmit:y,pageMax:i.pageMax}),h?s?e.createElement(g,{width:"100%",flexGrow:1,justifyContent:"center",alignItems:"center"},e.createElement(st,{size:"xl"})):i.geneCards.map(({accession:u,geneInfo:r})=>e.createElement(Yn,{_first:{marginTop:5},_even:{backgroundColor:"orange.50"},_hover:{backgroundColor:"orange.100",cursor:"pointer"},_focus:{outline:"none",border:"1px solid",borderColor:"orange.600",backgroundColor:"orange.100"},accession:u,border:"1px solid",borderColor:"transparent",geneInfo:r,key:u,padding:5,tabIndex:0,onDoubleClick:o(u),onKeyDown:z=>{z.key==="Enter"&&(z.preventDefault(),o(u)())}})):e.createElement(Fe,{alignItems:"center",flexDirection:"column",minHeight:"16rem",maxHeight:"20rem",justifyContent:"center",marginLeft:3,marginTop:3,status:"warning",textAlign:"center",variant:"subtle"},e.createElement(Ue,{boxSize:"3rem",mr:0}),e.createElement(Oe,{mt:4,mb:1,fontSize:"lg"},"No data has been loaded"),e.createElement(Ne,{maxWidth:"xl"},"It seems no data has been loaded into the application yet. You can load data from various formats in the Data section of the toolbar above.")),e.createElement(jt,{isOpen:l,onClose:a,size:t},e.createElement(Dt,null),e.createElement(At,{margin:t==="full"?0:void 0,overflow:"auto",rounded:"none"},e.createElement(_t,{color:"orange.600"},n.current),e.createElement(qt,null),e.createElement($t,null,e.createElement(Pn,{accessionId:n.current})),e.createElement(zl,null,e.createElement(k,{colorScheme:"orange",mr:3,onClick:a},"Close")))))},Jn=({id:t,filterSignificant:l})=>{const c=ue.getAnalysisById(t),a=c?c.data:[],n=(c==null?void 0:c.options.descriptionColumn)!="None",o=n?1:0,i=l?d=>d<=.05:d=>d;return e.createElement(al,{colorScheme:"orange",variant:"striped"},e.createElement(nl,null,e.createElement(De,{sx:{"& > th":{fontSize:14}}},e.createElement(_,null,"Test Entry"),n&&e.createElement(_,null,"Description"),e.createElement(_,{isNumeric:!0},"p_Value"),e.createElement(_,{isNumeric:!0},"adjusted p_Value"))),e.createElement(ol,null,a&&a.filter(d=>i(d[2+o])).map(d=>{const s=d[0],m=d[1+o],b=d[2+o],y=n?d[1]:void 0;return e.createElement(De,{key:`${s}-${m}-${b}`,tabIndex:0,"aria-label":`testEntry: ${s}, pValue: ${m}, adjpValue: ${b} `,_focus:{outline:"2px solid",outlineColor:"orange.600"}},e.createElement(Ve,null,s),n&&e.createElement(Ve,{maxWidth:"25rem"},y),e.createElement(Ve,{isNumeric:!0},m),e.createElement(Ve,{isNumeric:!0},b))})),e.createElement(Hl,null,e.createElement(De,null,e.createElement(_,null,"Test Entry"),n&&e.createElement(_,null,"Description"),e.createElement(_,{isNumeric:!0},"p_Value"),e.createElement(_,{isNumeric:!0},"adjusted p_Value"))))},$l=["<=",">=","<",">","==","abs <=","abs >=","abs <","abs >","regexp"],fn=t=>e.createElement(ge,{initialValues:{accessions:[],accessionsList:"",title:"",TEFcolumn:R.colNames[0],TEFselector:"<",TEFselectorValue:"",TEIcolumn:R.colNames[0],TEIselectorBinary:"<",TEIselectorMulti:"delimiter",TEIselectorType:"multinomial",TEIselectorValue:"",descriptionColumn:"None"},validateOnBlur:!1,onSubmit:t.onSubmit},l=>e.createElement(I,{as:We},e.createElement(ne,{controlProps:{as:"p",marginTop:"1rem"},initialFocusRef:t.initialFocusRef,label:"Enrichment analysis title",name:"title",isRequired:!0}),e.createElement(mt,{marginTop:"1rem"}),e.createElement(He,{controlProps:{marginTop:"1rem"},label:"Test enrichment for",name:"TEFcolumn",options:R.colNames.reduce((c,a)=>(c.push({value:a,label:a}),c),[{value:"filterGeneIds",label:"Filter Gene identifiers"}]),tooltip:"Select a column from your gene info table to test enrichment for"}),l.values.TEFcolumn==="filterGeneIds"?e.createElement(gt,{controlProps:{marginTop:"1rem"},focusBorderColor:"orange.300",name:"filterGeneIds",label:"Identifier List",placeholder:"List your gene identifiers here, separated by a newline.",isDisabled:l.values.accessions.length>0,tooltip:"List your gene identifiers to filter for enrichment"}):e.createElement(g,{alignItems:"center",justifyContent:"center"},e.createElement(He,{controlProps:{marginTop:"1rem",flexShrink:3,marginRight:"1rem"},label:"Selector",name:"TEFselector",options:$l.map(c=>({value:c,label:c})),tooltip:"Choose a selector function to classify your column values"}),e.createElement(ne,{controlProps:{as:"p",marginTop:"1rem"},initialFocusRef:t.initialFocusRef,label:"Selector Value",name:"TEFselectorValue",isRequired:!0})),e.createElement(mt,{marginTop:"1rem"}),e.createElement(He,{controlProps:{marginTop:"1rem"},label:"Test enrichment in",name:"TEIcolumn",options:R.colNames.map(c=>({value:c,label:c})),tooltip:"Select a column from your gene info table to test enrichment in"}),e.createElement(g,{alignItems:"center",justifyContent:"center"},e.createElement(He,{controlProps:{marginTop:"1rem",flexShrink:2.8,marginRight:"1rem"},label:"Selector type",name:"TEIselectorType",options:[{value:"multinomial",label:"multinomial"},{value:"binary",label:"binary"}],tooltip:"Choose a selector function to classify your column values."}),l.values.TEIselectorType==="binary"?e.createElement(He,{controlProps:{marginTop:"1rem",flexShrink:3,marginRight:"1rem"},label:"Selector",name:"TEIselectorBinary",options:$l.map(c=>({value:c,label:c})),tooltip:"Choose a selector function to classify your column values."}):e.createElement(He,{controlProps:{marginTop:"1rem",flexShrink:3,marginRight:"1rem"},label:"Selector",name:"TEIselectorMulti",options:[{value:"delimiter",label:"delimiter"},{value:"regexp",label:"regexp"}],tooltip:"Choose a selector function to classify your column values."}),e.createElement(ne,{controlProps:{as:"p",marginTop:"1rem",flexShrink:2.2},initialFocusRef:t.initialFocusRef,label:"Selector Value",name:"TEIselectorValue",isRequired:!0})),e.createElement(He,{controlProps:{marginTop:"1rem"},label:"Add description from",name:"descriptionColumn",options:R.colNames.reduce((c,a)=>(c.push({value:a,label:a}),c),[{value:"None",label:"None"}]),tooltip:"Select a column from your gene info table to use as a description for the Test Entries from the 'Test enrichment in' column"}),e.createElement(g,{as:"p",paddingY:6,justifyContent:"flex-end"},e.createElement(k,{onClick:t.onCancel,colorScheme:"red",variant:"ghost"},"Cancel"),e.createElement(k,{colorScheme:"orange",isLoading:l.isSubmitting,marginLeft:".5rem",type:"submit",variant:"solid"},"Run")))),ut=a=>{var n=a,{label:t,value:l}=n,c=j(n,["label","value"]);return e.createElement(g,x({paddingY:.5,width:"full",alignItems:"center"},c),e.createElement(g,{flexShrink:0,marginLeft:2,maxWidth:"12rem",fontWeight:"semibold",textColor:"gray.600",width:"12rem",wordBreak:"break-all"},t),e.createElement(g,{marginLeft:5,wordBreak:"break-word"},l))},Bn=()=>{var V;const t=it({base:"full",lg:"6xl"}),l=wt(),[c,a]=Te.exports.useState(!1),n=R.hasData,o=e.useRef(null),{isOpen:i,onOpen:d,onClose:s}=ie(),m=(X,Y)=>{Y.setSubmitting(!1),s();const O={TEFcolumn:X.TEFcolumn,TEFselector:X.TEFselector,TEFselectorValue:X.TEFselectorValue,TEIcolumn:X.TEIcolumn,TEIselectorType:X.TEIselectorType,TEIselector:X.TEIselectorType==="binary"?X.TEIselectorBinary:X.TEIselectorMulti,TEIselectorValue:X.TEIselectorValue,title:X.title,descriptionColumn:X.descriptionColumn,filterGeneIds:X.filterGeneIds?X.filterGeneIds.split(`
`):void 0};setTimeout(()=>{try{ue.addEnrichmentAnalysis(O)}catch(te){l({title:"Error",description:te.message,status:"error",isClosable:!0})}},10)},b=e.useRef(""),{isOpen:y,onOpen:h,onClose:u}=ie(),r=()=>{a(!1),u()},z=X=>()=>{b.current=X,h()},L=X=>Y=>{ue.deleteAnalysis(X),Y.stopPropagation()},E=X=>Y=>{const O=ue.getAnalysisById(X);if(!O)throw new Error("Specified enrichment analysis does not exist.");const te=ue.dataToCSV(O,"	"),D=new Blob([te],{type:"text/plain"});tl.exports.saveAs(D,"enrichment.tsv"),Y.stopPropagation()};return e.createElement(g,{alignItems:"center",flexDirection:"column",padding:"2rem",width:"100%",paddingRight:"6rem"},n?ue.analyses.length===0?e.createElement(Fe,{alignItems:"center",flexDirection:"column",minHeight:"16rem",maxHeight:"20rem",justifyContent:"center",marginLeft:3,marginTop:3,status:"info",textAlign:"center",variant:"subtle",colorScheme:"orange"},e.createElement(Ue,{boxSize:"3rem",mr:0}),e.createElement(Oe,{mt:4,mb:1,fontSize:"lg"},"Run your enrichment analysis"),e.createElement(Ne,{maxWidth:"xl"},"To run an enrichment analysis on the data supplied by your meta information table, click the Button in the bottom right corner and fill out the Form. For more Information see [Documentation]")):ue.analyses.map((X,Y)=>e.createElement(g,{key:Y,_focus:{outline:"none",borderLeftColor:"orange.600"},_hover:{borderLeftColor:"orange.600",boxShadow:"md",textDecoration:"none"},cursor:"pointer",backgroundColor:"white",borderLeft:"4px",borderLeftColor:"transparent",boxShadow:"sm",padding:5,tabIndex:0,width:"100%",alignItems:"start",justifyContent:"center",as:"section",flexGrow:1,marginTop:4,onClick:z(X.id),onKeyDown:O=>{O.key==="Enter"&&(O.preventDefault(),z(X.id)())}},X.isLoading?e.createElement(st,{display:"flex",key:`${X.id}-loading`,thickness:"4px",speed:"0.65s",emptyColor:"gray.200",color:"blue.500",size:"md"}):e.createElement(I,{width:"100%"},e.createElement($,{as:"h1",fontSize:"xl",fontWeight:"semibold",marginBottom:2,textColor:"orange.600"},X.options.title),e.createElement(ut,{label:"Enrichment type",value:X.options.TEIselectorType}),e.createElement(ut,{label:"Tested Enrichment for",value:X.options.TEFcolumn,marginTop:"0.4rem"}),e.createElement(ut,{label:"Selector",value:`"${X.options.TEFselector}" : "${X.options.TEFselectorValue}"`}),e.createElement(ut,{label:"Tested Enrichment in",value:X.options.TEIcolumn,marginTop:"0.4rem"}),e.createElement(ut,{label:"Selector",value:`"${X.options.TEIselector}" : "${X.options.TEIselectorValue}"`}),e.createElement(ut,{label:"Description",value:X.options.descriptionColumn})),!X.isLoading&&e.createElement(g,null,e.createElement(Ze,{_hover:{color:"orange.600"},"aria-label":"Delete enrichment analysis",color:"gray.600",icon:e.createElement(Xl,null),marginLeft:2,size:"lg",variant:"ghost",onClick:E(X.id),zIndex:"overlay",as:"a"}),e.createElement(Ze,{_hover:{color:"orange.600"},"aria-label":"Delete enrichment analysis",color:"gray.600",icon:e.createElement(Pt,null),marginLeft:2,size:"lg",variant:"ghost",onClick:L(X.id),zIndex:"overlay"})))):e.createElement(Fe,{alignItems:"center",flexDirection:"column",minHeight:"16rem",maxHeight:"20rem",justifyContent:"center",marginLeft:3,marginTop:3,status:"warning",textAlign:"center",variant:"subtle"},e.createElement(Ue,{boxSize:"3rem",mr:0}),e.createElement(Oe,{mt:4,mb:1,fontSize:"lg"},"No data has been loaded"),e.createElement(Ne,{maxWidth:"xl"},"It seems no gene info data has been loaded into the application yet. You can load data from various formats in the Data section of the toolbar above.")),e.createElement(Ze,{"aria-label":"add new enrichment analysis",icon:e.createElement(je,{size:"1rem",color:"white"}),position:"fixed",height:"4rem",width:"4rem",variant:"solid",right:"1rem",bottom:"1rem",backgroundColor:"orange.400",borderRadius:"full",shadow:"xl",_hover:{backgroundColor:"orange.300"},onClick:d,disabled:!n}),e.createElement(Ie,{initialFocusRef:o,isOpen:i,onClose:s,size:"xl",title:"New Enrichment Analysis",scrollBehavior:"outside"},e.createElement(fn,{initialFocusRef:o,onCancel:s,onSubmit:m})),e.createElement(jt,{isOpen:y,onClose:r,size:t,scrollBehavior:"inside"},e.createElement(Dt,null),e.createElement(At,{margin:t==="full"?0:void 0,overflow:"auto",rounded:"none"},e.createElement(_t,{color:"orange.600",justifyContent:"space-between"},(V=ue.getAnalysisById(b.current))==null?void 0:V.options.title),e.createElement(qt,null),e.createElement($t,null,e.createElement(Jn,{id:b.current,filterSignificant:c})),e.createElement(zl,null,e.createElement(Tt,{label:c?"remove filter":"filter significant adjusted p-values <= 0.05"},e.createElement(k,{mr:3,colorScheme:"orange",variant:"outline",onClick:()=>a(!c)},c?"Show all Entries":"Show significant Entries")),e.createElement(k,{colorScheme:"orange",mr:3,onClick:r},"Close")))))};var Nn=ht(Bn);const Qn=et(g),En=et(I),ec=n=>{var o=n,{label:t,text:l,icon:c}=o,a=j(o,["label","text","icon"]);return e.createElement(I,F(x({textAlign:"start",as:"button"},a),{_focus:x({outline:"none",borderLeftColor:"orange.600"},a._focus),_hover:x({borderLeftColor:"orange.600",boxShadow:"md",textDecoration:"none"},a._hover),backgroundColor:"white",borderLeft:"4px",borderLeftColor:"transparent",boxShadow:"xs",display:"flex",padding:5,tabIndex:0,width:"100%"}),c&&e.createElement(pe,{as:c,color:"gray.600",height:"1.5rem",marginTop:"2",marginRight:"1rem",width:"1.5rem"}),e.createElement(Qn,{as:"section",alignItems:"center",flexGrow:1,whileHover:"hover"},e.createElement(I,{width:"100%"},e.createElement($,{as:"h1",fontSize:"xl",fontWeight:"semibold"},t),e.createElement($,{marginTop:"1.5"},l)),e.createElement(En,{marginX:"1rem",variants:{hover:{x:[0,10],transition:{duration:.8,repeat:1/0,repeatType:"mirror"}}}},e.createElement(pe,{as:cl,color:"orange.600",height:"1.5rem",width:"1.5rem"}))))},Fn=()=>{const t=e.useRef(null),{isOpen:l,onOpen:c,onClose:a}=ie(),n=wt(),o=(i,d)=>{const s=i.file;if(s)try{const m=new FileReader;m.onload=()=>{const b=m.result.split(`
`,1)[0];if(Ql(b))El(m.result,{addDescription:i.addDescription,addName:i.addName}),n({title:"Successfully imported Mercator table",status:"success",description:"The provided Mercator tabular output was successfully imported into the application.",isClosable:!0});else{n({title:"Error",status:"error",description:"Invalid Mercator Input.",isClosable:!0});return}},m.onloadend=()=>{d.setSubmitting(!1),a()},m.onerror=()=>{d.setSubmitting(!1),console.error("There was an error while reading the file")},m.readAsText(s)}catch(m){d.setSubmitting(!1),console.error(m)}};return e.createElement(e.Fragment,null,e.createElement(I,{as:"main",padding:6,width:"100%",__css:{"& button:not(:first-of-type)":{marginTop:"2rem"}}},S.hasData?e.createElement(e.Fragment,null,e.createElement(ec,{icon:dl,label:"Mercator v4",text:`
              Use the Mercator v4 tool to annotate your genes with MapMan Bins. Clicking here
              will bring you to the plabipd online resources to run Mercator on your DNA or protein
              sequences. After running Mercator you can import the output table into GXP by using
              the Card below.
            `,onClick:()=>window.open("https://plabipd.de/portal/mercator4")}),e.createElement(ec,{icon:xl,label:"Import Mercator output",text:`
              Import Mercator v4 tabular output into the GXP. Importing the file will automatically
              append the Mercator columns to already uploaded gene info. If no gene info was uploaded
              yet, the in memory gene info will be created for you.
            `,onClick:c})):e.createElement(Fe,{alignItems:"center",flexDirection:"column",minHeight:"16rem",maxHeight:"20rem",justifyContent:"center",status:"warning",textAlign:"center",variant:"subtle"},e.createElement(Ue,{boxSize:"3rem",mr:0}),e.createElement(Oe,{mt:4,mb:1,fontSize:"lg"},"No data has been loaded"),e.createElement(Ne,{maxWidth:"xl"},"It seems no data has been loaded into the application yet. You can load data from various formats in the Data section of the toolbar above."))),e.createElement(Ie,{initialFocusRef:t,isOpen:l,onClose:a,title:"Load Mercator Table"},e.createElement(Fl,{initialFocusRef:t,onCancel:a,onSubmit:o})))},Un=()=>e.createElement(Xt,null,e.createElement(Me,{path:"/",element:e.createElement(Mn,null)}),e.createElement(Me,{path:"/gene-browser",element:e.createElement(wn,null)}),e.createElement(Me,{path:"/enrichment",element:e.createElement(Nn,null)}),e.createElement(Me,{path:"/mapman",element:e.createElement(Fn,null)})),On=()=>e.createElement(Xt,null,e.createElement(Me,{path:"/",element:e.createElement(ma,null)}),e.createElement(Me,{path:"/data/*",element:e.createElement(ln,null)}),e.createElement(Me,{path:"/plots/*",element:e.createElement(vn,null)}),e.createElement(Me,{path:"/tools/*",element:e.createElement(Un,null)}),e.createElement(Me,{path:"/docs/*",element:e.createElement(on,null)})),Qt=t=>{const l=it({base:"md",lg:"lg"}),c=$c(),a=(t.urlMatch==="exact"||t.urlMatch===void 0)&&c.pathname===t.href||t.urlMatch==="contains"&&c.pathname.includes(t.href);return e.createElement(ea,null,e.createElement(il,{_focus:{outline:"none",backgroundColor:"gray.100",textColor:"orange.600"},_hover:{backgroundColor:"gray.100",textColor:"orange.600"},alignItems:"center",borderRadius:"md",borderY:"2px",borderColor:a?"white":"transparent",display:"flex",flexDirection:"column",justifyContent:"center",paddingY:2,paddingX:4,textColor:"white",tabIndex:0,to:t.href},e.createElement(pe,{as:t.icon,width:5,height:5}),e.createElement($,{as:"span",fontSize:l,fontWeight:"semibold",userSelect:"none"},t.text)))},jn=t=>e.createElement(I,x({as:"nav",paddingY:2,paddingX:5,backgroundColor:"orange.600",boxShadow:"xl"},t),e.createElement(ta,{display:"flex",justifyContent:"space-around",listStyleType:"none"},t.children)),Dn=t=>e.createElement(g,x({flexDirection:"column",minHeight:"100vh",backgroundColor:"gray.100"},t),e.createElement(jn,null,e.createElement(Qt,{href:"/data",icon:la,text:"Data",urlMatch:"contains"}),e.createElement(Qt,{href:"/plots",icon:Cl,text:"Plots",urlMatch:"contains"}),e.createElement(Qt,{href:"/tools",icon:ca,text:"Tools",urlMatch:"contains"}),e.createElement(Qt,{href:"/docs",icon:aa,text:"Docs",urlMatch:"contains"})),t.children),An=()=>{const[t,l]=e.useState({status:"idle"}),c=async()=>{var a;l({status:"loading"});try{if(K.preloaded.settings){const n=await Ee(K.preloaded.settings,"json");K.loadgxpSettings(n),J.loadCountUnit(K.gxpSettings.unit)}if(K.preloaded.data){const n=await Ee(K.preloaded.data,"text"),o=Ae(n,{fieldSeparator:K.gxpSettings.expression_field_sep,rowNameColumn:0});S.loadFromObject(o,{multiHeader:K.gxpSettings.expression_header_sep}),K.gxpSettings.groupOrder.length===0&&K.setGroupOrder(S.groupsAsArray),K.gxpSettings.sampleOrder.length===0&&K.setSampleOrder(S.samplesAsArray)}if(K.preloaded.info){const n=await Ee(K.preloaded.info,"text"),o=Ae(n,{fieldSeparator:K.gxpSettings.info_field_sep,rowNameColumn:0});R.loadFromObject(o,{multiHeader:"*"})}if(K.preloaded.image){const n=await Ee(K.preloaded.image,"url"),o=(a=n.split("/").pop())==null?void 0:a.split(".").shift();J.addImagePlot(n,o)}if(K.preloaded.plots){const n=await Ee(K.preloaded.plots,"json");await Promise.all(n.map(async o=>{const i=await Ee(o,"json");J.addRawPlot(x({id:re(),isLoading:!1},i))}))}if(K.preloaded.enrichments){const n=await Ee(K.preloaded.enrichments,"json");await Promise.all(n.map(async o=>{const b=o,{rawData:i}=b,d=j(b,["rawData"]),s=await Ee(i,"text"),m=Nl(s,K.gxpSettings.expression_field_sep);ue.addRawEnrichmentAnalysis({id:re(),isLoading:!1,options:d,data:m})}))}l({status:"idle"})}catch(n){l({status:"failed",message:n.message})}};return e.useEffect(function(){(K.preloaded.data||K.preloaded.image||K.preloaded.info||K.preloaded.settings)&&c()},[]),e.createElement(na,null,e.createElement(Dn,null,t.status==="loading"?e.createElement(g,{alignItems:"center",flexDirection:"column",flexGrow:1,justifyContent:"center",width:"100%"},e.createElement(st,{thickness:"4px",speed:"0.65s",emptyColor:"gray.200",color:"blue.500",size:"xl"}),e.createElement($,{fontSize:"xl",fontWeight:"semibold",marginTop:6},"Loading Application Data")):t.status==="failed"?e.createElement(Fe,{alignItems:"center",flexDirection:"column",justifyContent:"center",marginTop:10,padding:8,status:"error",textAlign:"center",variant:"subtle"},e.createElement(Ue,{boxSize:"2rem",marginRight:0}),e.createElement(Oe,{marginTop:6,fontSize:"lg"},"The application failed to load"),e.createElement(Ne,{marginTop:3,maxWidth:"xl"},"The application failed when trying to load data resources. You may try reloading the page. If the problem persists, please contact your administrator."),e.createElement(oa,{marginTop:6},t.message)):e.createElement(On,null)))};da.render(e.createElement(e.StrictMode,null,e.createElement(ia,null,e.createElement(An,null))),document.getElementById("root"));
